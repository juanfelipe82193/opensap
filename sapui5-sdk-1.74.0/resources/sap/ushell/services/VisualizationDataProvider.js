// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/resources"],function(r){"use strict";function V(){this.S_COMPONENT_NAME="sap.ushell.services.VisualizationDataProvider";this._init.apply(this,arguments);}V.prototype._init=function(l){this.oLaunchPageAdapter=l;this.oCatalogTilePromise=null;};V.prototype._getCatalogTiles=function(){if(this.oCatalogTilePromise){return this.oCatalogTilePromise;}var l=this.oLaunchPageAdapter;this.oCatalogTilePromise=new Promise(function(a,b){l.getCatalogs().then(function(c){var d=[];var C=[];var f=[];var o={};for(var i=0;i<c.length;i++){d.push(l.getCatalogTiles(c[i]).then(function(e){C.push(e);}));}jQuery.when.apply(null,d).done(function(){f=[].concat.apply([],C);for(var y=0;y<f.length;y++){o[l.getCatalogTileId(f[y])]=f[y];}a(o);}).fail(b);}).fail(b);});return this.oCatalogTilePromise;};V.prototype.getVisualizationData=function(){var l=this.oLaunchPageAdapter,c;return this._getCatalogTiles().then(function(C){return Object.keys(C).reduce(function(v,i){c=C[i];v[i]={title:l.getCatalogTilePreviewTitle(c),subTitle:l.getCatalogTilePreviewSubtitle(c),icon:l.getCatalogTilePreviewIcon(c),info:l.getCatalogTilePreviewInfo(c),size:l.getCatalogTileSize(c),indicatorDataSource:l.getCatalogTilePreviewIndicatorDataSource(c),url:l.getCatalogTileTargetURL(c),isCustomTile:l.isCustomTile&&l.isCustomTile(c)};return v;},{});}).catch(function(e){var E={component:this.S_COMPONENT_NAME,description:r.i18n.getText("VisualizationDataProvider.CannotLoadData"),detail:e};return Promise.reject(E);}.bind(this));};V.prototype.getVisualizationView=function(v,p){var l=this.oLaunchPageAdapter;p=p||false;return this._getCatalogTileById(v).then(function(c){return l.getCatalogTileView(c,p);});};V.prototype._getCatalogTileById=function(v){return this._getCatalogTiles().then(function(c){var C=c[v];if(!C){return Promise.reject("Visualization "+v+" not found");}return C;});};V.prototype._getAdapter=function(){return this.oLaunchPageAdapter;};V.hasNoAdapter=false;return V;});
