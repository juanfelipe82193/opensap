// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/ListItem","sap/m/Select","sap/m/library","sap/m/FlexBox","sap/ui/core/HTML","sap/m/Label","sap/ushell/ui/launchpad/Tile","sap/m/NumericContent","sap/m/TileContent","sap/m/GenericTile","sap/ui/model/BindingMode","sap/m/Input","sap/ushell/resources"],function(q,L,S,m,F,H,a,T,N,b,G,B,I,r){"use strict";var c=m.FlexRendertype;var d=m.FlexJustifyContent;var e=m.FlexAlignItems;sap.ui.jsview("sap.ushell.ui.footerbar.SaveAsTile",{getControllerName:function(){return"sap.ushell.ui.footerbar.SaveAsTile";},createContent:function(C){this.oResourceBundle=r.i18n;this.viewData=this.getViewData()||{};this.appData=this.viewData.appData||{};this.oTitleInput=new I("bookmarkTitleInput",{tooltip:this.oResourceBundle.getText("bookmarkDialogoTitle_tooltip"),value:{path:"/title",mode:B.TwoWay}}).addStyleClass("sapUshellInputField");this.oTitleInput.addAriaLabelledBy("titleLbl");this.oSubTitleInput=new I("bookmarkSubTitleInput",{tooltip:this.oResourceBundle.getText("bookmarkDialogoSubTitle_tooltip"),value:{path:"/subtitle",mode:B.TwoWay}}).addStyleClass("sapUshellInputField");this.oSubTitleInput.addAriaLabelledBy("subtitleLbl");this.oInfoInput=new I("bookmarkInfoInput",{tooltip:this.oResourceBundle.getText("bookmarkDialogoDescription_tooltip"),value:{path:"/info",mode:B.TwoWay},visible:"{/showInfo}"}).addStyleClass("sapUshellInputField");this.oInfoInput.addAriaLabelledBy("infoLbl");var t={numberValue:"{/numberValue}",title:"{/title}",subtitle:"{/subtitle}",info:"{/info}",icon:"{/icon}",infoState:"{/infoState}",numberFactor:"{/numberFactor}",numberUnit:"{/numberUnit}",numberDigits:"{/numberDigits}",numberState:"{/numberState}",stateArrow:"{/stateArrow}",targetURL:"{/targetURL}",keywords:"{/keywords}",sizeBehavior:"{/sizeBehavior}"},p=function(n){var u=n;switch(n){case"Positive":u="Good";break;case"Negative":u="Critical";break;}return u;};var o,s;if(this.viewData.serviceUrl){o=new G({header:t.title,subheader:t.subtitle,sizeBehavior:t.sizeBehavior,size:"Auto",tileContent:[new b({size:"Auto",footer:t.info,unit:t.numberUnit,content:[new N({scale:t.numberFactor,value:t.numberValue,truncateValueTo:5,valueColor:p(t.numberState),indicator:t.stateArrow,icon:t.icon,width:"100%"})]})]});s=(typeof(this.viewData.serviceUrl)==="function")?this.viewData.serviceUrl():this.viewData.serviceUrl;C.calcTileDataFromServiceUrl(s);}else{o=new G({header:t.title,subheader:t.subtitle,sizeBehavior:t.sizeBehavior,size:"Auto",tileContent:[new b({size:"Auto",footer:t.info,content:new N({icon:t.icon,value:" ",width:"100%"})})]});}this.setTileView(o);var f=new T({"long":false,tileViews:[o],afterRendering:function(){var n=q(this.getDomRef()),u=n.find(".sapMGT");u.removeAttr("tabindex");}}).addStyleClass("sapUshellBookmarkFormPreviewTileMargin");var P=new H("previewBackgroundElement",{content:"<div class='sapUshellShellBG sapContrastPlus sapUiStrongBackgroundColor'></div>"});var h=new F("saveAsTileHBox",{items:[P,f],alignItems:e.Center,justifyContent:d.Center,renderType:c.Bare,visible:"{/showPreview}"}).addStyleClass("sapUshellShellBG").addStyleClass("sapUshellBookmarkFormPreviewBoxBottomMargin");this.oGroupsSelect=new S("groupsSelect",{tooltip:this.oResourceBundle.getText("bookmarkDialogoGroup_tooltip"),items:{path:"/groups",template:new L({text:"{title}"})},width:"100%",visible:{parts:["/showGroupSelection","/groups"],formatter:function(n,u){if(n&&!(u&&u.length)){this.oController.loadPersonalizedGroups();}return n;}.bind(this)}});this.oGroupsSelect.addAriaLabelledBy("groupLbl");var g=new a("previewLbl",{text:this.oResourceBundle.getText("previewFld"),labelFor:h,visible:"{/showPreview}"});var i=new a("titleLbl",{required:true,text:" "+this.oResourceBundle.getText("titleFld"),labelFor:this.oTitleInput}).setLabelFor("bookmarkTitleInput");var j=new a("subtitleLbl",{text:this.oResourceBundle.getText("subtitleFld"),labelFor:this.oSubTitleInput}).setLabelFor("bookmarkSubTitleInput");var k=new a("infoLbl",{text:this.oResourceBundle.getText("tileSettingsDialog_informationField"),labelFor:this.oInfoInput,visible:"{/showInfo}"}).setLabelFor("bookmarkInfoInput");var l=new a("groupLbl",{text:this.oResourceBundle.getText("GroupListItem_label"),labelFor:this.oGroupsSelect,visible:"{/showGroupSelection}"}).setLabelFor("groupsSelect");return[g,h,i,this.oTitleInput,j,this.oSubTitleInput,k,this.oInfoInput,l,this.oGroupsSelect];},getTitleInput:function(){return this.oTitleInput;},getTileView:function(){return this.tileView;},setTileView:function(t){this.tileView=t;},getBookmarkTileData:function(){var s;if(this.oGroupsSelect&&this.oGroupsSelect.getSelectedItem()){s=this.oGroupsSelect.getSelectedItem().getBindingContext().getObject();}var u;if(this.viewData.customUrl){if(typeof(this.viewData.customUrl)==="function"){u=this.viewData.customUrl();}else{u=this.viewData.customUrl;}}else{u=hasher.getHash()?("#"+hasher.getHash()):window.location.href;}return{title:this.oTitleInput.getValue()?this.oTitleInput.getValue().substring(0,256).trim():"",subtitle:this.oSubTitleInput.getValue()?this.oSubTitleInput.getValue().substring(0,256).trim():"",url:u,icon:this.getModel().getProperty("/icon"),info:this.oInfoInput.getValue()?this.oInfoInput.getValue().substring(0,256).trim():"",numberUnit:this.viewData.numberUnit,serviceUrl:typeof(this.viewData.serviceUrl)==="function"?this.viewData.serviceUrl():this.viewData.serviceUrl,serviceRefreshInterval:this.viewData.serviceRefreshInterval,group:s,keywords:this.viewData.keywords};}});});
