/*!
 * Copyright (c) 2009-2017 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/m/Button","sap/ushell/library","sap/ushell/resources","./SendAsEmailButtonRenderer","sap/ushell/services/_AppState/AppStatePersistencyMethod"],function(B,l,r,S,A){"use strict";var a=B.extend("sap.ushell.ui.footerbar.SendAsEmailButton",{metadata:{library:"sap.ushell",properties:{beforePressHandler:{type:"any",group:"Misc",defaultValue:null},afterPressHandler:{type:"any",group:"Misc",defaultValue:null}}}});a.prototype.init=function(){var t=this;this.setIcon("sap-icon://email");this.setText(r.i18n.getText("sendEmailBtn"));this.setTooltip(r.i18n.getText("sendEmailBtn_tooltip"));this.attachPress(function(){if(t.getBeforePressHandler()){t.getBeforePressHandler()();}this.sendAsEmailPressed(t.getAfterPressHandler());});if(B.prototype.init){B.prototype.init.apply(this,arguments);}};a.prototype.sendAsEmailPressed=function(c){var R=sap.ushell.Container.getFLPUrl(true);var t=this;if(typeof R==="string"){t.setAppStateToPublic(R);t.sendEmail(R);}else{R.done(function(u){t.setAppStateToPublic(u);t.sendEmail(u);});}if(c){c();}};a.prototype.setAppStateToPublic=function(u){var o=sap.ushell.Container.getService("AppState");if(o.getSupportedPersistencyMethods().length===0){var x=this.getURLParamValue(u,"sap-xapp-state"),i=this.getURLParamValue(u,"sap-iapp-state");if(x!==undefined){o.makeStatePersistent(x,A.PublicState);}if(i!==undefined){o.makeStatePersistent(i,A.PublicState);}}};a.prototype.sendEmail=function(u){sap.m.URLHelper.triggerEmail(null,"Link to application",u);};a.prototype.getURLParamValue=function(u,p){var R=new RegExp("(?:"+p+"=)([^&/]+)"),s=R.exec(u),v;if(s&&s.length===2){v=s[1];}return v;};return a;},true);
