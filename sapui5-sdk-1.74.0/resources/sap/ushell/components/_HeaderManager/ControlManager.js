// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/CustomData","sap/ui/core/IconPool","sap/ui/Device","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/ui/footerbar/ContactSupportButton","sap/ushell/ui/footerbar/EndUserFeedback","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/ui/shell/ShellHeadItem","sap/ushell/ui/shell/ShellNavigationMenu"],function(C,I,D,a,E,r,b,c,A,S,d){"use strict";var e=[];var f=[];var g={SHELL_NAV_MENU_ONLY:0,ALL_MY_APPS_ONLY:1,SHELL_NAV_MENU:2,ALL_MY_APPS:3};function i(w,H,x){e.push(k(w));e.push(m(H));e.push(q(H,x));e.push(n(x));if(a.last("/core/shell/model/enableNotifications")){e.push(p(x));}if(w.moveEditHomePageActionToShellHeader){e.push(l());}if(w.moveAppFinderActionToShellHeader){e.push(s(w,H));}if(w.moveUserSettingsActionToShellHeader){e.push(j(H));}if(w.moveContactSupportActionToShellHeader){e.push(t());}if(w.moveGiveFeedbackActionToShellHeader){e.push(u());}if(a.last("/core/productSwitch/enabled")){e.push(v());}f.push(E.once("CoreResourcesComplementLoaded").do(function(){_(w,x,H);}));}function h(){e.forEach(function(w){var x=sap.ui.getCore().byId(w);if(x){if(x.destroyContent){x.destroyContent();}x.destroy();}});f.forEach(function(w){w.off();});e=[];f=[];}function _(w,x,y){sap.ui.require(["sap/m/StandardListItem","sap/ushell/ui/shell/NavigationMiniTile"],function(z,N){var M="shellNavigationMenu";var H=function(J,K){var L=K.getProperty("icon")||"sap-icon://circle-task-2",T=K.getProperty("title"),O=K.getProperty("subtitle"),P=K.getProperty("intent");var Q=(new z({type:"Active",title:T,description:O,icon:L,customData:[new C({key:"intent",value:P})],press:[y.handleNavigationMenuItemPress,y]})).addStyleClass("sapUshellNavigationMenuListItems");return Q;};var R=function(J,K){var L=K.getProperty("icon"),T=K.getProperty("title"),O=K.getProperty("subtitle"),P=K.getProperty("intent");return new N({title:T,subtitle:O,icon:L,intent:P,press:function(){var Q=this.getIntent();if(Q&&Q[0]==="#"){y.navigateFromShellApplicationNavigationMenu(Q);}}});};var B=new d(M,{title:"{/application/title}",icon:"{/application/icon}",showTitle:{path:"/application/showNavMenuTitle"},showRelatedApps:w.appState!=="lean",items:{path:"/application/hierarchy",factory:H.bind(this)},miniTiles:{path:"/application/relatedApps",factory:R.bind(this)},visible:{path:"/ShellAppTitleState",formatter:function(J){return J===g.SHELL_NAV_MENU;}}});var F=sap.ui.getCore().byId("shell-header");B.setModel(F.getModel());var G=sap.ui.getCore().byId("shellAppTitle");if(G){G.setNavigationMenu(B);}e.push(M);return M;}.bind(this));}function j(w){var U=new S({id:"userSettingsBtn",icon:"sap-icon://action-settings",tooltip:r.i18n.getText("userSettings"),text:r.i18n.getText("userSettings"),press:w.handleUserSettingsPress});return U.getId();}function k(w){var H=new S({id:"homeBtn",tooltip:r.i18n.getText("homeBtn_tooltip"),ariaLabel:r.i18n.getText("homeBtn_tooltip"),icon:I.getIconURI("home"),target:w.rootIntent?"#"+w.rootIntent:"#"});if(a.last("/core/extension/enableHelp")){H.addStyleClass("help-id-homeBtn",true);}H.addCustomData(new A({key:"aria-disabled",value:"false",writeToDom:true}));if(D.system.desktop){H.addEventDelegate({onsapskipback:function(x){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){x.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}},onsapskipforward:function(x){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){x.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}}});}return H.getId();}function l(){var T=new S({id:"ActionModeBtn",icon:"sap-icon://edit"});if(a.last("/core/extension/enableHelp")){T.addStyleClass("help-id-ActionModeBtn");}return T.getId();}function m(w){var B=sap.ui.getCore().getConfiguration().getRTL()?"feeder-arrow":"nav-back";var x=new S({id:"backBtn",tooltip:r.i18n.getText("backBtn_tooltip"),ariaLabel:r.i18n.getText("backBtn_tooltip"),icon:I.getIconURI(B),press:w.pressNavBackButton.bind(w)});return x.getId();}function n(w){var x="meAreaHeaderButton";var M=new S({id:x,icon:"{/userImage/personPlaceHolder}",ariaLabel:r.i18n.getText("MeAreaToggleButtonAria"),tooltip:sap.ushell.Container.getUser().getFullName(),press:function(){E.emit("showMeArea",Date.now());}});if(D.system.desktop){M.addEventDelegate({onsapskipforward:function(y){sap.ushell.renderers.fiori2.AccessKeysHandler.bForwardNavigation=true;y.preventDefault();window.document.getElementById("sapUshellHeaderAccessibilityHelper").focus();}});}M.setModel(w);return x;}function o(B){B.applySettings({floatingNumber:{parts:["/notificationsCount"],formatter:function(w){var x=this.getDomRef(),y="";if(x){if(w>0){y=r.i18n.getText("NotificationToggleButtonCollapsed",w);}else{y=r.i18n.getText("NotificationToggleButtonCollapsedNoNotifications");}x.setAttribute("aria-label",y);}return w;}}},true,true);}function p(w){var x="NotificationsCountButton";var y="bell";var N=new S({id:x,icon:I.getIconURI(y),text:r.i18n.getText("notificationsBtn_title"),enabled:false,press:function(){E.emit("showNotifications",Date.now());}});N.setModel(w);N.setModel(r.i18nModel,"i18n");o(N);return x;}function q(w,x){var y=new S({id:"endItemsOverflowBtn",tooltip:r.i18n.getText("shellHeaderOverflowBtn_tooltip"),ariaLabel:r.i18n.getText("shellHeaderOverflowBtn_tooltip"),icon:"sap-icon://overflow",press:[w.pressEndItemsOverflow,w]});o(y);y.setModel(x);return y.getId();}function s(w,x){var O=new S({id:"openCatalogBtn",text:r.i18n.getText("open_appFinderBtn"),tooltip:r.i18n.getText("open_appFinderBtn"),icon:"sap-icon://sys-find",visible:!w.disableAppFinder,press:x.handleAppFinderPress});if(a.last("/core/extension/enableHelp")){O.addStyleClass("help-id-openCatalogActionItem");}return O.getId();}function t(){var B="ContactSupportBtn",w=sap.ui.getCore().byId(B);if(!w){var T=new b("tempContactSupportBtn",{visible:true});var x=T.getIcon();var y=T.getText();w=new S({id:B,icon:x,tooltip:y,text:y,press:function(){T.firePress();}});}return B;}function u(){var B="EndUserFeedbackBtn",F=sap.ui.getCore().byId(B);if(!F){var T=new c("EndUserFeedbackHandlerBtn",{});var w=T.getIcon();var x=T.getText();F=new S({id:B,icon:w,tooltip:x,addAriaHiddenFalse:true,ariaLabel:x,text:x,visible:false});}return F.getId();}function v(){var P=new S({id:"productSwitchBtn",icon:"sap-icon://grid",visible:false,tooltip:r.i18n.getText("productSwitch_tooltip"),text:r.i18n.getText("productSwitch"),press:function(){E.emit("showProductSwitch",Date.now());}});return P.getId();}return{init:i,destroy:h,_createOverflowButton:q};});
