/*
 * ! SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/core/library','sap/m/Bar','sap/m/Button','sap/m/CheckBox','sap/m/Label','sap/m/Link','sap/m/List','sap/m/Panel','sap/m/SearchField','sap/m/Text','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/ui/Device','sap/ui/comp/state/UIState','./VariantConverterFrom','./VariantConverterTo','sap/ui/comp/library','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/comp/smartvariants/SmartVariantManagementUi2','sap/ui/comp/variants/VariantManagement','sap/ui/core/InvisibleText','sap/ui/core/Icon','sap/ui/core/Title','sap/ui/layout/Grid','sap/ui/layout/GridRenderer','sap/ui/layout/GridData','sap/ui/layout/HorizontalLayout','sap/ui/layout/VerticalLayout','sap/ui/layout/AlignedFlowLayout','sap/ui/comp/util/IdentifierUtil','sap/m/library','sap/ui/model/json/JSONModel','sap/ui/comp/filterbar/FilterGroupItem','sap/base/Log','sap/base/util/merge'],function(c,B,a,C,L,b,d,P,S,T,e,f,D,U,V,g,l,h,k,m,I,o,p,G,q,r,H,s,A,t,u,J,F,v,w){"use strict";var x=c.ValueState;var y=c.TextAlign;var z=u.ListSeparators;var E=u.ButtonType;var K;var M;var O;var N;var Q;var R;var W;var X;var Y;var Z;var $=u.OverflowToolbarPriority;var _=u.ListMode;var a1=G.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/filterbar/FilterBar.designtime",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:""},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:""},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true},useSnapshot:{type:"boolean",group:"Misc"}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{added:{type:"sap.ui.core.Control"},deleted:{type:"sap.ui.core.Control"},filterItem:{type:"sap.ui.comp.filterbar.FilterGroupItem"}},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{parameters:{context:{type:"string"}}},filtersDialogBeforeOpen:{},filtersDialogCancel:{},filtersDialogSearch:{},filtersDialogSearchForFilters:{parameters:{newValue:{type:"string"}}},assignedFiltersChanged:{}}},renderer:q.render});a1.INTERNAL_GROUP="__$INTERNAL$";a1.prototype.init=function(){var i=this.getFilterContainerWidth();G.prototype.init.apply(this,arguments);this._filterGroupItemChange=this._filterGroupItemChange.bind(this);this._filterItemChange=this._filterItemChange.bind(this,null);this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oDialog=null;this._oFilterDialog=null;this._bIsInitialized=false;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setHSpacing(0);this.addStyleClass("sapUiCompFilterBar sapUiCompFilterBarMarginBottom sapUiCompFilterBarPaddingPanel sapContrastPlus");this.addStyleClass(this._isPhone()?"sapUiCompFilterBarPhone":"sapUiCompFilterBarNonPhone");this._oToolbar=this._createToolbar();this.addContent(this._oToolbar);this._bDelayRendering=true;this._oBasicAreaLayout=new A();this._oBasicAreaLayout.setVisible(false);this._oBasicAreaLayout.setLayoutData(new r({span:"L12 M12 S12"}));this._oBasicAreaLayout.setMinItemWidth(i);this._oBasicAreaLayout.setMaxItemWidth(i);this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new P();this._oAdvancedPanel.setLayoutData(new r({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this.addContent(this._oAdvancedPanel);this.oModel=new J({});this.setModel(this.oModel,"FilterBar");this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:y.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false);}};a1.prototype.setFilterContainerWidth=function(i){this._oBasicAreaLayout.setMinItemWidth(i);if(this.getUseToolbar()){this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());}else{this._setMaxItemWidth2();}this.setProperty("filterContainerWidth",i);return this;};a1.prototype._setMaxItemWidth2=function(){var j,n,g1=this._oBasicAreaLayout.getMinItemWidth();["rem","%","px","em"].some(function(h1){var i=g1.indexOf(h1);if(i>0){g1=g1.substring(0,i);j=h1;return true;}return false;});if(j){n=parseInt(g1);if(!isNaN(n)){n*=2;this._oBasicAreaLayout.setMaxItemWidth(n+j);}}};a1.prototype._hasAnyVisibleFiltersOnFB=function(){var j=this._retrieveVisibleAdvancedItems();for(var i=0;i<j.length;i++){if(j[i].filterItem.getVisibleInFilterBar()){return true;}}return false;};a1.prototype._showHintText=function(){var i=0;if(!this._oHintText){return;}if(this._isNewFilterBarDesign()){return;}if(!this.getAdvancedMode()&&!this._isPhone()){var j=!this._hasAnyVisibleFiltersOnFB();if(j){i=this._oAdvancedPanel.indexOfContent(this._oHintText);if(i<0){this._oAdvancedPanel.insertContent(this._oHintText,0);}}this._oHintText.setVisible(j);this._oAdvancedPanel.setVisible(j);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!j&&this.getFilterBarExpanded());}}};a1.prototype._hasRelevantFilters=function(){var i,n=null,j;if(!this._mAdvancedAreaFilter||(Object.keys(this._mAdvancedAreaFilter)<1)){return false;}if(this.getAdvancedMode()){for(n in this._mAdvancedAreaFilter){var g1=this._mAdvancedAreaFilter[n];if(g1&&g1.items){for(i=0;i<g1.items.length;i++){j=g1.items[i];if(j){if(this._determineVisibility(j.filterItem)){return true;}}}}}return false;}return true;};a1.prototype._adaptButtonsEnablement=function(){var i=false||!!this._mAdvancedAreaFilter;if(this._oHideShowButton){this._oHideShowButton.setEnabled(i);if(this.getAdvancedMode()&&!this._isPhone()){this._oHideShowButton.setVisible(this._hasRelevantFilters());}}this._oClearButtonOnFB.setEnabled(i);this._oRestoreButtonOnFB.setEnabled(i);this._oFiltersButton.setEnabled(i);var j=true;if(this._isPhone()&&this.getUseToolbar()){j=false;}if(i&&this.getFilterBarExpanded()&&j&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true);}};a1.prototype.getVariantManagement=function(){return this._oVariantManagement;};a1.prototype.setShowClearOnFB=function(i){if(!this._isPhone()){this.setProperty("showClearOnFB",i);this._oClearButtonOnFB.setVisible(i);}return this;};a1.prototype.setShowRestoreOnFB=function(i){if(!this._isPhone()){this.setProperty("showRestoreOnFB",i);this._oRestoreButtonOnFB.setVisible(i);}return this;};a1.prototype.setShowGoOnFB=function(i){this.setProperty("showGoOnFB",i);this._calcVisibilityGoButton();return this;};a1.prototype._calcVisibilityGoButton=function(){var i=this.getShowGoOnFB();if(i&&!this._isPhone()&&this.isLiveMode&&this.isLiveMode()){i=false;}this._oSearchButton.setVisible(i);};a1.prototype.setShowGoButton=function(i){this.setShowGoOnFB(i);return this;};a1.prototype.getShowGoButton=function(){return this.getShowGoOnFB();};a1.prototype.hideGoButton=function(){this._oSearchButton.setVisible(false);};a1.prototype.restoreGoButton=function(){this._oSearchButton.setVisible(this.getShowGoOnFB());};a1.prototype.setShowFilterConfiguration=function(i){this.setProperty("showFilterConfiguration",i);if(this._oFiltersButton&&!this._isPhone()){this._oFiltersButton.setVisible(i);}return this;};a1.prototype.isCurrentVariantStandard=function(){var i;if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();if(i===""){return true;}return(i===this._oVariantManagement.getStandardVariantKey());}return undefined;};a1.prototype.setCurrentVariantId=function(i,j){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(i,j);}};a1.prototype.getCurrentVariantId=function(){var i="";if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();}return i;};a1.prototype.getDataSuiteFormat=function(i){return this._getDataSuiteFormat(i,null);};a1.prototype._getDataSuiteFormat=function(i,j){var n=null,g1,h1,i1,j1,k1;if(this._oVariantManagement){g1=this.getCurrentVariantId();if(this.getFilterDataAsString){i1=this._determineVariantFiltersInfo(i,true);if(this.getFilterContextUrl){k1=this.getFilterContextUrl();}if(this.getParameterContextUrl){j1=this.getParameterContextUrl();}h1=this.getFilterDataAsString(i);if(h1){var l1=new g();n=l1.convert(g1,i1,h1,this,j,j1,k1);}}}return n;};a1.prototype.getBasicSearchName=function(){var i=null;if(this._oBasicSearchField&&this.getEntitySet){i="$"+this.getEntitySet()+".basicSearch";}return i;};a1.prototype.getBasicSearchValue=function(){return this._getBasicSearchValue();};a1.prototype.setUiStateAsVariant=function(i){var j={replace:true,strictMode:true};this.setUiState(i,j);this.fireAfterVariantLoad("SPV_VARIANT",false);this._applyVisibility(i.getSelectionVariant());};a1.prototype._applyVisibility=function(i){var j=function(g1){if(g1&&g1.getVisible()&&!g1.getHiddenFilter()){if(!g1.getVisibleInFilterBar()){g1.setVisibleInFilterBar(true);}if(!g1.getPartOfCurrentVariant()){g1.setPartOfCurrentVariant(true);}}};if(this._bIsInitialized){for(var n in this._mAdvancedAreaFilter){if(n){this._mAdvancedAreaFilter[n].items.forEach(function(g1){if(g1&&g1.filterItem&&g1.filterItem.getMandatory()){j(g1.filterItem);}else if(g1&&g1.filterItem){if(g1.filterItem.getVisibleInFilterBar()){g1.filterItem.setVisibleInFilterBar(false);}if(g1.filterItem.getPartOfCurrentVariant()){if(n===a1.INTERNAL_GROUP){g1.filterItem.setPartOfCurrentVariant(true);}else{g1.filterItem.setPartOfCurrentVariant(false);}}}});}}if(i&&i.Parameters){i.Parameters.forEach(function(g1){var h1=this.determineFilterItemByName(g1.PropertyName);j(h1);}.bind(this));}if(i&&i.SelectOptions){i.SelectOptions.forEach(function(g1){var h1=this.determineFilterItemByName(g1.PropertyName);j(h1);}.bind(this));}}};a1.prototype.getUiState=function(i){var j,n,g1=false,h1=null;if(i){g1=(i.allFilters===true);}n=this._getDataSuiteFormat(g1,"13.0");j=new U();j.selectionVariant=JSON.parse(n);j.setSelectionVariant(j.selectionVariant);if(j.getSelectionVariant()){if(this.getModelData&&this.getModelData()){h1=this.getModelData();}j.setValueTexts(U.calculateValueTexts(j.getSelectionVariant(),h1));}return j;};a1.prototype.setUiState=function(i,j){var n,g1,h1=null,i1=false,j1=true;if(j&&typeof j.replace==="boolean"){i1=j.replace;}if(j&&typeof j.strictMode==="boolean"){j1=j.strictMode;}if(i){h1=i.getSelectionVariant();if(h1){g1=JSON.stringify(h1);}n=i.getValueTexts();}this._setDataSuiteFormat(g1,i1,j1,n);};a1.prototype.setDataSuiteFormat=function(i,j){this._setDataSuiteFormat(i,j,true);};a1.prototype._setDataSuiteFormat=function(i,j,n,g1){var h1,i1,j1;if(i){h1=new V();i1=h1.convert(i,this,n);if(i1){this._clearErrorState();if(i1.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(i1.variantId,"DATA_SUITE");}else{this._setFilterVisibility(i1.variantId);}}this._oVariantManagement.setInitialSelectionKey(i1.variantId);}if(i1.payload&&(j||(Object.keys(JSON.parse(i1.payload)).length>0))&&this.setFilterDataAsString){j1=i1.payload;if(g1){j1=U.enrichWithValueTexts(j1,g1);}this.setFilterDataAsString(j1,j);}if(i1.basicSearch&&this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||i1.basicSearch);this._updateToolbarText();}}}};a1.prototype._setFilterVisibility=function(i){if(this._oVariantManagement.getSelectionKey()!==i){this._oVariantManagement.setInitialSelectionKey(i);var j=this._getStandardVariant();if(j){var n=this._oVariantManagement.getVariantContent(this,i);if(n&&n.filterbar){if(n.hasOwnProperty("version")){n=this.mergeVariant(j,n);}this._reapplyVisibility(n.filterbar);}}}};a1.prototype.applySettings=function(j){if(this._possibleToChangeVariantManagement()){if(j&&j.customData){for(var i=0;i<j.customData.length;i++){var n=j.customData[i];if(n&&n.mProperties&&n.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(n.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true;}}}}if(j&&j.persistencyKey){this._bHostedVariantManagement=true;}this._applyLayoutDataToToolbarButtons();G.prototype.applySettings.apply(this,arguments);if(!this.getUseToolbar()&&!this.getFilterBarExpanded()){this.setFilterBarExpanded(true);}this._afterVariantsLoad();};a1.prototype._applyLayoutDataToToolbarButtons=function(i){if(this._isPhone()||this._isTablet()||this.getAdvancedMode()||!this.getUseToolbar()){return;}if(!K&&!this._bToolbarLayoutDataRequested){K=sap.ui.require("sap/m/ToolbarLayoutData");if(!K){sap.ui.require(["sap/m/ToolbarLayoutData"],b1.bind(this));this._bToolbarLayoutDataRequested=true;}}if(!K){return;}this._oHideShowButton.setLayoutData(new K({shrinkable:true}));this._oClearButtonOnFB.setLayoutData(new K({shrinkable:true}));this._oRestoreButtonOnFB.setLayoutData(new K({shrinkable:true}));this._oFiltersButton.setLayoutData(new K({shrinkable:true}));this._oSearchButton.setLayoutData(new K({shrinkable:false}));};function b1(i){K=i;this._bToolbarLayoutDataRequested=false;if(!this._bIsBeingDestroyed){this._applyLayoutDataToToolbarButtons();}}a1.prototype.setPersistencyKey=function(i){this.setProperty("persistencyKey",i);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(true);}return this;};a1.prototype._possibleToChangeVariantManagement=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){return true;}return false;};a1.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection();}};a1.prototype.setSearchEnabled=function(i){this.setProperty("searchEnabled",i);if(this._oSearchButton){this._oSearchButton.setEnabled(i);}return this;};a1.prototype.setSearchButtonEmphType=function(i){};a1.prototype.setSimplifiedMode=function(i){};a1.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false;}return true;};a1.prototype.setExpandAdvancedArea=function(i){this.setFilterBarExpanded(i);return this;};a1.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded();};a1.prototype.setAdvancedMode=function(i){this.setProperty("advancedMode",i);this.toggleStyleClass("sapContrastPlus",!i);if(i){if(!this._oAdvancedAreaForm){this._oAdvancedAreaForm=this._createAdvancedAreaForm();}if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1);}}}}else{if(this.getPersistencyKey()&&this._possibleToChangeVariantManagement()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true);}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}}this._oFiltersButton.setVisible(!i);if(this._oHideShowButton){this._oHideShowButton.setVisible((i&&this._isPhone())?false:true);if(this._oHideShowButton.getVisible()){if(this.getFilterBarExpanded()){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW"));}}}if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!i&&this.getFilterBarExpanded());}this._oAdvancedPanel.setVisible(i&&this.getFilterBarExpanded());this._adaptButtonsEnablement();return this;};a1.prototype.setUseToolbar=function(i){this.setProperty("useToolbar",i);if(!i){this._adaptNewFilterBarDesign();}else{this._recreateToolbar();}return this;};a1.prototype._recreateToolbar=function(){if(!this._oToolbar){this._bButtonaAdded=false;if(this._oButtonsVLayout){this._oBasicAreaLayout.removeContent(this._oButtonsVLayout);this._oButtonsVLayout.destroy();this._oButtonsVLayout=null;}this._oToolbar=this._createToolbar(true);this.insertContent(this._oToolbar,0);if(this._oVariantManagement){if(this._oVariantManagement instanceof k||((this._oVariantManagement.getId()===(this.getId()+"-variant")))){this._oToolbar.insertContent(this._oVariantManagement,0);}}this._adaptButtonsEnablement();if(this._oBasicSearchFieldContainer){this._oBasicAreaLayout.removeContent(this._oBasicSearchFieldContainer);this._cleanBasicSearchContainer();this.setBasicSearch(this._oBasicSearchField);}this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:y.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());this._updateToolbarText();}};a1.prototype._cleanBasicSearchContainer=function(){if(this._oBasicSearchFieldContainer){var j=this._oBasicSearchFieldContainer.removeAllContent();if(j){for(var i=0;i<j.length;i++){if(j[i]!==this._oBasicSearchField){j[i].destroy();}}}this._oBasicSearchFieldContainer.destroy();this._oBasicSearchFieldContainer=null;}};a1.prototype.setHeader=function(i){this.setProperty("header",i);if(this.getUseToolbar()){this._addHeaderToToolbar(i);}return this;};a1.prototype._addHeaderToToolbar=function(i){if(this._oToolbar){if(i){if(this._oVariantManagement&&(this._oVariantManagement.getVisible()||this._bHostedVariantManagement)&&(this._oToolbar.indexOfContent(this._oVariantManagement)>-1)){if(!this._oSeparator){if(!M&&!this._bToolbarSeparatorRequested){M=sap.ui.require("sap/m/ToolbarSeparator");if(!M){sap.ui.require(["sap/m/ToolbarSeparator"],c1.bind(this));this._bToolbarSeparatorRequested=true;}}if(M){this._oSeparator=new M(this.getId()+"-HeadSep");}}this._oToolbar.removeContent(this._oSeparator);this._oToolbar.insertContent(this._oSeparator,0);this._oToolbar.setHeight("3rem");}if(!this._oText){this._oText=new T(this.getId()+"-HeadText");this._oText.addStyleClass("sapMH4Style");this._oText.addStyleClass("sapUiCompSmartChartHeader");}this._oText.setText(i);this._oToolbar.removeContent(this._oText);this._oToolbar.insertContent(this._oText,0);}else{if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);this._oSeparator.destroy();delete this._oSeparator;this._oToolbar.setHeight();}if(this._oText){this._oToolbar.removeContent(this._oText);this._oText.destroy();delete this._oText;}}}};function c1(i){M=i;this._bToolbarSeparatorRequested=false;if(!this._bIsBeingDestroyed){this._addHeaderToToolbar(this.getHeader());}}a1.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false;}if(!this.getUseToolbar()){return true;}return false;};a1.prototype._adaptNewFilterBarDesign=function(){if(this._isNewFilterBarDesign()){this.setFilterBarExpanded(true);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(true&&this.getFilterBarExpanded());}if(this._oToolbar){var j=this._oToolbar.getContent();for(var i=0;i<j.length;i++){this._oToolbar.removeContent(j[i]);if(j[i].isA("sap.m.ToolbarSpacer")){j[i].destroy();}}if(!this.getUseToolbar()){this.removeContent(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null;}}if(this._oHintText){this._oBasicAreaLayout.removeContent(this._oHintText);this._oHintText.destroy();this._oHintText=null;}if(this._oHideShowButton){this._oHideShowButton.destroy();this._oHideShowButton=null;}if(!this._bButtonaAdded){this._bButtonaAdded=true;this._addButtonsToBasicArea();}if(this._oBasicSearchField){this.setBasicSearch(this._oBasicSearchField);}this._oBasicAreaLayout.setMinItemWidth(this.getFilterContainerWidth());this._setMaxItemWidth2();}};a1.prototype._addButtonsToBasicArea=function(){var i=new s();if(sap.ui.getCore().getConfiguration().getRTL()){i.addStyleClass("sapUiCompFilterBarFloatLeft");}else{i.addStyleClass("sapUiCompFilterBarFloatRight");}var j=new H();i.addContent(new T());i.addContent(j);j.addContent(this._oClearButtonOnFB);this._oClearButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oRestoreButtonOnFB);this._oRestoreButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oFiltersButton);this._oFiltersButton.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oSearchButton);this._updateToolbarText();if(this._isPhone()){i.addStyleClass("sapUiCompFilterBarRemoveMinWidth");this._oBasicAreaLayout.insertContent(i,0);}else{this._oBasicAreaLayout.addEndContent(i);}this._oButtonsVLayout=i;};a1.prototype._addBasicSearchToBasicArea=function(i){if(this._oBasicSearchFieldContainer){this._cleanBasicSearchContainer();}if(i){var j=new L({text:"\u2008"});j.addStyleClass("sapBasicSearchFilter");var n=this._addControlToBasicAreaContainer(null,i,j);if(n){n.setVisible(true);var g1=0;if(this._isPhone()){g1=1;}this._oBasicAreaLayout.insertContent(n,g1);this._oBasicSearchFieldContainer=n;this._oBasicSearchFieldContainer.setWidth("100%");}}};a1.prototype._setCollectiveSearch=function(i){if(this.getAdvancedMode()){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._unregisterVariantManagement(this._oVariantManagement);this._oVariantManagement=null;}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch);}this._oCollectiveSearch=i;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}};a1.prototype.setBasicSearch=function(i){var j=this;this.setAssociation("basicSearch",i,true);if(typeof i==="string"){i=sap.ui.getCore().byId(i);}if(this._oBasicSearchField&&this._oToolbar){this._oToolbar.removeContent(this._oBasicSearchField);}if(i&&this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(i);}else{if(i&&this._oToolbar&&(!this._isPhone()||this.getAdvancedMode())){var n=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(i,n);if(this._isUi2Mode()){i.attachLiveChange(function(g1){j.fireFilterChange(g1);});}}}this._oBasicSearchField=i;return this;};a1.prototype._getBasicSearchValue=function(){if(this._oBasicSearchField&&this._oBasicSearchField.getValue){return this._oBasicSearchField.getValue();}return null;};a1.prototype._indexOfSpacerOnToolbar=function(){var j=this._oToolbar.getContent(),i;if(j){for(i=0;i<j.length;i++){if(j[i]instanceof f){return i;}}}return 0;};a1.prototype.addFilterItem=function(i){var n,j,g1;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty");}j=i.getControl();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty");}this.addAggregation("filterItems",i,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[];}var h1={control:i.getControl(),filterItem:i};this._aBasicAreaSelection.push(h1);g1=new F(i.getId()+"__filterGroupItem",{label:i.getLabel(),controlTooltip:i.getControlTooltip(),name:i.getName(),mandatory:i.getMandatory(),visible:i.getVisible(),visibleInFilterBar:i.getVisibleInFilterBar(),partOfCurrentVariant:true,control:i.getControl(),groupName:a1.INTERNAL_GROUP,groupTitle:"",hiddenFilter:i.getHiddenFilter(),entitySetName:i.getEntitySetName(),entityTypeName:i.getEntityTypeName()});if(i.data('isCustomField')){g1.data('isCustomField',true);}i.attachChange(this._filterItemChange);this.addFilterGroupItem(g1);return this;};a1.prototype.addFilterGroupItem=function(i){var n,j,g1,h1;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty");}this.addAggregation("filterGroupItems",i,true);j=i.getGroupName();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty");}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[j]){this._mAdvancedAreaFilter[j]={};this._mAdvancedAreaFilter[j].filterItem=null;this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].items){this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].filterItem){this._mAdvancedAreaFilter[j].filterItem=i;}g1={control:i.getControl(),filterItem:i};if(this.getAdvancedMode()||i.getVisibleInFilterBar()){i.setVisibleInFilterBar(true);}else{i.setVisibleInFilterBar(false);}this._mAdvancedAreaFilter[j].items.push(g1);if(!i.getHiddenFilter()){h1=this._addControlToBasicAreaFormContainer(i);if(h1){g1.container=h1;h1.setVisible(i.getVisible()&&i.getVisibleInFilterBar());if(i.getVisibleInFilterBar()){i.setPartOfCurrentVariant(i.getVisibleInFilterBar());}i.attachChange(this._filterGroupItemChange);}if(this.getAdvancedMode()){this._rerenderAA();}else{this._showHintText();}}this._adaptButtonsEnablement();return this;};a1.prototype.removeFilterItem=function(j){var i,n,g1,h1,i1=this.getFilterItems(),j1=this.getFilterGroupItems();if(!i1||!i1.length){return null;}n=this._getRemovedItemAsObject(j,i1);if(!n){return null;}n.detachChange(this._filterItemChange);for(i=0;i<this._aBasicAreaSelection.length;i++){if(this._aBasicAreaSelection[i].filterItem.getId()===n.getId()){this._aBasicAreaSelection.splice(i,1);if(this._aBasicAreaSelection.length===0){this._aBasicAreaSelection=null;}break;}}this.removeAggregation("filterItems",n,true);g1=n.getId()+"__filterGroupItem";h1=this._getRemovedItemAsObject(g1,j1);this._removeFilterGroupItem(h1);h1.destroy();return n;};a1.prototype.removeFilterGroupItem=function(i){var j,n=this.getFilterGroupItems();if(!n||!n.length){return null;}j=this._getRemovedItemAsObject(i,n);if(!j){return null;}if(j.getGroupName()===a1.INTERNAL_GROUP){v.warning("sap.ui.comp.filterbar.FilterBar.prototype.removeFilterGroupItem() is trying to remove FilterItem");return null;}return this._removeFilterGroupItem(j);};a1.prototype._getRemovedItemAsObject=function(j,n){var i,g1;if(typeof j==="string"){for(i=0;i<n.length;i++){if(n[i].getId()===j){g1=n[i];break;}}}if(typeof j==="number"){if(j<0||j>=n.length){v.warning("sap.ui.comp.filterbar.FilterBar.prototype.removeFilterGroupItems() is called with invalid index "+j);}else{g1=n[j];}}if(typeof j==="object"){g1=j;}return g1;};a1.prototype._removeFilterGroupItem=function(j){var i,n,g1,h1=j.getGroupName();j.detachChange(this._filterGroupItemChange);this.removeAggregation("filterGroupItems",j,true);if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[h1]&&this._mAdvancedAreaFilter[h1].items){n=this._mAdvancedAreaFilter[h1];for(i=0;i<n.items.length;i++){g1=n.items[i];if(g1.filterItem.getId()===j.getId()){g1.container.removeAllContent();g1.container.destroy();n.items.splice(i,1);if(n.filterItem.getId()===j.getId()){if(n.items.length){n.filterItem=n.items[0].filterItem;}else{delete this._mAdvancedAreaFilter[h1];}}break;}}if(this.getFilterGroupItems().length===0){this._mAdvancedAreaFilter=null;this._adaptButtonsEnablement();}}return j;};a1.prototype._addParameter=function(j){var i,n,g1,h1=false,i1=false,j1=a1.INTERNAL_GROUP;j._setParameter(true);j.setVisibleInFilterBar(true);j.setPartOfCurrentVariant(true);this.addAggregation("_parameters",j,true);n={control:j.getControl(),filterItem:j};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[j1]){this._mAdvancedAreaFilter[j1]={};this._mAdvancedAreaFilter[j1].filterItem=null;}if(!this._mAdvancedAreaFilter[j1].items){this._mAdvancedAreaFilter[j1].items=[];}for(i=0;i<this._mAdvancedAreaFilter[j1].items.length;i++){var k1=this._mAdvancedAreaFilter[j1].items[i];if(k1.filterItem._isParameter()){continue;}this._mAdvancedAreaFilter[j1].items.splice(i,0,n);h1=true;break;}if(!h1){this._mAdvancedAreaFilter[j1].items.push(n);if(Object.keys(this._mAdvancedAreaFilter).length>1){i1=true;}}g1=this._addControlToBasicAreaFormContainer(j);if(g1){n.container=g1;g1.setVisible(j.getVisible());j.attachChange(this._filterGroupItemChange.bind(this));}if(h1||i1){this._oBasicAreaLayout.removeContent(g1);if(j.getVisible()){this._addContainerInOrder(n.filterItem,n.container);}}if(!this.getAdvancedMode()){this._showHintText();}this._adaptButtonsEnablement();return this;};a1.prototype._filterItemChange=function(i,j){var n,g1,h1,i1;if(j&&j.oSource&&(j.oSource.isA("sap.ui.comp.filterbar.FilterItem"))){h1=j.getParameter("propertyName");if(h1==="visibleInFilterBar"||h1==="visible"||h1==="label"||h1==="labelTooltip"||h1==="controlTooltip"||h1==="mandatory"){n=this._determineItemByName(j.oSource.getName(),a1.INTERNAL_GROUP);if(n&&n.filterItem){if((h1==="visible")){g1=j.oSource.getVisible();n.filterItem.setVisible(g1);}else if(h1==="visibleInFilterBar"){g1=j.oSource.getVisibleInFilterBar();var j1=this._checkChangePossibleVisibleInFilterBar(n.filterItem,g1);if(j1){n.filterItem.setVisibleInFilterBar(g1);}else{j.oSource.setVisibleInFilterBar(true);}}else if(h1==="label"){n.filterItem.setLabel(j.oSource.getLabel());}else if(h1==="labelTooltip"){n.filterItem.setLabelTooltip(j.oSource.getLabelTooltip());}else if(h1==="controlTooltip"){i1=this.determineControlByFilterItem(n.filterItem,true);if(i1&&i1.setTooltip){i1.setTooltip(n.filterItem.getControlTooltip());}}else if(h1==="mandatory"){g1=j.oSource.getMandatory();n.filterItem.setMandatory(g1);}}}}};a1.prototype._filterGroupItemChange=function(i){var j;var n;if(i&&i.oSource){n=i.getParameter("propertyName");if(n==="visibleInFilterBar"||n==="visible"){j=this._determineItemByName(i.oSource.getName(),i.oSource.getGroupName());if(j){if(n==="visibleInFilterBar"){var g1=i.oSource.getVisibleInFilterBar();var h1=this._checkChangePossibleVisibleInFilterBar(i.oSource,g1);if(!h1){i.oSource.setVisibleInFilterBar(true);g1=true;}if(g1){i.oSource.setPartOfCurrentVariant(true);}if(!this.getAdvancedMode()&&!this._oDialog){this._rerenderItem(j);this._adaptLinkText(i.oSource.getGroupName());}}else if(n==="visible"){if(this.getAdvancedMode()&&j.container){j.container.setVisible(true);}else{this._updateToolbarText();this._rerenderGroup(j,i.oSource.getGroupName());}}this._showHintText();}}else if(n==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i.oSource.getGroupName()]){if(this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer.setTitle(i.oSource.getGroupTitle());}else{this._adaptGroupTitle(i.oSource.getGroupName());}}}else if(n==="label"){if(!this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._adaptGroupTitleForFilter(i.oSource);}}else if(n==="mandatory"){if(this._oFilterDialog){this._adaptMandatoryForFilter(i.oSource);}}else if((n==="partOfCurrentVariant")&&this.ensureLoadedValueHelpList){var i1=this.determineFilterItemByName(i.oSource.getName());if(i1&&i1.getPartOfCurrentVariant()){this.ensureLoadedValueHelpList(i.oSource.getName());}}if(this.getAdvancedMode()){this._rerenderAA();}}};a1.prototype._addContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)===-1)){this._addContainerInOrder(i.filterItem,i.container);}}}};a1.prototype._removeContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)>-1)){this._oBasicAreaLayout.removeContent(i.container);}}}};a1.prototype._addContainerInOrder=function(j,g1){var n,i,h1,i1=this._oBasicAreaLayout.getContent(),j1=-1;if(this._isNewFilterBarDesign()){if(this._isPhone()){j1++;}if(this._oBasicSearchField){j1++;}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){var k1=this._mAdvancedAreaFilter[n];if(k1&&k1.items){for(i=0;i<k1.items.length;i++){if(!k1.items[i].container){continue;}if(k1.items[i].container===g1){this._oBasicAreaLayout.insertContent(g1,j1+1);return;}h1=i1.indexOf(k1.items[i].container);if(h1>=0){j1=h1;}}}}}};a1.prototype._checkChangePossibleVisibleInFilterBar=function(i,j){if(i&&i.getMandatory()&&!j){var n=this._hasFilterValue(i);if(!n){i.setVisibleInFilterBar(true);return false;}}return true;};a1.prototype._adaptLinkText=function(i){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i]&&this._mAdvancedAreaFilter[i].link){this._setLinkText(i,this._mAdvancedAreaFilter[i].link);}};a1.prototype._hasFilterValue=function(i){var j;if(!this._getTriggerFilterChangeState()&&this.getAllFiltersWithValues){j=this.getAllFiltersWithValues();}else{j=this._getFiltersWithValues();}return this._checkFilterForValue(j,i);};a1.prototype._adaptMandatoryForFilter=function(i){var j;var n=i.getGroupName();if(i){j=this._determineItemByName(i.getName(),n);if(j&&j.checkbox&&j.checkbox.getVisible()){var g1=true;if(i.getMandatory()){var h1=this._hasFilterValue(i);if(!h1){g1=false;i.setVisibleInFilterBar(true);}}j.checkbox.setEnabled(g1);}}};a1.prototype._adaptGroupTitleForFilter=function(i){var j;var n;if(i&&!i.getHiddenFilter()){j=i.getLabel();n=i.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(n&&i.getGroupTitle()){n.setText(j+" ("+i.getGroupTitle()+')');}}else{n.setText(j);}}};a1.prototype._adaptGroupTitle=function(j){var i;var n;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if(n&&n){this._adaptGroupTitleForFilter(n.filterItem);}}}};a1.prototype._adaptGroupsTitle=function(){var n=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&n!==a1.INTERNAL_GROUP){this._adaptGroupTitle(n);}}}};a1.prototype.registerGetFiltersWithValues=function(i){this._fRegisterGetFiltersWithValues=i;return this;};a1.prototype.registerFetchData=function(i){this._fRegisteredFetchData=i;return this;};a1.prototype.registerApplyData=function(i){this._fRegisteredApplyData=i;return this;};a1.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true;}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true;}}return false;};a1.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null);}this._fireInitialiseEvent();}else{this._initializeVariantManagement();}};a1.prototype.variantsInitialized=function(){this._afterVariantsLoad();this.fireInitialized();};a1.prototype.fireInitialized=function(){this.fireEvent("initialized");};a1.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this);}else{this._fInitialiseVariants=this._initialiseVariants.bind(this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants,this);this._oVariantManagement.initialise();}}else{this._fireInitialiseEvent();}};a1.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise");this._showHintText();}catch(i){v.error("error during initialise event handling - "+i.message);}this._bIsInitialized=true;this._updateToolbarText();};a1.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};a1.prototype.fireAfterVariantLoad=function(i,j){this._rerenderFilters();var n={context:i,executeOnSelect:j};try{this.fireEvent("afterVariantLoad",n);}catch(ex){v.error("error during 'afterVariantLoad' event handling - "+ex.message);}};a1.prototype.fireBeforeVariantSave=function(i){var j={context:i};var n=this._getConsiderFilterChanges();if(i){this._setConsiderFilterChanges(false);}this.fireEvent("beforeVariantSave",j);if(i){this._setConsiderFilterChanges(n);}};a1.prototype.removeAllFilterItems=function(){var i,j=this.getFilterItems();if(j&&j.length){for(i=0;i<j.length;i++){this.removeFilterItem(j[i]);}}return j;};a1.prototype.removeAllFilterGroupItems=function(){var i,j=[],n=this.getFilterGroupItems();if(n&&n.length){for(i=0;i<n.length;i++){if(n[i].getGroupName()===a1.INTERNAL_GROUP){continue;}j.push(n[i]);this.removeFilterGroupItem(n[i]);}}return j;};a1.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch();};a1.prototype.removeBasicSearch=function(){this.setBasicSearch(null);};a1.prototype.getAllFilterItems=function(j){var i,n=null;var g1=[];var h1,i1;if(!j){this._ensureFilterLoaded(null);}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){h1=this._mAdvancedAreaFilter[n];if(h1.items){for(i=0;i<h1.items.length;i++){i1=h1.items[i];if(i1&&i1.filterItem&&i1.filterItem.getVisible()){if(j){if(i1.filterItem.getVisibleInFilterBar()||i1.filterItem.getPartOfCurrentVariant()){g1.push(i1.filterItem);}}else{g1.push(i1.filterItem);}}}}}}}return g1;};a1.prototype._clearErrorState=function(){this._resetFiltersInErrorValueState();};a1.prototype.getAggregation=function(n){if(n=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null);}return G.prototype.getAggregation.apply(this,arguments);};a1.prototype._getFilterInformation=function(){return[];};a1.prototype._createVisibleFilters=function(){this._getFilters();};a1.prototype._getFilters=function(){this._aFields=this._getFilterInformation();var i,j;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[a1.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[a1.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[a1.INTERNAL_GROUP].items=null;}}for(i=0;i<this._aFields.length;i++){j=this._aFields[i];if(j.groupName!==a1.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[j.groupName]){this._mAdvancedAreaFilter[j.groupName]={};this._mAdvancedAreaFilter[j.groupName].groupTitle=j.groupTitle;this._mAdvancedAreaFilter[j.groupName].filterItem=null;this._mAdvancedAreaFilter[j.groupName].items=[];}}if(j.visibleInAdvancedArea||(j.groupName===a1.INTERNAL_GROUP)){this._instanciateFilterItem(j);}}}this._adaptButtonsEnablement();};a1.prototype.isVisibleInFilterBarByName=function(n){var i,j=this._getFilterMetadata(n);if(j&&j.factory){if((j.hasOwnProperty("visibleInAdvancedArea")&&j.visibleInAdvancedArea)||(j.groupName===a1.INTERNAL_GROUP)){return true;}}else{i=this.determineFilterItemByName(n);if(i){return i.getVisibleInFilterBar();}}return false;};a1.prototype._getFilterMetadata=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i];}}}return null;};a1.prototype.getNonVisibleCustomFilterNames=function(){if(this._aFields.length>0){return this._getLazyNonVisibleCustomFilterNames();}else{return this._getNonVisibleCustomFilterNames();}};a1.prototype._getLazyNonVisibleCustomFilterNames=function(){var i=this,j=[];this._aFields.forEach(function(n){if(n.factory){if(n.isCustomFilterField&&!n.visibleInAdvancedArea){j.push(n.fieldName);}}else if(i._isNonVisibleCustomFilterNamesByName(n.fieldName,n.groupName)){j.push(n.fieldName);}});return j;};a1.prototype._isNonVisibleCustomFilterNamesByName=function(n,j){var i,g1;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){g1=this._mAdvancedAreaFilter[j].items[i];if(g1.filterName&&(g1.filterItem.getName()===n)){return this._isNonVisibleCustomFilterNamesByFilter(g1.filterItem);}}}return false;};a1.prototype._isNonVisibleCustomFilterNamesByFilter=function(i){if(i.data("isCustomField")&&!i.getVisibleInFilterBar()){return true;}return false;};a1.prototype._getNonVisibleCustomFilterNames=function(){var i=this,j=[],n=this.getAllFilterItems();if(n){n.forEach(function(g1){if(i._isNonVisibleCustomFilterNamesByFilter(g1)){j.push(g1.getName());}});}return j;};a1.prototype._ensureFilterLoaded=function(n){var i,j,g1;if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){g1=this._aFields[j];if(!g1.factory){continue;}if(n){for(i=0;i<n.length;i++){if(g1.fieldName===n[i].name){if(g1.groupName===n[i].group){this._instanciateFilterItem(g1);break;}else if(g1.groupEntityType===n[i].group){this._instanciateFilterItem(g1);}}}}else{this._instanciateFilterItem(g1);}}if(!n){this._aFields=[];}}};a1.prototype._instanciateFilterItem=function(i){var j=i.factory;if(j){delete i.factory;j.call(i);}};a1.prototype._destroyItems=function(j){if(j&&j.length){for(var i=0;i<j.length;i++){j[i].destroy();}}};a1.prototype._reapplyVisibility=function(j){var i,n=null;var g1;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var h1=this._mAdvancedAreaFilter[n];if(h1&&h1.items){for(i=0;i<h1.items.length;i++){g1=h1.items[i];if(g1&&g1.filterItem){this._setPersVisibility(j,g1.filterItem);}}if(n!==a1.INTERNAL_GROUP){this._adaptLinkText(n);}}}}}};a1.prototype._setPersVisibility=function(i,j){var n,g1;if(j&&!j.getHiddenFilter()){n=j.getGroupName();g1=this._checkForFilterInfo(i,j);if(this._isTINAFScenario()){if(g1){j.setVisibleInFilterBar(g1.visibleInFilterBar);j.setPartOfCurrentVariant(g1.partOfCurrentVariant);if(g1.hasOwnProperty("visible")){j.setVisible(g1.visible);}}else{j.setVisibleInFilterBar(false);if((n===a1.INTERNAL_GROUP)||j._isParameter()){j.setPartOfCurrentVariant(true);}else{j.setPartOfCurrentVariant(false);}}}else{if(g1&&(g1.visibleInFilterBar!==undefined)){j.setVisibleInFilterBar((g1.visibleInFilterBar));j.setPartOfCurrentVariant((g1.partOfCurrentVariant));}else{if((n!==a1.INTERNAL_GROUP)&&g1&&(g1.group===n)){j.setVisibleInFilterBar((g1!==null));}}}if(n===a1.INTERNAL_GROUP){j.setPartOfCurrentVariant(true);}if(j){var h1=this.determineControlByFilterItem(j,true);if(h1&&h1.getValueState&&(h1.getValueState()!==x.None)){h1.setValueState(x.None);}}}};a1.prototype._checkForFilterInfo=function(n,g1){var i,j,h1=g1.getName(),i1=[g1.getGroupName(),g1.getEntitySetName(),g1.getEntityTypeName()];var j1=[];if(n&&n.length){for(i=0;i<n.length;i++){if(n[i].name===h1){if(i1.indexOf(n[i].group)>-1){j1.push(n[i]);}}}}if(j1.length===1){return j1[0];}else if(j1.length>1){for(j=0;j<i1.length;j++){for(i=0;i<j1.length;i++){if(j1[i].group===i1[j]){return j1[i];}}}}return null;};a1.prototype._createVariantManagement=function(){var i=new k(this.getId()+"-variantUi2",{});var j=new h({type:"filterBar",keyName:"persistencyKey"});j.setControl(this);i.addPersonalizableControl(j);i.addStyleClass("sapUiCompFilterBarMarginLeft");return i;};a1.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged");};a1.prototype.retrieveFiltersWithValuesAsText=function(){var j,n,g1=this.retrieveFiltersWithValues(),h1,i1=this.getBasicSearchValue();if(i1&&g1){g1.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"));}if(!g1||(g1.length===0)){j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO");}else{if(!this._isPhone()){h1=Math.min(5,g1.length);n="";for(var i=0;i<h1;i++){n+=g1[i];if(i<(h1-1)){n+=', ';}}j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[g1.length,n]);if(h1<g1.length){j+=", ...";}}else{j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[g1.length]);}}return j;};a1.prototype.retrieveFiltersWithValues=function(){var i,j=[];var n=this._getFiltersWithValues();if(n){for(i=0;i<n.length;i++){if(n[i].getVisible()&&n[i].getPartOfCurrentVariant()){j.push(n[i].getLabel());}}}return j;};a1.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues();}catch(i){v.error("callback for obtaining the filter count throws an exception");}}return null;};a1.prototype._getFiltersWithValuesCount=function(){var n=0;var i=this.retrieveFiltersWithValues();n=i.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){n++;}return n;};a1.prototype._checkFilterForValue=function(j,n){var i;if(j){for(i=0;i<j.length;i++){if(j[i]===n){return true;}}}return false;};a1.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()&&this._oToolbar){var j=false;var n=this._oToolbar.getContent();for(var i=0;i<n.length;i++){if(n[i]instanceof f){continue;}if(n[i].getVisible&&n[i].getVisible()){j=true;break;}}this._oToolbar.setVisible(j);}};a1.prototype._toggleHideShow=function(){this.setFilterBarExpanded(!this.getFilterBarExpanded());};a1.prototype._updateToolbarText=function(){var i=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var j=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var n=this._getFiltersWithValuesCount();var g1=n?(this._oRb.getText(i,[n])):(this._oRb.getText(j));if(g1!==this._oFiltersButton.getText()){this._oFiltersButton.setText(g1);if(this._oBasicAreaLayout){this._oBasicAreaLayout.reflow();}}this._oFiltersButton.setTooltip(g1);this.fireAssignedFiltersChanged();};a1.prototype.setFilterBarExpanded=function(i){var j;if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",i);if(this._oHideShowButton){if(i){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW"));}}this._calcVisibilityGoButton();this._oAdvancedPanel.setVisible(i);}else{if(this._isPhone()&&this.getUseToolbar()){j=false;}else{j=i;}this.setProperty("filterBarExpanded",j);if(this._isNewFilterBarDesign()){return this;}if(this._isPhone()){if(this._oHideShowButton){this._oHideShowButton.setVisible(false);}this._calcVisibilityGoButton();this._oBasicAreaLayout.setVisible(false);}else{if(this._oHideShowButton){if(j){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_SHOW"));}this._oHideShowButton.setVisible(true);}this._calcVisibilityGoButton();if(this._oHideShowButton){if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(j);}else{this._oBasicAreaLayout.setVisible(false);}}}}this._updateToolbarText();return this;};a1.prototype._selectionChangedInFilterDialog=function(i,j){j.setVisibleInFilterBar(i.getSelected());if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;};a1.prototype._mandatoryFilterChange=function(i){if(!i){return;}var j=i.getParameters();if(!j||!j.oSource){return;}var n=this._determineByControl(j.oSource);if(n&&n.checkbox){var g1=n.filterItem;if(!g1.getMandatory()){return;}var h1=this._hasFilterValue(g1);if(g1.getVisibleInFilterBar()){if(h1){n.checkbox.setEnabled(true);}else{n.checkbox.setEnabled(false);}}else{if(!h1){g1.setVisibleInFilterBar(true);n.checkbox.setSelected(true);n.checkbox.setEnabled(false);}}}};a1.prototype._createFiltersAndAdaptBasicArea=function(){var i;this._setConsiderFilterChanges(false);this._recreateBasicAreaContainer(true);i=this._createFilters();this._retrieveVisibleAdvancedItems();this._setConsiderFilterChanges(true);return i;};a1.prototype._determineNotAssignedFiltersCount=function(j){var n=0,i,g1;if(this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){g1=this._mAdvancedAreaFilter[j].items[i].filterItem;if(!g1.getVisible()||g1.getHiddenFilter()){continue;}if(!g1.getPartOfCurrentVariant()&&!g1.getVisibleInFilterBar()){n++;}}}return n;};a1.prototype._rerenderGroup=function(j,n){var i;var g1;this._rerenderItem(j);this._adaptLinkText(n);if(j.formelement){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items&&this._mAdvancedAreaFilter[n].formcontainer){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){g1=this._mAdvancedAreaFilter[n].items[i].filterItem;if(g1&&g1.getVisible()){this._mAdvancedAreaFilter[n].formcontainer.setVisible(true);return;}}this._mAdvancedAreaFilter[n].formcontainer.setVisible(false);}}};a1.prototype._setLinkTextAndCount=function(i,j,n){var g1;if(n){g1=this._oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[n]);}else{g1=this._oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS");}j.setText(g1);};a1.prototype._setLinkText=function(i,j){var n=this._determineNotAssignedFiltersCount(i);this._setLinkTextAndCount(i,j,n);};a1.prototype._createLink=function(i,j){var n,g1=this;n=t.replace(i);var h1=new b(this.getId()+"-link-"+n);this._setLinkText(i,h1);h1.attachPress(function(){g1._createAddRemoveFiltersDialog(i,h1);});return h1;};a1.prototype._isPhone=function(){return(D.system.phone)?true:false;};a1.prototype._isTablet=function(){return(D.system.tablet&&!D.system.desktop)?true:false;};a1.prototype._createForm=function(i){var j=this;var n=new R(this.getId()+"-form",{editable:true,layout:i});n.contentOnAfterRendering=function(g1,h1){R.prototype.contentOnAfterRendering.apply(this,arguments);if(h1.isA("sap.m.MultiInput")){j._adaptStyleSheet(h1);}};return n;};a1.prototype._adaptStyleSheet=function(i){var j;var n;if(i.isA("sap.m.MultiInput")){n=i.$();if(n){j=n.parent().css("overflow");if(j!=="visible"){n.parent().css({"overflow":"visible"});}}}};a1.prototype._addFieldToFiltersDialog=function(i,j,n){var g1,h1,i1,j1;if(!i&&!i.filterItem||i.filterItem.getHiddenFilter()){return;}var k1=this._determineVisibility(i.filterItem);if(i.control.getWidth){i.width=i.control.getWidth();if(i.control.setWidth){i.control.setWidth("100%");}}g1=i.filterItem.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){g1.setText(i.filterItem.getLabel());}h1=new C({tooltip:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});h1.setSelected(i.filterItem.getVisibleInFilterBar());if(i.filterItem.getMandatory()){j1=this._checkFilterForValue(n,i.filterItem);if(!j1&&i.filterItem.getVisibleInFilterBar()){h1.setEnabled(false);}}h1.attachSelect(this._selectionChangedInFilterDialog.bind(this,h1,i.filterItem));if(this._isNewFilterBarDesign()||!this._isPhone()){i.control.setLayoutData(new r({span:"L8 M8 S11"}));h1.setLayoutData(new r({span:"L1 M1 S1"}));}else{i.control.setLayoutData(new r({span:"L8 M8 S12"}));h1.setVisible(false);}i1=new X({label:g1,fields:[i.control,h1]});i1.setVisible(k1);i.formelement=i1;i.checkbox=h1;j.addFormElement(i1);};a1.prototype._createHeaderAddToFilterBar=function(i){var j;if(this._isNewFilterBarDesign()||!this._isPhone()){j=new L(this.getId()+"-addToFilterBar",{text:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});var n=new Z({text:i.getTitle().getText(),level:c.TitleLevel.H5,titleStyle:c.TitleLevel.H5});var g1=new e(this.getId()+"-addToFilterBarToolbar",{content:[n,new f(),j]});i.setToolbar(g1);i.addAriaLabelledBy(n);j.setLabelFor(null);}};a1.prototype._addBasicSearchAddToFilterBar=function(i){var j;if(!this._isPhone()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();if(this._oToolbar){this._replaceOnToolbar(this._oBasicSearchField,this._oBasicSearchFieldClone);}else{this._addBasicSearchToBasicArea(this._oBasicSearchFieldClone);}}else{if(this.getAdvancedMode()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();}}if(this._isNewFilterBarDesign()||!this._isPhone()){this._oBasicSearchField.setLayoutData(new r({span:"L8 M8 S11",indent:"L3 M3 S0"}));}else{this._oBasicSearchField.setLayoutData(new r({span:"L8 M8 S12"}));}if(this._isPhone()&&this.getAdvancedMode()){j=new X({fields:[this._oBasicSearchFieldClone]});}else{j=new X({fields:[this._oBasicSearchField]});}i.addFormElement(j);};a1.prototype._isGroupEmpty=function(i){var j=true;i.some(function(n){if(n.filterItem&&n.filterItem.getVisible()&&!n.filterItem.getHiddenFilter()){j=false;return true;}return false;});return j;};a1.prototype._createFilters=function(){var j=this,n=null,i,g1;var h1=null,i1,j1,k1;var l1,m1,n1=true,o1;this._oClonedVM=null;var p1=new Y();p1.setColumnsL(1);p1.setLabelSpanL(3);p1.setColumnsM(1);p1.setLabelSpanM(3);var q1=this._createForm(p1);q1.addStyleClass("sapUiCompFilterBarDialogForm");if(this._possibleToChangeVariantManagement()&&this._oToolbar){var r1=this._oToolbar.indexOfContent(this._oVariantManagement);if(r1>=0){var s1=m.prototype._setSelection;m.prototype._setSelection=function(){};this._oClonedVM=this._oVariantManagement.clone();m.prototype._setSelection=s1;this._oClonedVM._setSelectionByKey(this._oVariantManagement.getSelectionKey());this._replaceOnToolbar(this._oVariantManagement,this._oClonedVM);h1=new W();this._oVariantManagement.setLayoutData(new r({span:"L10 M10 S12"}));i1=new X({fields:this._oVariantManagement});h1.addFormElement(i1);q1.addFormContainer(h1);}q1.addStyleClass("sapUiCompFilterBarGroupTitle");}if(this._oBasicSearchField&&!this._isNewFilterBarDesign()){if(!h1){h1=new W();q1.addFormContainer(h1);}this._addBasicSearchAddToFilterBar(h1);}this._ensureFilterLoaded(null);var t1=this._getFiltersWithValues();this._fRegisteredFilterChangeHandlers=function(u1){j._mandatoryFilterChange(u1);};this.attachFilterChange(this._fRegisteredFilterChangeHandlers);this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified();}this._oInitialVariant={};w(this._oInitialVariant,this._oVariant);for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){if(n===a1.INTERNAL_GROUP){g1=this._oRb.getText("FILTER_BAR_BASIC_GROUP");}else{g1=this._mAdvancedAreaFilter[n].filterItem.getGroupTitle();}m1=new p({text:g1});h1=new W({title:m1});if(n1&&!this._isGroupEmpty(this._mAdvancedAreaFilter[n].items)){n1=false;this._createHeaderAddToFilterBar(h1);if(this._oBasicSearchField&&this._isNewFilterBarDesign()){this._addBasicSearchAddToFilterBar(h1);}}o1=0;this._mAdvancedAreaFilter[n].formcontainer=h1;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){k1=this._mAdvancedAreaFilter[n].items[i];this._addFieldToFiltersDialog(k1,h1,t1);if(!k1.filterItem.getVisible()){o1++;}}j1=h1.getFormElements();if(j1&&j1.length>0){if((n!==a1.INTERNAL_GROUP)&&!this.getAdvancedMode()){l1=this._createLink(n,m1);if(l1){if(this._isPhone()){l1.setLayoutData(new r({span:"L8 M8 S12"}));}else{l1.setLayoutData(new r({span:"L8 M8 S12",indent:"L3 M3 S0"}));}i1=new X({fields:[l1]});this._mAdvancedAreaFilter[n].link=l1;h1.addFormElement(i1);}if(o1===j1.length){h1.setVisible(false);}}q1.addFormContainer(h1);}}}return q1;};a1.prototype._replaceOnToolbar=function(i,n){var j;if(this._oToolbar){j=this._oToolbar.indexOfContent(i);if(j>-1){this._oToolbar.insertContent(n,j);this._oToolbar.removeContent(i);}}};a1.prototype._recreateBasicAreaContainer=function(j){var n=null,i;var g1,h1;var i1,j1,k1;if(this._possibleToChangeVariantManagement()&&this._oToolbar&&this._oClonedVM&&this._oVariantManagement){this._replaceOnToolbar(this._oClonedVM,this._oVariantManagement);this._oClonedVM.destroy();this._oClonedVM=null;}if(!this._isPhone()&&this._oToolbar&&this._oBasicSearchFieldClone&&this._oBasicSearchField){this._replaceOnToolbar(this._oBasicSearchFieldClone,this._oBasicSearchField);this._oBasicSearchFieldClone.destroy();this._oBasicSearchFieldClone=null;}var l1=this._oBasicAreaLayout.removeAllContent();if(!j){if(l1){var m1=l1.length;var n1=0;if(this._isNewFilterBarDesign()){if(this._isPhone()){n1++;}else{m1--;}}for(i=n1;i<m1;i++){if(l1[i]!==this._oHintText){l1[i].destroy();}}}}if(this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(this._oBasicSearchField);this._addButtonsToBasicArea();}for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){i1=this._mAdvancedAreaFilter[n].items[i].filterItem;if(i1.getHiddenFilter()){continue;}k1=null;if(j){if(!i1.getVisible()||!i1.getVisibleInFilterBar()){continue;}j1=this._mAdvancedAreaFilter[n].items[i].container;if(j1){if(j1.$()&&j1.$().width()){k1=j1.$().width();}j1.removeAllContent();j1.destroy();}g1=this._mAdvancedAreaFilter[n].items[i].control.clone();h1=i1.getLabelControl(this.getId()).clone();h1.setLabelFor(null);if(this.getConsiderGroupTitle()){i1.getLabelControl(this.getId()).setText(i1.getLabel());}}else{g1=this._mAdvancedAreaFilter[n].items[i].control;h1=i1.getLabelControl(this.getId());if(this._mAdvancedAreaFilter[n].items[i].width){g1.setWidth("100%");}}j1=this._addControlToBasicAreaContainer(i1,g1,h1);if(j1){j1.setVisible(i1.getVisible()&&i1.getVisibleInFilterBar());this._mAdvancedAreaFilter[n].items[i].container=j1;if(j&&k1){j1.setWidth("100%");}}}}}};a1.prototype._focusOnFirstFilterInError=function(){for(var n in this._mAdvancedAreaFilter){if(this._mAdvancedAreaFilter[n].items){for(var i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.control&&j.control.getValueState&&j.control.getValueState()==="Error"){j.control.getDomRef().scrollIntoView();return;}}}}};a1.prototype._searchRequested=function(){var i,j=false;if(this.verifySearchAllowed){i=this.verifySearchAllowed();if(i.hasOwnProperty("pending")){return;}else if(i.hasOwnProperty("error")||i.hasOwnProperty("mandatory")){j=true;}}if(j){this._bOKFiltersDialogTriggered=false;if(this._oFiltersSearchField.getValue()){this._resetFilterBarSearch();}this._activateMainContent();this._focusOnFirstFilterInError();}else{this._bOKFiltersDialogTriggered=true;if(!this.isLiveMode||!this.isLiveMode()){this.search();}else{this._oFilterDialog.close();}}};a1.prototype._activateMainContent=function(){var i=this.getFilterDialogContent();if(i&&(i.length>1)){this.addFilterDialogContent(i[0]);}};a1.prototype.fireSearch=function(i){if(this._oFilterDialog&&this._bOKFiltersDialogTriggered){this._oFilterDialog.close();}this.fireEvent("search",i);};a1.prototype._closeDialogAndRestoreFilterBar=function(i){this._sSearchCriteriaInFiltersDialog=null;this._oVariant={};i.removeAllFormContainers();this._recreateBasicAreaContainer();this._deleteProperties();this._adaptGroupsTitle();if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null;}this._updateToolbarText();};a1.prototype._variantSave=function(i){var j;this._oVariant={};this.fireBeforeVariantSave();if(this._oVariantManagement&&this._oFilterDialog){j=this._oVariantManagement.getSelectionKey();this._oVariant.key=j;this._oVariant.modified=false;this._oVariant.content=this._oVariantManagement.getVariantContent(this,j);}};a1.prototype._afterVariantSave=function(i){this.fireAfterVariantSave();};a1.prototype._variantSavePressed=function(i){this._bVariantSavePressed=true;if(this._oVariantManagement){var j=this._oVariantManagement.getSelectionKey();var n=this._oVariantManagement.getItemByKey(this._oVariantManagement.getSelectionKey());if(!this._oVariantManagement._isIndustrySolutionModeAndVendorLayer()&&((j===this._oVariantManagement.getStandardVariantKey())||(n&&n.getReadOnly&&n.getReadOnly()))){this._oVariantManagement._openSaveAsDialog();}else{this._oVariantManagement._variantSavePressed();}this._bDirtyViaDialog=false;if(this._oInitialVariant&&this._oVariantManagement._getVariantContent){this._oInitialVariant.content=this._oVariantManagement._getVariantContent(this,j);}}};a1.prototype._filterSetInErrorState=function(i){if(this._oFilterDialog&&this._oFilterDialog.isOpen()){if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;}};a1.prototype._cancelFilterDialog=function(i){if(i&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled;}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===false)){this.fireCancel();return;}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){this._resetFiltersInErrorValueState();var j=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(j);this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement._setSelectionByKey(this._oInitialVariant.key);}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified);}this.fireCancel();}};a1.prototype._resetFiltersInErrorValueState=function(){var n;n=this._retrieveCurrentSelectionSet(true,true);n.forEach(function(i){if(i.control&&i.control.setValueState&&i.control.getValueState){if(i.control.getValueState()===x.Error){if(i.control.setValue){i.control.setValue("");}i.control.setValueState(x.None);}}});};a1.prototype.showFilterDialog=function(){if(!this._oFilterDialog){this._showFilterDialog();}};a1.prototype.addFilterDialogContent=function(i){if(this._oFilterDialog&&i){var n=this._oFilterDialog.indexOfContent(i);if(n<0){this._oFilterDialog.addContent(i);}return this._setFilterDialogActiveContent(i);}return null;};a1.prototype.getFilterDialogContent=function(){if(this._oFilterDialog){return this._oFilterDialog.getContent();}return null;};a1.prototype._setFilterDialogActiveContent=function(n){var i=false;if(this._oFilterDialog){this.getFilterDialogContent().forEach(function(j){if(n===j){j.setVisible(true);i=true;}else{j.setVisible(false);}});if(i){return n;}}return null;};a1.prototype._getFilterDialogActiveContent=function(){var i=null;if(this._oFilterDialog){this.getFilterDialogContent().some(function(j){if(j.getVisible()){i=j;return true;}return false;});}return i;};a1.prototype.setContentWidth=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentWidth(n+"px");}};a1.prototype.setContentHeight=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentHeight(n+"px");}};a1.prototype._showFilterDialog=function(){if((!N||!O||!R||!W||!X||!Y||!Z)&&!this._bDialogRequested){N=sap.ui.require("sap/m/Dialog");O=sap.ui.require("sap/m/OverflowToolbarLayoutData");R=sap.ui.require("sap/ui/layout/form/Form");W=sap.ui.require("sap/ui/layout/form/FormContainer");X=sap.ui.require("sap/ui/layout/form/FormElement");Y=sap.ui.require("sap/ui/layout/form/ResponsiveGridLayout");Z=sap.ui.require("sap/m/Title");if(!N||!O||!R||!W||!X||!Y||!Z){sap.ui.require(["sap/m/Dialog","sap/m/OverflowToolbarLayoutData","sap/ui/layout/form/Form","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/layout/form/ResponsiveGridLayout","sap/m/Title"],d1.bind(this));this._bDialogRequested=true;}}if(!N||!O||!R||!W||!X||!Y||!Z){return;}var i=this;this._oFilterDialog=new N(this.getId()+"-adapt-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true,contentWidth:"60rem"});this._oFilterDialog.isPopupAdaptationAllowed=function(){return false;};this._oFilterDialog.setParent(this);this._oFilterDialog.addStyleClass("sapUiPopupWithPadding");if(this.$().closest(".sapUiSizeCompact").length>0){this._oFilterDialog.addStyleClass("sapUiSizeCompact");}this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialog");if(!this._isPhone()){this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialogNonPhone");}var j="FILTER_BAR_ADV_FILTERS_DIALOG";if(this._isNewFilterBarDesign()){j="FILTER_BAR_ADAPT_FILTERS_DIALOG";}this._oFilterDialog.setTitle(this._oRb.getText(j));this._oFilterDialog.addStyleClass("sapMH4FontSize");this._oFilterDialog.addStyleClass("sapMH4Style");this._oFilterDialog.setVerticalScrolling(true);var n=new B();this._oFiltersSearchField=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});n.addContentMiddle(this._oFiltersSearchField);this._oFilterDialog.setSubHeader(n);var g1=this._createFiltersAndAdaptBasicArea();if(!g1){v.error("Content for Advanced Filters Dialog could not be created");return;}this._oFilterDialog.addContent(g1);this._oFiltersSearchField.attachLiveChange(function(h1){if(this._oFilterDialog){this.fireFiltersDialogSearchForFilters(h1.getParameters());this._triggerSearchInFilterDialog(h1);}}.bind(this));this._bOKFiltersDialogTriggered=false;this._bVariantSaveFiltersDialogTriggered=false;this._oFilterDialog.bDoNotAddToBasicArea=true;this._oFilterDialog.attachBeforeOpen(function(){this.fireFiltersDialogBeforeOpen();}.bind(this));this._oFilterDialog.attachBeforeClose(function(){if(!i._bOKFiltersDialogTriggered){i._cancelFilterDialog(i._bVariantSaveFiltersDialogTriggered);}delete i._oFilterDialog.bDoNotAddToBasicArea;i._closeDialogAndRestoreFilterBar(g1);});this._oFilterDialog.attachAfterClose(function(){i._oBasicAreaLayout.rerender();i._oInitialVariant=null;i._oFilterDialog.destroy();i._oFilterDialog=null;i._showHintText();var h1={};h1.context=i._bOKFiltersDialogTriggered?"SEARCH":"CANCEL";i.fireFiltersDialogClosed(h1);});this._oFilterDialog.setInitialFocus(this._oFiltersSearchField);this._addFilterDialogButtons(g1);this._bDirtyViaDialog=false;this._oFilterDialog.open();};function d1(i,j,n,g1,h1,i1,j1){N=i;O=j;R=n;W=g1;X=h1;Y=i1;Z=j1;this._bDialogRequested=false;if(!this._bIsBeingDestroyed){this._showFilterDialog();}}a1.prototype.isDialogOpen=function(){return this._oFilterDialog?true:false;};a1.prototype._addFilterDialogButtons=function(i){var j=this;var n;var g1=null,h1,i1,j1,k1;j1=new a(this.getId()+"-btnGoFilterDialog",{text:this._oRb.getText("FILTER_BAR_GO"),press:function(){j1.focus();j._dialogSearch(i);},layoutData:new O({priority:$.NeverOverflow}),type:E.Emphasized});this._oFilterDialog.addButton(j1);if(!this.getAdvancedMode()){if(this._oVariantManagement&&this._oVariantManagement.getVisible()){this._oVariantManagement._delayedControlCreation();if(this._oVariantManagement.oVariantSave){g1=new a(this.getId()+"-btnSaveFilterDialog",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVE"),enabled:this._oVariantManagement.oVariantSave.getEnabled(),press:function(){j._dialogVariantSave(i);},layoutData:new O({priority:$.Low})});n=this._oVariantManagement.getModel("save_enablement");g1.setModel(n);g1.bindProperty("enabled","/enabled");this._oFilterDialog.addButton(g1);}}h1=new a(this.getId()+"-btnClearFilterDialog",{text:this._oRb.getText("FILTER_BAR_CLEAR"),visible:this.getShowClearButton(),press:function(){j._dialogClear(i);},layoutData:new O({priority:$.Low})});this._oFilterDialog.addButton(h1);i1=new a(this.getId()+"-btnRestoreFilterDialog",{text:this._oRb.getText("FILTER_BAR_RESTORE"),visible:this.getShowRestoreButton(),press:function(){j._dialogRestore(i);},layoutData:new O({priority:$.Low})});if(n){i1.setEnabled(this._oVariantManagement.oVariantSave.getEnabled());i1.setModel(n);i1.bindProperty("enabled","/enabled");}this._oFilterDialog.addButton(i1);k1=new a(this.getId()+"-btnCancelFilterDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){j._dialogCancel(i);},layoutData:new O({priority:$.High})});this._oFilterDialog.addButton(k1);}};a1.prototype._dialogSearch=function(i){this.fireFiltersDialogSearch();this._searchRequested();};a1.prototype._dialogCancel=function(i){if(this._oFilterDialog){this._bOKFiltersDialogTriggered=false;this.fireFiltersDialogCancel();this._oFilterDialog.close();}};a1.prototype._dialogVariantSave=function(i){this._bVariantSaveFiltersDialogTriggered=true;this._variantSavePressed();};a1.prototype._dialogRestore=function(i){this.reset();if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(false);}};a1.prototype._dialogClear=function(i){this.clear();};a1.prototype._createButtons=function(i){var j=this;this._oHideShowButton=new a(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),tooltip:this._oRb.getText("FILTER_BAR_HIDE"),type:E.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){j._toggleHideShow();});i.addContent(this._oHideShowButton);this._oClearButtonOnFB=new a(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),tooltip:this._oRb.getText("FILTER_BAR_CLEAR"),type:E.Transparent,enabled:false});this._oClearButtonOnFB.attachPress(function(){j.clear();});i.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new a(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),tooltip:this._oRb.getText("FILTER_BAR_RESTORE"),type:E.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}});i.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new a(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration()||this._isPhone(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),tooltip:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:E.Transparent,enabled:false});this._oFiltersButton.attachPress(function(){j._oFiltersButton.focus();j._showFilterDialog();});i.addContent(this._oFiltersButton);this._oSearchButton=new a(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),tooltip:this._oRb.getText("FILTER_BAR_GO"),type:E.Emphasized});this._oSearchButton.attachPress(function(){j._oSearchButton.focus();j.search();});i.addContent(this._oSearchButton);};a1.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}this._registerVariantManagement();return this._oVariantManagement;};a1.prototype._createToolbar=function(i){var j=new e(this.getId()+"-toolbar");if(!i){var n=this._createVariantLayout();j.addContent(n);}j.addContent(new f());this._createButtons(j);j.addStyleClass("sapUiCompFilterBarToolbar");j.setLayoutData(new r({span:"L12 M12 S12"}));return j;};a1.prototype._replaceVariantManagement=function(i){if(this._oVariantManagement){this._unregisterVariantManagement();if(this._oToolbar&&this._oToolbar.getContent(this._oVariantManagement)){this._oToolbar.removeContent(this._oVariantManagement);}this._oVariantManagement.destroy();}this._oVariantManagement=i;this._registerVariantManagement();this._adaptNewFilterBarDesign();};a1.prototype._createAdvancedAreaForm=function(){if((!R||!W||!X||!Y)&&!this._bAdvancedRequested){R=sap.ui.require("sap/ui/layout/form/Form");W=sap.ui.require("sap/ui/layout/form/FormContainer");X=sap.ui.require("sap/ui/layout/form/FormElement");Y=sap.ui.require("sap/ui/layout/form/ResponsiveGridLayout");if(!R||!W||!X||!Y){sap.ui.require(["sap/ui/layout/form/Form","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/layout/form/ResponsiveGridLayout"],e1.bind(this));this._bAdvancedRequested=true;}}if(!R||!W||!X||!Y){return;}var i=new Y(this.getId()+"-AdvancedFormLayout");i.addStyleClass("sapUiCompFilterBarPaddingForm");i.setColumnsL(3);i.setColumnsM(2);var j=new R(this.getId()+"-AdvancedForm",{editable:true});j.setLayout(i);if(!this.oInvisibleFormTitle){this.oInvisibleFormTitle=new I({text:this._oRb.getText("ADVANCED_SEARCH_TEXT")});this.addContent(this.oInvisibleFormTitle);}j.addAriaLabelledBy(this.oInvisibleFormTitle);this._oAdvancedPanel.addContent(j);return j;};function e1(i,j,n,g1){R=i;W=j;X=n;Y=g1;this._bAdvancedRequested=false;if(!this._bIsBeingDestroyed){this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._rerenderAA();}}a1.prototype._addControlToBasicAreaFormContainer=function(i){var j=i.getControl();if(!j){v.error("no Control obtained");return null;}var n=i.getLabelControl(this.getId());if(!n){v.error("no Label obtained");return null;}this._adaptGroupTitleForFilter(i);return this._addControlToBasicAreaContainer(i,j,n);};a1.prototype._addControlToBasicAreaContainer=function(i,j,n){var g1=new s();if(j.setWidth){j.setWidth("100%");}g1.setWidth("100%");if(n){if(!n.hasStyleClass("sapUiCompFilterLabel")){n.addStyleClass("sapUiCompFilterLabel");}g1.addContent(n);if(n.setLabelFor){if(i&&j){n.setLabelFor(j);if(j.setTooltip&&i.getControlTooltip()){j.setTooltip(i.getControlTooltip());}}}}g1.addContent(j);if(!this.getAdvancedMode()&&(!this._oFilterDialog||(!this._oFilterDialog.hasOwnProperty("bDoNotAddToBasicArea")))){if(i&&i.getVisible()&&i.getVisibleInFilterBar()){if(this._isNewFilterBarDesign()){var h1=this._oBasicAreaLayout.getContent();if(this._isPhone()){this._oBasicAreaLayout.addContent(g1);}else{this._oBasicAreaLayout.insertContent(g1,h1.length);}}else{this._oBasicAreaLayout.addContent(g1);}}}return g1;};a1.prototype._rerenderAA=function(){if(this._oAdvancedAreaForm){this._oAdvancedAreaForm.removeAllFormContainers();var i=this._flattenMap();this._layOutAA(i);}};a1.prototype._groupsWithVisibleFilters=function(){var n,j,g1=this._mAdvancedAreaFilter;if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){g1={};for(var h1 in this._mAdvancedAreaFilter){if(h1&&this._mAdvancedAreaFilter[h1]&&this._mAdvancedAreaFilter[h1].items){n=this._mAdvancedAreaFilter[h1].items.length;for(var i=0;i<this._mAdvancedAreaFilter[h1].items.length;i++){j=this._mAdvancedAreaFilter[h1].items[i].filterItem;if(j&&(j.getHiddenFilter()||!j.getVisible())){n--;}}if(n){g1[h1]={};}}}}return g1;};a1.prototype._layOutAA=function(i){var j=this._groupsWithVisibleFilters();if(j&&Object.keys(j).length>1){this._layOutAAMultipleGroup(i);}else{this._layOutAASingleGroup(i);}};a1.prototype._layOutAAMultipleGroup=function(n){var i,j,g1=0,h1=null,i1=false;for(i=0;i<n.length;i++){if(n[i].control===null){g1++;}}if(this._mAdvancedAreaFilter&&(Object.keys(this._mAdvancedAreaFilter).length===2)&&this._mAdvancedAreaFilter[a1.INTERNAL_GROUP]&&this._mAdvancedAreaFilter[a1.INTERNAL_GROUP].items&&(this._mAdvancedAreaFilter[a1.INTERNAL_GROUP].items.length>0)){i1=true;}var j1=this._oAdvancedAreaForm.getLayout();if(j1){if(g1>=3){j1.setLabelSpanL(5);j1.setLabelSpanM(5);j1.setColumnsL(3);j1.setColumnsM(2);}else if(g1===2){j1.setLabelSpanL(4);j1.setLabelSpanM(5);j1.setColumnsL(2);j1.setColumnsM(2);}else if(g1===1){j1.setLabelSpanL(4);j1.setLabelSpanM(5);j1.setColumnsL(2);j1.setColumnsM(2);}}for(i=0;i<n.length;i++){if(n[i].control===null){h1=new W();if((Object.keys(this._mAdvancedAreaFilter).length>1)&&!i1){if((g1>=3)&&(n[i].filterItem.getGroupName()===a1.INTERNAL_GROUP)){h1.setTitle(this._oRb.getText("FILTER_BAR_BASIC_GROUP"));}else{h1.setTitle(n[i].filterItem.getGroupTitle());}}this._oAdvancedAreaForm.addFormContainer(h1);j=i+1;while(j<n.length&&(n[j].control)){this._addControlToAdvancedArea(n[j].filterItem,n[j].control,h1);j++;}i=j-1;}}if(g1===1){this._oAdvancedAreaForm.addFormContainer(new W());}};a1.prototype._layOutAASingleGroup=function(j){var i,n,g1,h1;var i1=j.length-1;var j1=i1>2?2:1;if(j1>1){g1=Math.floor(i1/j1);h1=((g1*j1)<i1);for(i=1;i<j1;i++){n=i*g1;if(h1){++n;}if((n+i)<j.length){j.splice(n+i,0,j[0]);}}}this._layOutAAMultipleGroup(j);};a1.prototype._flattenMap=function(){var n=null,i,j=[],g1;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){g1=false;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var h1=this._mAdvancedAreaFilter[n].items[i];if(h1.filterItem&&h1.filterItem.getVisibleInFilterBar()&&h1.filterItem.getVisible()&&!h1.filterItem.getHiddenFilter()){if(!g1){g1=true;j.push({control:null,filterItem:this._mAdvancedAreaFilter[n].filterItem});}j.push({control:h1.control,filterItem:h1.filterItem});}}}}}return j;};a1.prototype._triggerSearchByValue=function(j){var i,n,g1,h1;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._aListItems){for(i=this._aListItems.length-1;i>=0;i--){h1=this._aListItems[i].getContent();if(h1&&(h1.length>0)){n=h1[0].getText();g1=this._aListItems[i].data("quickinfo");if((n.toLowerCase().indexOf(j)>=0||(g1&&g1.toLowerCase().indexOf(j)>=0))){this._aListItems[i].setVisible(true);}else{this._aListItems[i].setVisible(false);}}}}};a1.prototype._triggerSearch=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._triggerSearchByValue(n);};a1.prototype._triggerSearchByValueInFilterDialog=function(j){var n=null,i,g1,h1,i1,j1,k1,l1;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){i1=this._mAdvancedAreaFilter[n];if(i1&&i1.items){k1=0;l1=0;for(i=0;i<i1.items.length;i++){if(i1.items[i]&&i1.items[i].filterItem){j1=i1.items[i].filterItem;if(j1.getHiddenFilter()){++k1;continue;}if(j1.getVisible()){if(j&&i1.items[i].formelement){g1=j1.getLabel();h1=j1.getControlTooltip();if((g1.toLowerCase().indexOf(j)>=0)||(h1&&(h1.toLowerCase().indexOf(j)>=0))){if(j1.getPartOfCurrentVariant()){i1.items[i].formelement.setVisible(true);}else{++l1;}}else{++k1;i1.items[i].formelement.setVisible(false);}}else if(i1.items[i].formelement){i1.items[i].formelement.setVisible(j1.getVisibleInFilterBar()||j1.getPartOfCurrentVariant());if(i1.link&&!i1.link.getVisible()){i1.link.setVisible(true);}}}else{++k1;}}}if(i1&&i1.formcontainer){if(k1===i1.items.length){i1.formcontainer.setVisible(false);}else{i1.formcontainer.setVisible(true);if(i1.link){i1.link.setVisible((j&&(l1===0))?false:true);if(j&&(l1>0)){this._setLinkTextAndCount(n,i1.link,l1);}else{this._setLinkText(n,i1.link);}}}}}}}}};a1.prototype._triggerSearchInFilterDialog=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._sSearchCriteriaInFiltersDialog=n;this._triggerSearchByValueInFilterDialog(n);};a1.prototype._generateListItems=function(j,n){if(!Q){Q=sap.ui.require("sap/m/CustomListItem");if(!Q){throw new Error("_generateListItems must only be called via _createAddRemoveFiltersDialog "+this);}}var i;var g1,h1;var i1;var j1=false;if(this.$().closest(".sapUiSizeCompact").length>0){j1=true;}if(j&&this._mAdvancedAreaFilter){h1=this._mAdvancedAreaFilter[j];if(h1&&h1.items){for(i=0;i<h1.items.length;i++){var k1=h1.items[i],l1=t.replace(j+"-"+k1.filterItem.getName()+"-selectFiltersItem");if(k1&&k1.filterItem){if(!k1.filterItem.getVisible()||k1.filterItem.getHiddenFilter()){continue;}g1=new Q(l1);g1.setVisible(true);if(!j1){g1.addStyleClass("sapUiCompFilterBarListItem");}else{g1.addStyleClass("sapUiCompFilterBarListItemCompact");}g1.data("quickinfo",k1.filterItem.getControlTooltip()||k1.filterItem.getLabelTooltip());k1.initialPartOfCurrentVariant=k1.filterItem.getPartOfCurrentVariant();k1.initialVisibleInFilterBar=k1.filterItem.getVisibleInFilterBar();g1.data('item',k1);i1=new L({id:l1+"-label",text:k1.filterItem.getLabel(),tooltip:k1.filterItem.getControlTooltip()||k1.filterItem.getLabelTooltip()});g1.addContent(i1);n.addItem(g1);if(k1.filterItem.getPartOfCurrentVariant()){n.setSelectedItem(g1);}if(k1.filterItem.getMandatory()&&k1.checkbox&&!k1.checkbox.getEnabled()){g1.getModeControl().setEnabled(false);}}}}}var m1=this;n.attachSelectionChange(function(n1){if(n1){var o1=n1.getParameter("listItems");if(Array.isArray(o1)){o1.forEach(function(g1){var p1=g1.getModeControl();var k1=g1.data('item');m1._selectionChangedInAddFiltersDialog(p1,k1);});}}});};a1.prototype._rerenderItem=function(i){var j;if(i){j=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar();if(i.container){i.container.setVisible(j);if(!j){this._removeContainer(i);}if(j){this._addContainer(i);}}if(i.formelement){i.formelement.setVisible(i.filterItem.getVisible()&&(i.filterItem.getVisibleInFilterBar()||i.filterItem.getPartOfCurrentVariant()));if(i.checkbox){i.checkbox.setSelected(i.filterItem.getVisibleInFilterBar());}}}};a1.prototype._rerenderFilters=function(){var i;var n=null;var j=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];this._rerenderItem(j);}}}}this._updateToolbarText();};a1.prototype.rerenderFilters=function(){this._rerenderFilters();};a1.prototype._closeAddRemoveFiltersDialog=function(i,j){if(i&&j){if(this._sSearchCriteriaInFiltersDialog&&this._oFilterDialog){this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}else{this._setLinkText(i,j);}}};a1.prototype._cancelAddRemoveFiltersDialog=function(j){var i;var n;if(j&&this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if((n.initialPartOfCurrentVariant!==undefined||n.initialVisibleInFilterBar!==undefined)&&n.filterItem){if(n.filterItem.getHiddenFilter()){continue;}if((n.initialPartOfCurrentVariant!==undefined)&&(n.filterItem.getPartOfCurrentVariant()!==n.initialPartOfCurrentVariant)){n.filterItem.setPartOfCurrentVariant(n.initialPartOfCurrentVariant);this._notifyAboutChangedFilters(n.initialPartOfCurrentVariant,n.control);}if((n.initialVisibleInFilterBar!==undefined)&&(n.filterItem.getVisibleInFilterBar()!==n.initialVisibleInFilterBar)){n.filterItem.setVisibleInFilterBar(n.initialVisibleInFilterBar);}}}}if(this._oVariantManagement&&(this._oVariant.modified2!==undefined)){this._oVariantManagement.currentVariantSetModified(this._oVariant.modified2);}};a1.prototype._createAddRemoveFiltersDialog=function(j,n){var i,g1=this;if(!j){return;}if((!N||!Q)&&!this._bCustomListItemRequested){Q=sap.ui.require("sap/m/CustomListItem");N=sap.ui.require("sap/m/Dialog");if(!N||!Q){sap.ui.require(["sap/m/Dialog","sap/m/CustomListItem"],f1.bind(this));this._bCustomListItemRequested=true;this._oFiltersDialogData={groupName:j,link:n};}}if(!N||!Q){return;}this._oDialog=new N(this.getId()+"-set-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true});this._oDialog.addStyleClass("sapUiPopupWithPadding");this._oDialog.addStyleClass("sapUiCompAddRemoveFilterDialog");if(this.$().closest(".sapUiSizeCompact").length>0){this._oDialog.addStyleClass("sapUiSizeCompact");}this._oDialog.setTitle(this._oRb.getText("SELECT_FILTER_FIELDS"));this._oDialog.addStyleClass("sapMH4FontSize");this._oDialog.addStyleClass("sapMH4Style");this._oDialog.setVerticalScrolling(true);var h1=new B();var i1=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=i1;i1.attachLiveChange(function(m1){g1._triggerSearch(m1);});h1.addContentMiddle(i1);this._oDialog.setSubHeader(h1);var j1=new d({mode:_.MultiSelect});j1.setShowSeparators(z.None);this._oDialog.addContent(j1);this._generateListItems(j,j1);this._aListItems=j1.getItems();for(i=0;i<this._aListItems.length;i++){j1.addItem(this._aListItems[i]);}if(this._oVariant&&this._oVariantManagement){this._oVariant.modified2=this._oVariantManagement.currentVariantGetModified();}this._bOKButtonAddRemoveFilterDialogTriggered=false;var k1=new a(this.getId()+"-btnOKAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_OK"),type:sap.m.ButtonType.Emphasized});k1.attachPress(function(){g1._bOKButtonAddRemoveFilterDialogTriggered=true;g1._oDialog.close();});this._oDialog.addAggregation("buttons",k1);this._oDialog.setInitialFocus(this._oSearchField);if(this._sSearchCriteriaInFiltersDialog){this._oSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValue(this._sSearchCriteriaInFiltersDialog);}var l1=new a(this.getId()+"-btnCancelAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){g1._oDialog.close();}});this._oDialog.addAggregation("buttons",l1);this._oDialog.attachBeforeClose(function(){if(!g1._bOKButtonAddRemoveFilterDialogTriggered){g1._cancelAddRemoveFiltersDialog(j);}g1.rerenderFilters();g1._closeAddRemoveFiltersDialog(j,n);if(g1._oFilterDialog){g1._oFilterDialog.invalidate();}});this._oDialog.attachAfterClose(function(){this._aListItems=null;g1._oDialog.destroy();g1._oDialog=null;n.getDomRef().scrollIntoView();});this._oDialog.open();};function f1(i,j){N=i;Q=j;this._bCustomListItemRequested=false;if(!this._bIsBeingDestroyed){this._createAddRemoveFiltersDialog(this._oFiltersDialogData.groupName,this._oFiltersDialogData.link);delete this._oFiltersDialogData;}}a1.prototype._selectionChangedInAddFiltersDialog=function(i,j){var n=i.getSelected();if(!n&&j.filterItem.getMandatory()&&!j.checkbox.getEnabled()){i.setSelected(true);return;}j.filterItem.setPartOfCurrentVariant(n);j.filterItem.setVisibleInFilterBar(n);this._notifyAboutChangedFilters(n,j.control);};a1.prototype._setTriggerFilterChangeState=function(i){this._triggerFilterChangeState=i;};a1.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState;};a1.prototype._setConsiderFilterChanges=function(i){this._filterChangeSemaphore=i;};a1.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore;};a1.prototype.fireFilterChange=function(i){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return;}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}if(this._oFilterDialog&&!(this._oFilterDialog.isOpen())){return;}this._bDirtyViaDialog=true;this.fireEvent("filterChange",i);};a1.prototype._notifyAboutChangedFilters=function(i,j){var n,g1=this._determineByControl(j);if(i){n={"added":j,"filterItem":g1};}else{n={"deleted":j,"filterItem":g1};}this.fireFilterChange(n);};a1.prototype._determineVariantFiltersInfo=function(j,g1){var i;var n=null,h1,i1;var j1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){h1=this._mAdvancedAreaFilter[n].items[i];if(j||h1.filterItem.getVisible()){i1={group:h1.filterItem.getGroupName(),name:h1.filterItem.getName(),partOfCurrentVariant:h1.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:h1.filterItem.getVisibleInFilterBar(),visible:h1.filterItem.getVisible()};if(g1||this._considerFilter(i1)){j1.push(i1);}}}}}}}return j1;};a1.prototype.mergeVariant=function(i,j){var n={};w(n,j);n.filterbar=[];n.filterBarVariant={};w(n.filterbar,i.filterbar);w(n.filterBarVariant,i.filterBarVariant);if(j&&(j.hasOwnProperty("version"))){n.filterbar=this._mergeVariantFields(n.filterbar,j.filterbar);n.filterBarVariant=j.filterBarVariant;}return n;};a1.prototype._mergeVariantFields=function(j,n){var i;n.forEach(function(g1){for(i=0;i<j.length;i++){if((j[i].group===g1.group)&&(j[i].name===g1.name)){j.splice(i,1);break;}}});return j.concat(n);};a1.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof k){return true;}return false;};a1.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false;}return this.getDeltaVariantMode();};a1.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this);};a1.prototype._considerFilter=function(j){if(!this._isDeltaHandling()){return true;}var n=null;var g1=this._getStandardVariant();if(g1&&g1.filterbar){for(var i=0;i<g1.filterbar.length;i++){if((g1.filterbar[i].group===j.group)&&(g1.filterbar[i].name===j.name)){n=g1.filterbar[i];break;}}}if(!n){if(!j.partOfCurrentVariant){return false;}return true;}if((n.partOfCurrentVariant!==j.partOfCurrentVariant)||(n.visibleInFilterBar!==j.visibleInFilterBar)||(n.visible!==j.visible)){return true;}return false;};a1.prototype._addControlToAdvancedArea=function(i,j,n){var g1=new X({label:i.getLabelControl(this.getId()),fields:[(j!==null)?j:new T()]});n.addFormElement(g1);};a1.prototype._determineVisibility=function(i){var j=false;if(i){j=i.getVisible()&&(i.getVisibleInFilterBar()||i.getPartOfCurrentVariant());j=j&&!i.getHiddenFilter();}return j;};a1.prototype._retrieveVisibleAdvancedItems=function(){var i,n=null,j;var g1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j){if(this._determineVisibility(j.filterItem)){g1.push(j);}}}}}}}return g1;};a1.prototype._retrieveCurrentSelectionSet=function(j,n){var i,g1,h1,i1=[];var j1=this._retrieveVisibleAdvancedItems();for(i=0;i<j1.length;i++){g1=j1[i];if(g1.control&&g1.filterItem&&(n||!g1.filterItem._isParameter())){if(j){h1={name:j1[i].filterItem.getName(),control:j1[i].control};}else{h1=j1[i].control;}i1.push(h1);}}return i1;};a1.prototype.search=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireSearch(i);return true;};a1.prototype.clear=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(i.selectionSet);this._clearErrorState();this.fireClear(i);this._updateToolbarText();};a1.prototype._deleteValidatingTokenFlag=function(i){i.forEach(function(j){if(j.hasOwnProperty("__bValidatingToken")){delete j.__bValidatingToken;}});};a1.prototype.reset=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireReset(i);this._resetVariant();};a1.prototype._resetVariant=function(){var i=null,j=null;this._resetFiltersInErrorValueState();var n=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(n);if(this._oVariantManagement){var g1=this._oVariantManagement.getSelectionKey();if(g1){i=this._oVariantManagement.getVariantContent(this,g1);if(this._oVariant){this._oVariant.content=i;this._oVariant.modified=false;if(this.getPersistencyKey()&&this._oInitialVariant){this._oInitialVariant.content=i;this._oInitialVariant.modified=false;this._oInitialVariant.key=g1;}}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===undefined)&&this._oInitialVariant&&this._oInitialVariant.content){j=this._oInitialVariant.content;}if(i||j){this.applyVariant(i||j,"RESET");}}}this._resetFilterBarSearch();};a1.prototype._resetFilterBarSearch=function(){this._sSearchCriteriaInFiltersDialog="";if(this._oFiltersSearchField){this._oFiltersSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}};a1.prototype._applyVariant=function(i,j,n,g1){var h1,i1=null,j1,k1=false;if(i){if(n){j1=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false);}this._setConsiderFilterChanges(false);h1=i.filterBarVariant;i1=i.filterbar;this._ensureFilterLoaded(i1);this._applyVariantFields(h1,g1);this._reapplyVisibility(i1);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||i.basicSearch);}if(i.executeOnSelection){k1=i.executeOnSelection;}this.fireAfterVariantLoad(j,k1);this._setConsiderFilterChanges(true);this._updateToolbarText();if(k1||(this.getLiveMode&&this.getLiveMode())){this.search();}else{this._clearErrorState();}if(n){this._setTriggerFilterChangeState(j1);}}};a1.prototype._fetchVariantFiltersData=function(i){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData(i);}catch(j){v.error("callback for fetching data throws an exception");}}else{v.warning("no callback for fetch data supplied");}return null;};a1.prototype._applyVariantFields=function(j,i){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(j,i);}catch(n){v.error("callback for applying data throws an exception");}}else{v.warning("no callback for appy data supplied");}};a1.prototype._isStandardVariant=function(){var i=this.getCurrentVariantId();if(!i){return true;}if(this._oVariantManagement){if((i===this._oVariantManagement.getStandardVariantKey())){return true;}if(this._oVariantManagement._oStandardVariant===null){return true;}}return false;};a1.prototype.isCurrentVariantExecuteOnSelectEnabled=function(){if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){var i=this.getCurrentVariantId();if(!i){return this._oVariantManagement.getExecuteOnSelectForStandardVariant();}var j=this._oVariantManagement.getItemByKey(i);if(j){return j.getExecuteOnSelection();}}return false;};a1.prototype.fetchVariant=function(){var i,j={},n;if(this._isDeltaHandling()){if(!this._isStandardVariant()){j.version="V3";}}this.fireBeforeVariantFetch();i=this._determineVariantFiltersInfo(true,!j.version);j.filterbar=(!i)?[]:i;j.filterBarVariant=this._fetchVariantFiltersData(j.version);n=this._getBasicSearchValue();if(n){j.basicSearch=n;}if(this._oVariant&&this._oVariant.content){this._oVariant.content=j;}return j;};a1.prototype.applyVariant=function(i,j,n){if(i.hasOwnProperty("version")){i=this.mergeVariant(this._getStandardVariant(),i,j);}this._applyVariant(i,j,n,i.version);};a1.prototype._afterVariantsLoad=function(){if(this._bDelayRendering){this._oBasicAreaLayout.setVisible(this.getFilterBarExpanded());}this._bDelayRendering=false;};a1.prototype.determineMandatoryFilterItems=function(){var i;var j=[];var n=this._retrieveVisibleAdvancedItems();for(i=0;i<n.length;i++){if(n[i].filterItem.getMandatory()===true){if(n[i].control){j.push(n[i].filterItem);}}}return j;};a1.prototype.determineControlByFilterItem=function(j,g1){var i,n=null;var h1,i1;if(!j||(!g1&&j._isParameter())){return null;}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){h1=this._aBasicAreaSelection[i];if(j===h1.filterItem){return h1.control;}}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){i1=this._mAdvancedAreaFilter[n];if(i1&&i1.items){for(i=0;i<i1.items.length;i++){h1=i1.items[i];if((g1||!h1.filterItem._isParameter())&&(j===h1.filterItem)){return h1.control;}}}}}}return null;};a1.prototype.determineControlByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem&&!j.filterItem._isParameter()){return j.control;}return null;};a1.prototype.determineLabelByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem){return j.filterItem._oLabel;}return null;};a1.prototype._determineEnsuredItemByName=function(n,i){if(!i){i=this._determineGroupNameByName(n);}this._ensureFilterLoaded([{name:n,group:i}]);return this._determineItemByName(n,i);};a1.prototype._determineGroupNameByName=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i].groupName;}}}var j=this._determineFilterItemByName(n);if(j){var g1=j.getGroupName();if(g1!==a1.INTERNAL_GROUP){return g1;}}return null;};a1.prototype._determineItemByName=function(n,j){var i;var g1,h1;var i1=j;if(!n){return null;}if(!i1){i1=a1.INTERNAL_GROUP;}if(this._mAdvancedAreaFilter){h1=this._mAdvancedAreaFilter[i1];if(h1&&h1.items){for(i=0;i<h1.items.length;i++){g1=h1.items[i];if(g1&&g1.filterItem&&(g1.filterItem.getName()===n)){return g1;}}}}return null;};a1.prototype.determineFilterItemByName=function(n){var i=this._determineEnsuredItemByName(n);if(i&&i.filterItem){return i.filterItem;}return null;};a1.prototype._determineFilterItemByName=function(i){var n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){j=this._determineItemByName(i,n);if(j){return j.filterItem;}}}return null;};a1.prototype._determineByControl=function(j){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var g1=this._mAdvancedAreaFilter[n];if(g1&&g1.items){for(i=0;i<g1.items.length;i++){if(g1.items[i]&&g1.items[i].control===j){return g1.items[i];}}}}}}return null;};a1.prototype._deleteProperties=function(){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var j=this._mAdvancedAreaFilter[n];if(j&&j.items){if(j.formcontainer){j.formcontainer.destroy();delete j.formcontainer;}if(j.link){delete j.link;}for(i=0;i<j.items.length;i++){if(j.items[i]&&j.items[i].checkbox){delete j.items[i].checkbox;}if(j.items[i]&&j.items[i].formelement){delete j.items[i].formelement;}}}}}}};a1.prototype.onAfterRendering=function(i){if(!(this._isPhone()||this._isTablet())){if(this._oHintText&&this._oHintText.getVisible()){this.setFilterBarExpanded(false);}}};a1.prototype._destroyLazyFilterControl=function(){var j,i;if(this._aFields&&(this._aFields.length>0)){if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){i=this._aFields[j];if(i.factory){if(i.control){i.control.destroy();}}}}}};a1.prototype._destroyNonVisibleFilterControl=function(){var i,n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.container){if(this._oBasicAreaLayout&&(this._oBasicAreaLayout.indexOfContent(j.container)<0)){if(j.control&&!j.bDestroyed){j.control.destroy();j.bDestroyed=true;}}}}}}}};a1.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl();}};a1.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this);}};a1.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null;}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if((!this.getUseToolbar()||this.getAdvancedMode())&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy();}}};a1.prototype.exit=function(){this._unregisterVariantManagement();this._destroyFilterControls();if(this._oHintText&&(this._oAdvancedPanel.indexOfContent(this._oHintText)<0)){this._oHintText.destroy();}G.prototype.exit.apply(this,arguments);if(this._oDialog){this._oDialog.destroy();this._oDialog=null;}if(this._oFilterDialog){this._oFilterDialog.destroy();this._oFilterDialog=null;}if(this.oModel){this.oModel.destroy();this.oModel=null;}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oBasicSearchField=null;this._oBasicSearchFieldContainer=null;this._oButtonsVLayout=null;};return a1;});
