//@ui5-bundle sap/ui/fl/library-preload.js
/*
 * ! OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine('sap/ui/fl/ControlPersonalizationAPI',["sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/registry/ChangeRegistry","sap/ui/fl/FlexControllerFactory","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Element","sap/ui/base/ManagedObject","sap/base/util/includes","sap/ui/fl/variants/VariantManagement","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/core/Component","sap/base/Log","sap/base/util/merge","sap/ui/thirdparty/jquery"],function(U,L,C,F,J,E,M,i,V,a,b,c,m,q){"use strict";var d={_determineParameters:function(o,I){var A=U.getAppComponentForControl(o);var f=F.createForControl(A);var r=A.getRootControl();var p={rootControl:r,flexController:f};if(!I){var v;var e;p.variantModel=A.getModel(U.VARIANT_MODEL_NAME);p.variantManagement={};q.makeArray(p.rootControl.$().find(".sapUiFlVarMngmt")).map(function(g){v=sap.ui.getCore().byId(g.id);if(v.getMetadata().getName()==="sap.ui.fl.variants.VariantManagement"){e=v.getFor();e.forEach(function(s){p.variantManagement[s]=p.variantModel.getLocalId(g.id,A);});}});}return p;},_getVariantManagement:function(o,p){p=p||this._determineParameters(o);var f=function(o){if(!p.variantManagement[o.getId()]&&o.getParent()&&o.getId()!==p.rootControl.getId()){return f(o.getParent());}else if(!o.getParent()||o.getId()===p.rootControl.getId()){return p.variantManagement[o.getId()]||"";}return p.variantManagement[o.getId()];};return f(o);},clearVariantParameterInURL:function(o){var u;var A=U.getAppComponentForControl(o);var v=A instanceof b?A.getModel(U.VARIANT_MODEL_NAME):undefined;if(!v){c.warning("Variant model could not be found on the provided control");}if(o instanceof V){var s=v.getLocalId(o.getId(),A);var e=a.removeURLParameterForVariantManagement({model:v,vmReference:s});u=e.parameters;}a.update({parameters:u||[],updateURL:true,updateHashEntry:!!v,model:v||{},silent:!v});},activateVariant:function(e,v){var o;return Promise.resolve().then(function(){if(typeof e==='string'||e instanceof String){o=b.get(e);if(!(o instanceof b)){o=sap.ui.getCore().byId(e);if(!(o instanceof E)){throw new Error("No valid component or control found for the provided ID");}}}else if(e instanceof b||e instanceof E){o=e;}var A=U.getAppComponentForControl(o);if(!A){throw new Error("A valid variant management control or component (instance or ID) should be passed as parameter");}var f=A.getModel(U.VARIANT_MODEL_NAME);if(!f){throw new Error("No variant management model found for the passed control or application component");}var s=f.getVariantManagementReference(v).variantManagementReference;if(!s){throw new Error("A valid control or component, and a valid variant/ID combination are required");}return f.updateCurrentVariant(s,v,A);})["catch"](function(f){c.error(f);return Promise.reject(f);});},_checkChangeSpecificData:function(o,l){if(!o.changeSpecificData){return Promise.reject(new Error("No changeSpecificData available"));}if(!o.changeSpecificData.changeType){return Promise.reject(new Error("No valid changeType"));}if(!(o.selectorControl instanceof E)){return Promise.reject(new Error("No valid selectorControl"));}var s=o.selectorControl.getMetadata().getName();var e=C.getInstance();return e.getChangeHandler(o.changeSpecificData.changeType,s,o.selectorControl,J,l);},addPersonalizationChanges:function(p){var s=[];var l=L.getCurrentLayer(true);var P=[];p.controlChanges.forEach(function(o){var e={};Object.assign(e,{developerMode:false,layer:l});function f(){return this._checkChangeSpecificData(o,l).then(function(){var g=this._determineParameters(o.selectorControl,p.ignoreVariantManagement);if(!p.ignoreVariantManagement){if(!o.changeSpecificData.variantReference){var v=this._getVariantManagement(o.selectorControl,g);if(v){var h=g.variantModel.oData[v].currentVariant;o.changeSpecificData.variantReference=h;}}}else{delete o.changeSpecificData.variantReference;}return g.flexController.createAndApplyChange(Object.assign(e,o.changeSpecificData),o.selectorControl);}.bind(this)).then(function(A){s.push(A);}).catch(function(g){return Promise.reject({change:o,message:g.message});});}P.push(f.bind(this));}.bind(this));return U.execPromiseQueueSequentially(P).then(function(){return s;});},isPersonalized:function(e,f){if(!e||e.length===0){return this._reject("At least one control ID has to be provided as a parameter");}var A=e[0].appComponent||U.getAppComponentForControl(e[0]);if(!A){return this._reject("App Component could not be determined");}var I=e.map(function(g){return g.id||g.getId();});var o=F.createForControl(A);return o.getComponentChanges({currentLayer:"USER",includeCtrlVariants:true}).then(function(g){return g.filter(this._filterBySelectors.bind(this,A,I)).filter(this._filterByChangeType.bind(this,f)).some(this._ifValidFileType);}.bind(this));},_reject:function(s){c.error(s);return Promise.reject(s);},_filterBySelectors:function(A,I,o){var s=o.getSelector();var e=J.getControlIdBySelector(s,A);return i(I,e);},_filterByChangeType:function(e,o){return(Array.isArray(e)&&e.length>0)?i(e,o.getChangeType()):true;},_ifValidFileType:function(o){return o.getFileType()==="change";},resetChanges:function(e,f){if(!e||e.length===0){return this._reject("At least one control ID has to be provided as a parameter");}var A=e[0].appComponent||U.getAppComponentForControl(e[0]);if(!A){return this._reject("App Component could not be determined");}var s=e.map(function(v){var g=v.id||v.getId();var l=A.getLocalId(g);return l||g;});var o=F.createForControl(A);return o.resetChanges("USER",undefined,A,s,f);},saveChanges:function(e,o){if(!(o instanceof M)){var s="A valid sap.ui.base.ManagedObject instance is required as a parameter";c.error(s);return Promise.reject(s);}var p=d._determineParameters(o);var v=Object.keys(p.variantManagement).reduce(function(r,f){return r.concat([p.variantManagement[f]]);},[]);return p.flexController.saveSequenceOfDirtyChanges(e).then(function(r){p.variantModel.checkDirtyStateForControlModels(v);return r;});},hasVariantManagement:function(o){try{return!!this._getVariantManagement(o);}catch(e){c.error(e.message);return false;}}};return d;},true);
sap.ui.predefine('sap/ui/fl/FakeLrepConnectorLocalStorage',["sap/ui/fl/FakeLrepConnector","sap/ui/fl/apply/_internal/connectors/LocalStorageConnector","sap/ui/fl/write/_internal/connectors/LocalStorageConnector"],function(F,A,W){"use strict";return{enableFakeConnector:function(p){var j=p?p.sInitialComponentJsonPath:undefined;F.setFlexibilityServicesAndClearCache("LocalStorageConnector",j);},disableFakeConnector:function(){F.disableFakeConnector();},forTesting:{spyWrite:function(s,a){return F.forTesting.spyMethod(s,a,W,"write");},getNumberOfChanges:function(r){return F.forTesting.getNumberOfChanges(A,r);},synchronous:{clearAll:function(){F.forTesting.synchronous.clearAll(window.localStorage);},store:function(k,i){F.forTesting.synchronous.store(window.localStorage,k,i);}}}};},true);
sap.ui.predefine('sap/ui/fl/FakeLrepConnectorSessionStorage',["sap/ui/fl/FakeLrepConnector","sap/ui/fl/apply/_internal/connectors/SessionStorageConnector","sap/ui/fl/write/_internal/connectors/SessionStorageConnector"],function(F,A,W){"use strict";return{enableFakeConnector:function(p){var j=p?p.sInitialComponentJsonPath:undefined;F.setFlexibilityServicesAndClearCache("SessionStorageConnector",j);},disableFakeConnector:function(){F.disableFakeConnector();},forTesting:{spyWrite:function(s,a){return F.forTesting.spyMethod(s,a,W,"write");},getNumberOfChanges:function(r){return F.forTesting.getNumberOfChanges(A,r);},clear:function(p){return F.forTesting.clear(W,p);},setStorage:function(n){F.forTesting.setStorage(A,n);},synchronous:{clearAll:function(){F.forTesting.synchronous.clearAll(window.sessionStorage);},getNumberOfChanges:function(r){return F.forTesting.synchronous.getNumberOfChanges(A.oStorage,r);}}}};},true);
sap.ui.predefine('sap/ui/fl/FakeLrepLocalStorage',["sap/ui/fl/FakeLrepConnectorLocalStorage"],function(F){"use strict";return{deleteChanges:function(){return F.forTesting.synchronous.clearAll();}};},true);
sap.ui.predefine('sap/ui/fl/Layer',[],function(){"use strict";return{USER:"USER",CUSTOMER:"CUSTOMER",CUSTOMER_BASE:"CUSTOMER_BASE",PARTNER:"PARTNER",VENDOR:"VENDOR",BASE:"BASE"};});
sap.ui.predefine('sap/ui/fl/apply/_internal/ChangesController',["sap/ui/fl/FlexControllerFactory","sap/ui/fl/Utils"],function(O,F){"use strict";var C={getFlexControllerInstance:function(s,a){if(typeof s==="string"){return O.create(s,a);}var m=s.appComponent||s;return O.createForControl(m);},getDescriptorFlexControllerInstance:function(s){if(typeof s.appId==="string"){return O.create(s.appId,s.appVersion);}var a=s.appComponent||s;var A=F.getAppDescriptorComponentObjectForControl(a);return O.create(A.name,A.version);},getAppComponentForSelector:function(s){return s.appComponent||F.getAppComponentForControl(s);}};return C;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/Storage',["sap/ui/fl/apply/_internal/StorageUtils","sap/ui/fl/Utils","sap/ui/fl/apply/_internal/StorageResultMerger","sap/ui/fl/apply/_internal/storageResultDisassemble"],function(S,F,a,s){"use strict";
function _(C,o,D){if(o.layers&&(o.layers[0]==="ALL"||o.layers.indexOf(D)!==-1)){C.draftLayer=D;}else{delete C.draftLayer;}return C;}
function b(p,C){var g=C.map(function(o){var h=Object.assign({},p,{url:o.url,path:o.url});var D=p.draftLayer||F.getUrlParameter("sap-ui-fl-draft")||"";h=_(h,o,D);return o.applyConnectorModule.loadFlexData(h).then(function(r){return r||S.getEmptyFlexDataResponse();}).catch(S.logAndResolveDefault.bind(undefined,S.getEmptyFlexDataResponse(),o,"loadFlexData"));});return Promise.all(g);}
function c(r){var g=[];r.forEach(function(R){if(Array.isArray(R)){g=g.concat(R);}else{g.push(R);}});return g;}
function d(r){r.responses=c(r.responses);return r;}
function e(r){var D=r.map(function(R){return R.variantSection?s(R):R;});return{responses:D};}
var f={};
f.loadFlexData=function(p){if(!p||!p.reference){return Promise.reject("No reference was provided");}return S.getApplyConnectors().then(b.bind(this,p)).then(c).then(e).then(d).then(a.merge);};
return f;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/StorageResultMerger',["sap/base/util/merge"],function(m){"use strict";var s={};
function _(r,t){var f=r.reduce(function(f,R){if(R[t]){return f.concat(R[t]);}return f;},[]);var c=[];return f.filter(function(C){var F=C.fileName;var b=c.indexOf(F)!==-1;if(b){return false;}c.push(F);return true;});}
function a(r){return r.reduce(function(u,R){return m({},u,R.ui2personalization);},{});}
s.merge=function(p){return{appDescriptorChanges:_(p.responses,"appDescriptorChanges"),changes:_(p.responses,"changes"),ui2personalization:a(p.responses),variants:_(p.responses,"variants"),variantChanges:_(p.responses,"variantChanges"),variantDependentControlChanges:_(p.responses,"variantDependentControlChanges"),variantManagementChanges:_(p.responses,"variantManagementChanges")};};
return s;});
sap.ui.predefine('sap/ui/fl/apply/_internal/StorageUtils',["sap/base/security/encodeURLParameters","sap/base/Log","sap/ui/fl/Layer","sap/ui/fl/LayerUtils"],function(e,L,c,d){"use strict";var A="sap/ui/fl/apply/_internal/connectors/";var S={connector:"StaticFileConnector"};
function _(l,v){return l.filter(function(a){return v.indexOf(a)!==-1||v[0]==="ALL";});}
function s(r){function b(C,o){return new Date(C.creation)-new Date(o.creation);}["changes","variantChanges","variants","variantDependentControlChanges","variantManagementChanges"].forEach(function(a){r[a]=r[a].sort(b);});return r;}
return{getConnectors:function(n,l){var C=sap.ui.getCore().getConfiguration().getFlexibilityServices();var m=[];if(l){m=[S];}m=m.concat(C);return new Promise(function(r){var a=m.map(function(b){var f=b.connector;var g;if(!b.custom){g=n+f;}else{g=l?b.applyConnector:b.writeConnector;}return g;});sap.ui.require(a,function(){Array.from(arguments).forEach(function(o,i){if(!l){if(!m[i].layers){m[i].layers=o.layers;}else{m[i].layers=_(m[i].layers,o.layers);}}if(l){m[i].applyConnectorModule=o;}else{m[i].writeConnectorModule=o;}});r(m);});});},getApplyConnectors:function(){return this.getConnectors(A,true);},logAndResolveDefault:function(r,C,f,E){L.error("Connector ("+C.connector+") failed call '"+f+"': "+E);return r;},filterAndSortResponses:function(g){var r=[];Object.keys(g).forEach(function(l){r.push(g[l]);});r=r.filter(function(R){return R.changes.length>0||R.variants.length>0||R.variantChanges.length>0||R.variantManagementChanges.length>0||R.variantDependentControlChanges.length>0;});r.sort(function(a,b){return a.index-b.index;});return r;},getGroupedFlexObjects:function(f){var g={};Object.keys(c).forEach(function(l){g[l]=this.getEmptyFlexDataResponse();g[l].index=d.getLayerIndex(l);}.bind(this));f.forEach(function(F){var l=F.layer;if(F.fileType==="ctrl_variant"&&F.variantManagementReference){g[l].variants.push(F);}else if(F.fileType==="ctrl_variant_change"){g[l].variantChanges.push(F);}else if(F.fileType==="ctrl_variant_management_change"){g[l].variantManagementChanges.push(F);}else if(F.fileType==="change"||F.fileType==="variant"){if(F.variantReference){g[l].variantDependentControlChanges.push(F);}else{g[l].changes.push(F);}}});Object.keys(g).forEach(function(l){s(g[l]);});return g;},getEmptyFlexDataResponse:function(){return Object.assign({},{appDescriptorChanges:[],changes:[],variants:[],variantChanges:[],variantDependentControlChanges:[],variantManagementChanges:[],ui2personalization:{}});}};});
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/Applier',["sap/base/Log","sap/ui/core/Element","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/Utils"],function(L,E,J,F,U,D,a){"use strict";
function _(C,p){var s=C.getSelector&&C.getSelector();if(!s||!s.id){throw new Error("No selector in change found or no selector ID.");}var o=p.modifier.bySelector(s,p.appComponent,p.view);if(!o){throw new Error("A flexibility change tries to change a nonexistent control.");}var h=C.getDependentControlSelectorList();h.forEach(function(i){var j=p.modifier.bySelector(i,p.appComponent,p.view);if(!j){throw new Error("A dependent selector control of the flexibility change is not available.");}});return o;}
function b(C,o,m,h,p){var x=f(p);var i=U.getControlIfTemplateAffected(o,C,p);var I=F.hasChangeApplyFinishedCustomData(i.control,o,p.modifier);var j=o.isApplyProcessFinished();if(j&&!I){if(!x){var k=U.checkIfDependencyIsStillValid.bind(null,p.appComponent,p.modifier,m);m=h._oChangePersistence.copyDependenciesFromInitialChangesMap(o,k,p.appComponent);}o.setInitialApplyState();}else if(!j&&I){o.markFinished();}return m;}
function c(C,p){var s;if(f(p)&&C.getDefinition().jsOnly){s="Change cannot be applied in XML. Retrying in JS.";}if(s){C.setInitialApplyState();throw Error(s);}}
function d(C,m,i,p){if(i instanceof E){m.control=i;}if(m.control){p.modifier.updateAggregation(m.originalControl,C.getContent().boundAggregation);}F.addAppliedCustomData(m.control,C,p,f(p));var r={success:true};C.markFinished(r);return r;}
function e(o,C,m,p){var x=f(p);var r={success:false,error:o};var s=C.getId();var l="Change ''{0}'' could not be applied.";var h=o instanceof Error;var i=F.getCustomDataIdentifier(false,h,x);switch(i){case F.notApplicableChangesCustomDataKey:a.formatAndLogMessage("info",[l,o.message],[s]);break;case F.failedChangesCustomDataKeyXml:a.formatAndLogMessage("warning",[l,"Merge error detected while processing the XML tree."],[s],o.stack);break;case F.failedChangesCustomDataKeyJs:a.formatAndLogMessage("error",[l,"Merge error detected while processing the JS control tree."],[s],o.stack);break;}F.addFailedCustomData(m.control,C,p,i);if(x){C.setInitialApplyState();}else{C.markFinished(r);}return r;}
function f(p){return p.modifier.targets==="xmlTree";}
function g(o,C){var h=C.getDefinition();var s=h.changeType;var t=h.selector.id;var i=h.namespace+h.fileName+"."+h.fileType;var w="A flexibility change could not be applied.";w+="\nThe displayed UI might not be displayed as intedend.";if(o.message){w+="\n   occurred error message: '"+o.message+"'";}w+="\n   type of change: '"+s+"'";w+="\n   LRep location of the change: "+i;w+="\n   id of targeted control: '"+t+"'.";L.warning(w,undefined,"sap.ui.fl.apply._internal.changes.Applier");}
var A={applyChangeOnControl:function(C,o,p){var m=U.getControlIfTemplateAffected(C,o,p);return U.getChangeHandler(C,m,p).then(function(h){c(C,p);return h;}).then(function(h){if(C.hasApplyProcessStarted()){return C.addPromiseForApplyProcessing().then(function(r){C.markFinished();return r;});}else if(!C.isApplyProcessFinished()){return new a.FakePromise().then(function(){C.startApplying();return h.applyChange(C,m.control,p);}).then(function(i){return d(C,m,i,p);}).catch(function(i){return e(i,C,m,p);});}var r={success:true};C.markFinished(r);return r;}).catch(function(h){return{success:false,error:h};});},applyAllChangesForControl:function(G,o,h,C){var p=[];var s=C.getId();var m=G();var i=m.mChanges;var j=i[s]||[];var P={modifier:J,appComponent:o,view:a.getViewForControl(C)};j.forEach(function(k){m=b(C,k,m,h,P);k.setQueuedForApply();if(!m.mDependencies[k.getId()]){p.push(function(){return A.applyChangeOnControl(k,C,P).then(function(){D.removeChangeFromDependencies(m,k.getId());});});}else{var l=A.applyChangeOnControl.bind(A,k,C,P);D.addChangeApplyCallbackToDependency(m,k.getId(),l);}});if(j.length||m.mControlsWithDependencies[s]){delete m.mControlsWithDependencies[s];return a.execPromiseQueueSequentially(p).then(function(){return D.processDependentQueue(m,o);});}return new a.FakePromise();},applyAllChangesForXMLView:function(p,C){var P=[];if(!Array.isArray(C)){var s="No list of changes was passed for processing the flexibility on view: "+p.view+".";L.error(s,undefined,"sap.ui.fl.apply._internal.changes.Applier");C=[];}C.forEach(function(o){try{var h=_(o,p);o.setQueuedForApply();P.push(function(){b(h,o,undefined,undefined,p);if(o.isApplyProcessFinished()){return new a.FakePromise();}return A.applyChangeOnControl(o,h,p).then(function(r){if(!r.success){g(r.error||{},o);}});});}catch(i){g(i,o);}});return a.execPromiseQueueSequentially(P).then(function(){return p.view;});}};return A;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/Reverter',["sap/base/Log","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/Utils"],function(L,F,U,a){"use strict";
function _(c,C,o,p){var s=false;var d=p.modifier.getControlType(C);if(c.getChangeType()==="stashControl"&&d==="sap.ui.core._StashedControl"){s=true;if(!c.hasRevertData()){o.setChangeRevertData(c,false);}}return s;}
function b(c){if(!c.isApplyProcessFinished()&&c.hasApplyProcessStarted()){return c.addPromiseForApplyProcessing().then(function(r){if(r&&r.error){c.markRevertFinished(r.error);throw Error(r.error);}});}}
var R={revertChangeOnControl:function(c,C,p){var m=U.getControlIfTemplateAffected(c,C,p);var o;return U.getChangeHandler(c,m,p).then(function(r){o=r;}).then(b.bind(null,c)).then(function(){var s=_(c,C,o,p);if(c.isApplyProcessFinished()||s){if(!c.hasRevertData()){c.setRevertData(F.getParsedRevertDataFromCustomData(C,c,p.modifier));}c.startReverting();return o.revertChange(c,m.control,p);}throw Error("Change was never applied");}).then(function(){m.control=p.modifier.bySelector(c.getSelector(),p.appComponent,p.view);if(m.bTemplateAffected){p.modifier.updateAggregation(m.control,c.getContent().boundAggregation);}c.markRevertFinished();return m.control;}).catch(function(e){var E="Change could not be reverted: "+e.message;L.error(E);c.markRevertFinished(E);return false;});},revertMultipleChanges:function(c,p){var P=[];c.forEach(function(C){C.setQueuedForRevert();P.push(function(){var s=C.getSelector&&C.getSelector();var o=p.modifier.bySelector(s,p.appComponent);if(!o){L.warning("A flexibility change tries to revert changes on a nonexistent control with id "+s.id);return new a.FakePromise();}var r={modifier:p.modifier,appComponent:p.appComponent,view:a.getViewForControl(o)};return R.revertChangeOnControl(C,o,r).then(function(v){F.destroyAppliedCustomData(v||o,C,p.modifier);return!!v;}).then(function(S){if(S){p.flexController._oChangePersistence._deleteChangeInMap(C);}});});});return a.execPromiseQueueSequentially(P);}};return R;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/Utils',["sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/Utils","sap/ui/fl/registry/ChangeHandlerRegistration","sap/ui/fl/registry/ChangeRegistry"],function(F,a,C,b){"use strict";var U={getControlIfTemplateAffected:function(c,o,p){var m=p.modifier;var d=c.getDefinition();var e={originalControl:o};var O=d.dependentSelector&&d.dependentSelector.originalSelector;if(c.getContent().boundAggregation&&O){e.control=m.bySelector(O,p.appComponent,p.view);e.controlType=m.getControlType(e.control);e.bTemplateAffected=true;}else{e.control=o;e.controlType=m.getControlType(o);e.bTemplateAffected=false;}return e;},getChangeHandler:function(c,m,p){var l=p.modifier.getLibraryName(m.control);var w=new a.FakePromise();if(C.isChangeHandlerRegistrationInProgress(l)){w=C.waitForChangeHandlerRegistration(l);}return w.then(function(){var s=c.getChangeType();var L=c.getLayer();var o=b.getInstance();o.initSettings();return o.getChangeHandler(s,m.controlType,m.control,p.modifier,L);});},checkIfDependencyIsStillValid:function(A,m,c,s){var o=a.getChangeFromChangesMap(c.mChanges,s);var d=m.bySelector(o.getSelector(),A);if(F.hasChangeApplyFinishedCustomData(d,o,m)||o.hasApplyProcessStarted()){return false;}return true;}};return U;});
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/BackendConnector',["sap/base/util/merge","sap/ui/fl/apply/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/Utils","sap/base/util/restricted/_pick"],function(m,B,A,_){"use strict";var a=m({},B,{xsrfToken:undefined,settings:undefined,loadFlexData:function(p){var P=_(p,["appVersion"]);if(p.draftLayer){P.draft=true;}var d=A.getUrl(this.ROUTES.DATA,p,P);return A.sendRequest(d,"GET",{xsrfToken:this.xsrfToken}).then(function(r){var R=r.response;if(r.xsrfToken){this.xsrfToken=r.xsrfToken;}R.changes=R.changes.concat(R.compVariants||[]);if(R.settings){this.settings=R.settings;}return R;}.bind(this));}});return a;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/JsObjectConnector',["sap/base/util/merge","sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector"],function(m,O){"use strict";var M={_itemsStoredAsObjects:true,_items:{},setItem:function(k,v){M._items[k]=v;},removeItem:function(k){delete M._items[k];},clear:function(){M._items={};},getItem:function(k){return M._items[k];},getItems:function(){return M._items;}};var J=m({},O,{oStorage:M});return J;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/KeyUserConnector',["sap/base/util/merge","sap/ui/fl/apply/_internal/connectors/BackendConnector"],function(m,B){"use strict";var P="/flex/keyuser";var A="/v1";var K=m({},B,{ROUTES:{DATA:P+A+"/data/"}});return K;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/LocalStorageConnector',["sap/base/util/merge","sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector"],function(m,O){"use strict";var L=m({},O,{oStorage:window.localStorage});return L;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/LrepConnector',["sap/base/util/merge","sap/ui/fl/apply/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/Utils","sap/ui/fl/Utils","sap/ui/dom/includeScript","sap/base/util/restricted/_pick"],function(m,B,A,F,i,_){"use strict";var R={DATA:"/flex/data/",MODULES:"/flex/modules/"};var L=m({},B,{xsrfToken:undefined,settings:undefined,_loadModules:function(f){return new Promise(function(r,a){i(f,undefined,r,a);});},_addClientAndLanguageInfo:function(p){var c=F.getUrlParameter("sap-client");var l=F.getUrlParameter("sap-language")||F.getUrlParameter("sap-ui-language");if(!p&&(c||l)){p={};}if(c){p["sap-client"]=c;}if(l){p["sap-language"]=l;}},loadFlexData:function(p){if(p.cacheKey==="<NO CHANGES>"){return Promise.resolve();}var P=_(p,["appVersion"]);this._addClientAndLanguageInfo(P);var a;if(p.appDescriptor&&p.appDescriptor["sap.app"]){a=p.appDescriptor["sap.app"].id;}var d=A.getUrl(R.DATA,p,P);return A.sendRequest(d,"GET",{xsrfToken:this.xsrfToken,siteId:p.siteId,sAppDescriptorId:a}).then(function(r){var o=r.response;if(r.xsrfToken){this.xsrfToken=r.xsrfToken;}o.changes=o.changes.concat(o.compVariants||[]);if(o.settings){this.settings=o.settings;}if(!o.loadModules){return o;}var M=A.getUrl(R.MODULES,p,P);return this._loadModules(M).then(function(){return o;});}.bind(this));}});return L;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/ObjectPathConnector',["sap/base/util/merge","sap/ui/fl/apply/connectors/BaseConnector","sap/ui/fl/apply/_internal/StorageUtils","sap/base/util/LoaderExtensions"],function(m,B,S,L){"use strict";var O=m({},B,{setJsonPath:function(i){O.jsonPath=i;},loadFlexData:function(p){var P=O.jsonPath||p.path;if(P){return L.loadResource({dataType:"json",url:P,async:true}).then(function(r){return Object.assign(S.getEmptyFlexDataResponse(),r);});}return Promise.resolve();}});return O;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector',["sap/base/util/merge","sap/ui/fl/apply/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/ObjectStorageUtils","sap/ui/fl/apply/_internal/StorageUtils"],function(m,B,O,S){"use strict";
function l(p){var f=[];return O.forEachObjectInStorage(p,function(F){f.push(F.changeDefinition);}).then(function(){return f;});}
var a=m({},B,{oStorage:undefined,loadFlexData:function(p){return l({storage:this.oStorage,reference:p.reference}).then(function(f){var g=S.getGroupedFlexObjects(f);return S.filterAndSortResponses(g);});}});return a;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/ObjectStorageUtils',[],function(){"use strict";var F="sap.ui.fl";return{forEachObjectInStorage:function(p,P){var r=p.storage.getItems&&p.storage.getItems()||p.storage;return Promise.resolve(r).then(function(r){var a=Object.keys(r).map(function(k){var i=k.includes(F);if(!i){return;}var s=r[k];var f=p.storage._itemsStoredAsObjects?s:JSON.parse(s);var S=true;if(p.reference){S=f.reference===p.reference||f.reference+".Component"===p.reference;}var b=true;if(p.layer){b=f.layer===p.layer;}if(!S||!b){return;}return P({changeDefinition:f,key:k});});return Promise.all(a);});},getAllFlexObjects:function(p){var f=[];return this.forEachObjectInStorage(p,function(m){f.push(m);}).then(function(){return f;});},createFlexKey:function(i){if(i){return F+"."+i;}},createFlexObjectKey:function(f){return this.createFlexKey(f.fileName);}};});
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/PersonalizationConnector',["sap/base/util/merge","sap/ui/fl/apply/_internal/connectors/BackendConnector"],function(m,B){"use strict";var P="/flex/personalization";var A="/v1";var a=m({},B,{ROUTES:{DATA:P+A+"/data/"}});return a;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/SessionStorageConnector',["sap/base/util/merge","sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector"],function(m,O){"use strict";var S=m({},O,{oStorage:window.sessionStorage});return S;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/StaticFileConnector',["sap/base/util/merge","sap/ui/fl/apply/connectors/BaseConnector","sap/base/Log","sap/base/util/LoaderExtensions"],function(m,B,L,a){"use strict";
function _(r,b){var s=r.replace(/\./g,"/")+"/changes/"+b+".json";var c=!!sap.ui.loader._.getModuleState(s);var C=sap.ui.getCore().getConfiguration();if(c||C.getDebug()||C.getComponentPreload()==="off"){try{return a.loadResource(s);}catch(e){if(e.name.includes("SyntaxError")){L.error(e);}L.warning("flexibility did not find a "+b+".json for the application: "+r);}}}
var S=m({},B,{loadFlexData:function(p){var c=p.componentName;if(!c){c=p.reference.replace(/.Component/g,"");}var f=_(c,"flexibility-bundle");if(f){f.changes=f.changes.concat(f.compVariants);delete f.compVariants;return Promise.resolve(f);}var C=_(c,"changes-bundle");if(C){return Promise.resolve({changes:C});}return Promise.resolve();}});return S;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/connectors/Utils',["sap/base/security/encodeURLParameters","sap/base/Log"],function(e,L){"use strict";return{logAndResolveDefault:function(r,c,f,E){L.error("Connector ("+c.connector+") failed call '"+f+"': "+E);return r;},getUrl:function(r,p,P){if(!r||!p.url){throw new Error("Not all necessary parameters were passed");}var u=p.url+r;if(p.cacheKey){u+="~"+p.cacheKey+"~/";}if(p.reference){u+=p.reference;}else if(p.fileName){u+=p.fileName;}if(P){Object.keys(P).forEach(function(k){if(P[k]===undefined){delete P[k];}});var q=e(P);if(q.length>0){u+="?"+q;}}return u;},sendRequest:function(u,m,p){m=m||"GET";m=m.toUpperCase();return new Promise(function(r,a){var x=new XMLHttpRequest();x.open(m,u);if((m==="GET"||m==="HEAD")&&(!p||!p.xsrfToken)){x.setRequestHeader("X-CSRF-Token","fetch");}if((m==="POST"||m==="PUT"||m==="DELETE")&&p&&p.xsrfToken){x.setRequestHeader("X-CSRF-Token",p.xsrfToken);}if(p&&p.contentType){x.setRequestHeader("Content-Type",p.contentType);}if(p&&p.siteId){x.setRequestHeader("X-LRep-Site-Id",p.siteId);}if(p&&p.sAppDescriptorId){x.setRequestHeader("X-LRep-AppDescriptor-Id",p.sAppDescriptorId);}if(p&&p.dataType){x.responseType=p.dataType;}if(p&&p.payload){x.send(p.payload);}else{x.send();}x.onload=function(){if(x.status>=200&&x.status<400){var R={};if(x.status!==204){if(!x.response&&x.responseText){x.response=x.responseText;}if(x.response){R.response=typeof x.response==="string"?JSON.parse(x.response):x.response;}}R.status=x.status;if(x.getResponseHeader("X-CSRF-Token")){R.xsrfToken=x.getResponseHeader("X-CSRF-Token");}r(R);}else{a({status:x.status,message:x.statusText});}};});}};});
sap.ui.predefine('sap/ui/fl/apply/_internal/controlVariants/URLHandler',["sap/ui/core/Component","sap/ui/fl/Utils","sap/base/Log","sap/base/util/merge","sap/base/util/isEmptyObject","sap/ui/base/ManagedObjectObserver","sap/ui/thirdparty/hasher"],function(C,U,L,m,i,M,h){"use strict";
function g(o,N){var d=N.params[c.variantTechnicalParameterName];return d.reduce(function(r,v){var V=o.getVariantManagementReference(v).variantManagementReference;if(V&&o.oData[V].currentVariant!==v){r.updateRequired=true;if(o.oData[V].currentVariant!==o.oData[V].defaultVariant){r.currentVariantReferences.push(o.oData[V].currentVariant);}}else{r.currentVariantReferences.push(v);}return r;},{updateRequired:false,currentVariantReferences:[]});}
function n(o,N){var u=U.getUshellContainer();var S=u.getService("ShellNavigation");try{var d=u.getService("URLParsing");var e=d.parseShellHash(N);var r=e&&e.params.hasOwnProperty(c.variantTechnicalParameterName);if(r){var f=g(o,e);if(f.updateRequired){c.update({updateURL:!o._bDesignTimeMode,parameters:f.currentVariantReferences,updateHashEntry:true,model:o});}if(o._bDesignTimeMode){c.clearAllVariantURLParameters({model:o});}}}catch(E){L.error(E.message);}return S.NavigationFilterStatus.Continue;}
function s(o,S){var d=S?"registerNavigationFilter":"unregisterNavigationFilter";var u=U.getUshellContainer();if(u){u.getService("ShellNavigation")[d](n.bind(null,o));}}
function a(p){var P=U.getParsedURLHash(c.variantTechnicalParameterName);if(P.params){var t=U.getTechnicalParametersForComponent(p.model.oAppComponent);if(!t){L.warning("Component instance not provided, so technical parameters in component data and browser history remain unchanged");}if(p.parameters.length===0){delete P.params[c.variantTechnicalParameterName];t&&delete t[c.variantTechnicalParameterName];}else{P.params[c.variantTechnicalParameterName]=p.parameters;t&&(t[c.variantTechnicalParameterName]=p.parameters);}if(p.silent){h.changed.active=false;h.replaceHash(U.getUshellContainer().getService("URLParsing").constructShellHash(P));h.changed.active=true;}else{var o=U.getUshellContainer().getService("CrossApplicationNavigation");o.toExternal({target:{semanticObject:P.semanticObject,action:P.action,context:P.contextRaw},params:P.params,appSpecificRoute:P.appSpecificRoute,writeHistory:false});}}}
function b(p){var r={index:-1};var u=U.getParsedURLHash().params;if(u){r.parameters=[];if(p.model._bDesignTimeMode){u[c.variantTechnicalParameterName]=c.getStoredHashParams(p);}if(Array.isArray(u[c.variantTechnicalParameterName])){u[c.variantTechnicalParameterName]=u[c.variantTechnicalParameterName].map(decodeURIComponent);u[c.variantTechnicalParameterName].some(function(P,I){if(p.model.oVariantController.getVariant(p.vmReference,P)){r.index=I;return true;}});}}return m(r,u&&u[c.variantTechnicalParameterName]&&{parameters:u[c.variantTechnicalParameterName]});}
var c={variantTechnicalParameterName:"sap-ui-fl-control-variant-id",initialize:function(p){var u=U.getParsedURLHash().params;p.model._oHashData={hashParams:(u&&u[c.variantTechnicalParameterName])||[],controlPropertyObservers:[],variantControlIds:[]};c.attachHandlers(p);},updateVariantInURL:function(p){var u=c.removeURLParameterForVariantManagement(p);if(!u.parameters){return;}var P=u.parameters||[];var I=u.index;var d=p.newVReference===p.model.oData[p.vmReference].defaultVariant;if(!d){if(I===-1){P=P.concat([p.newVReference]);}else{P=P.slice(0,I).concat([p.newVReference],P.slice(I));}}if(!d||I>-1){c.update({parameters:P,updateURL:!p.model._bDesignTimeMode,updateHashEntry:true,model:p.model});}},removeURLParameterForVariantManagement:function(p){var v=b(p);if(v.index>-1){v.parameters.splice(v.index,1);}return v;},attachHandlers:function(p){function o(){return p.model._oVariantSwitchPromise.then(function(){p.model._oHashData.controlPropertyObservers.forEach(function(O){O.destroy();});s(p.model,false);p.model.oChangePersistence.resetVariantMap();p.model.destroy();p.model.oComponentDestroyObserver.unobserve(p.model.oAppComponent,{destroy:true});p.model.oComponentDestroyObserver.destroy();});}s(p.model,true);if(!p.model.oComponentDestroyObserver&&p.model.oAppComponent instanceof C){p.model.oComponentDestroyObserver=new M(o.bind(null));p.model.oComponentDestroyObserver.observe(p.model.oAppComponent,{destroy:true});}if(p.updateURL){p.model._oHashData.variantControlIds.push(p.vmReference);}},update:function(p){if(!p||!Array.isArray(p.parameters)){L.info("Variant URL parameters could not be updated since invalid parameters were received");return;}if(p.updateURL){a(p);}if(p.updateHashEntry&&!i(p.model)){p.model._oHashData.hashParams=p.parameters;}},getStoredHashParams:function(p){return Array.prototype.slice.call(p.model._oHashData.hashParams);},handleModelContextChange:function(p){var d="modelContextChange";function e(E,P){var v=P.model.getVariantManagementReferenceForControl(E.getSource());var V=P.model._oHashData.variantControlIds;var I=V.indexOf(v);if(I>-1){V.slice(I).forEach(function(f){if(b({vmReference:f,model:p.model}).index===-1){P.model.switchToDefaultForVariantManagement(f);}});}}var o=new M(function(E){if(E.current===true&&E.old===false){E.object.attachEvent(d,{model:p.model},e);}else if(E.current===false&&E.old===true){E.object.detachEvent(d,e);}});o.observe(p.vmControl,{properties:["resetOnContextChange"]});p.model._oHashData.controlPropertyObservers.push(o);if(p.vmControl.getResetOnContextChange()!==false){p.vmControl.attachEvent(d,{model:p.model},e);}},clearAllVariantURLParameters:function(p){c.update({updateURL:true,parameters:[],updateHashEntry:false,model:p.model});}};return c;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/controlVariants/Utils',[],function(){"use strict";var V={DEFAULT_AUTHOR:"SAP",VARIANT_TECHNICAL_PARAMETER:"sap-ui-fl-control-variant-id",compareVariants:function(v,o){if(v.content.content.title.toLowerCase()<o.content.content.title.toLowerCase()){return-1;}else if(v.content.content.title.toLowerCase()>o.content.content.title.toLowerCase()){return 1;}return 0;},getIndexToSortVariant:function(v,o){var s=v.length;v.some(function(e,i){if(V.compareVariants(o,e)<0){s=i;return true;}});return s;}};return V;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/FlexState',["sap/base/util/merge","sap/base/util/ObjectPath","sap/ui/core/Component","sap/ui/fl/apply/_internal/StorageUtils","sap/ui/fl/apply/_internal/flexState/Loader","sap/ui/fl/apply/_internal/flexState/prepareAppDescriptorMap","sap/ui/fl/apply/_internal/flexState/prepareChangesMap","sap/ui/fl/apply/_internal/flexState/prepareVariantsMap","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(m,O,C,S,L,p,a,b,c,U){"use strict";var F={};var _={};var d={};var e={appDescriptorMap:p,changesMap:a,variantsMap:b};
function f(P){var o=C.get(P.componentId);P.componentData=P.componentData||o.getComponentData()||{};P.manifest=P.manifest||P.rawManifest||o.getManifestObject();P.reference=P.reference||U.getComponentClassName(o);}
function g(r,M){if(!_[r]){throw Error("State is not yet initialized");}if(!_[r].preparedMaps[M]){var P={storageResponse:_[r].unfilteredStorageResponse,componentId:_[r].componentId};_[r].preparedMaps[M]=F._callPrepareFunction(M,P);}return _[r].preparedMaps[M];}
function h(r){return g(r,"appDescriptorMap");}
function i(r){return g(r,"changesMap");}
function j(r){return g(r,"variantsMap");}
function k(P){if(P.reference.endsWith(".Component")){var o=P.reference.split(".");o.pop();var r=o.join(".");_[r]=m({},{storageResponse:{changes:S.getEmptyFlexDataResponse()},unfilteredStorageResponse:{changes:S.getEmptyFlexDataResponse()},preparedMaps:{},componentId:P.componentId});d[r]=d[P.reference];}}
function l(r){var o=m({},r);var q=o.changes;var s=["changes","variants","variantChanges","variantDependentControlChanges","variantManagementChanges"];if(c.isLayerFilteringRequired()){s.forEach(function(t){q[t]=c.filterChangeDefinitionsByMaxLayer(q[t]);});}return o;}
function n(P){d[P.reference]=L.loadFlexData(P).then(function(r){_[P.reference]=m({},{unfilteredStorageResponse:r,preparedMaps:{},componentId:P.componentId});k(P);return r;});return d[P.reference];}
F.initialize=function(P){return Promise.resolve().then(function(P){f(P);if(d[P.reference]){return d[P.reference].then(function(P){if(_[P.reference].componentId!==P.componentId){return n(P);}return _[P.reference].unfilteredStorageResponse;}.bind(null,P));}return n(P);}.bind(null,P)).then(function(P,r){if(!_[P.reference].storageResponse){_[P.reference].storageResponse=l(r);}F.getVariantsState(P.reference);}.bind(null,P));};
F.clearAndInitialize=function(P){f(P);var v=!!O.get(["preparedMaps","variantsMap"],_[P.reference]);F.clearState(P.reference);return F.initialize(P).then(function(v,r){if(v){return F.getVariantsState(r);}}.bind(null,v,P.reference));};
F.clearState=function(r){if(r){delete _[r];delete d[r];}else{_={};d={};}};
F.clearMaxLayerFiltering=function(r){delete _[r].storageResponse;F.clearPreparedMaps(r);};
F.getUIChanges=function(r){return i(r).changes;};
F.getAppDescriptorChanges=function(r){return h(r).appDescriptorChanges;};
F.getVariantsState=function(r){var v=j(r);_[r].unfilteredStorageResponse.changes.variantSection=v;return v;};
F._callPrepareFunction=function(M,P){return e[M](P);};
F.getStorageResponse=function(r){if(d[r]){return d[r].then(function(){return _[r].unfilteredStorageResponse;});}};
F.getFlexObjectsFromStorageResponse=function(r){return _[r].unfilteredStorageResponse.changes;};
F.clearPreparedMaps=function(r){_[r].preparedMaps={};};
return F;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/Loader',["sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/write/_internal/CompatibilityConnector","sap/ui/fl/Utils"],function(M,C,U){"use strict";return{loadFlexData:function(p){var c={name:p.reference,appVersion:U.getAppVersionFromManifest(p.manifest)||U.DEFAULT_APP_VERSION};var P={appName:M.getBaseComponentNameFromManifest(p.manifest),cacheKey:M.getCacheKeyFromAsyncHints(p.asyncHints,p.reference),siteId:U.getSiteIdByComponentData(p.componentData),appDescriptor:p.manifest.getRawJson?p.manifest.getRawJson():p.manifest};return C.loadChanges(c,P);}};});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler',["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/Utils"],function(J,U){"use strict";var P="sap.ui.fl:PendingChange";var D={};
function _(s,A){return s.idIsLocal?A.createId(s.id):s.id;}
function a(s,C,m){if(!m.mChanges[s]){m.mChanges[s]=[];}if(m.mChanges[s].indexOf(C)===-1){m.mChanges[s].push(C);}if(m.aChanges.indexOf(C)===-1){m.aChanges.push(C);}}
function b(C,A,m){var s=C.getSelector();if(s&&s.id){var S=_(s,A);a(S,C,m);if(s.idIsLocal===undefined&&S.indexOf("---")!==-1){var h=S.split("---")[0];if(h!==A.getId()){S=S.split("---")[1];S=A.createId(S);a(S,C,m);}}}return m.aChanges;}
function c(C,A,h,m){var i=C.getDependentSelectorList();var j=C.getDependentControlSelectorList();d(C,A,j,m);h.slice(0,h.length-1).reverse().forEach(function(E){var k=E.getDependentSelectorList();i.some(function(o){var l=U.indexOfObject(k,o);if(l>-1){e(C,E,m);return true;}});});}
function d(o,A,C,m){if(C.length>0){if(!m.mDependencies[o.getId()]){m.mDependencies[o.getId()]={changeObject:o,dependencies:[],controlsDependencies:[]};}m.mDependencies[o.getId()].controlsDependencies=C;var s;C.forEach(function(S){s=_(S,A);m.mControlsWithDependencies[s]=true;});}}
function e(o,C,m){if(!m.mDependencies[o.getId()]){m.mDependencies[o.getId()]={changeObject:o,dependencies:[]};}m.mDependencies[o.getId()].dependencies.push(C.getId());if(!m.mDependentChangesOnMe[C.getId()]){m.mDependentChangesOnMe[C.getId()]=[];}m.mDependentChangesOnMe[C.getId()].push(o.getId());}
function f(C,A){var h=[];var i=[];var p=[];g(C,A);Object.keys(C.mDependencies).forEach(function(s){var o=C.mDependencies[s];if(o[P]&&o.dependencies.length===0&&!(o.controlsDependencies&&o.controlsDependencies.length>0)){p.push(function(){return o[P]().then(function(){i.push(s);h.push(o.changeObject.getId());});});}});return U.execPromiseQueueSequentially(p).then(function(){for(var j=0;j<i.length;j++){delete C.mDependencies[i[j]];}for(var k=0;k<h.length;k++){D.removeChangeFromDependencies(C,h[k]);}return h;});}
function g(C,A){Object.keys(C.mDependencies).forEach(function(s){var o=C.mDependencies[s];if(o.controlsDependencies&&o.controlsDependencies.length>0){var l=o.controlsDependencies.length;while(l--){var S=o.controlsDependencies[l];var h=J.bySelector(S,A);if(h){o.controlsDependencies.splice(l,1);delete C.mControlsWithDependencies[h.getId()];}}}});}
D.addChangeAndUpdateDependencies=function(C,A,m){var h=b(C,A,m);c(C,A,h,m);};
D.addRuntimeChangeAndUpdateDependencies=function(C,A,m,i){var h=b(C,A,m);c(C,A,h,i);};
D.processDependentQueue=function(C,A){return f(C,A).then(function(h){if(h.length>0){return D.processDependentQueue(C,A);}});};
D.addChangeApplyCallbackToDependency=function(C,s,h){C.mDependencies[s][P]=h;};
D.removeChangeFromDependencies=function(C,s){if(C.mDependentChangesOnMe[s]){C.mDependentChangesOnMe[s].forEach(function(k){var o=C.mDependencies[k];var i=o?o.dependencies.indexOf(s):-1;if(i>-1){o.dependencies.splice(i,1);}});delete C.mDependentChangesOnMe[s];}};
return D;});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/controlVariants/Switcher',["sap/base/util/includes","sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/changes/Reverter"],function(i,_,V,R){"use strict";
function a(p){var c=V.getVariantChanges(Object.assign(_(p,["vmReference","variantsMap"]),{changeInstance:true,vReference:p.currentVReference}));var C=c.map(function(o){return o.getId();});var m=Object.keys(p.changesMap).reduce(function(b,d){return b.concat(p.changesMap[d]);},[]);var f=m.filter(function(o){return i(C,o.getId());});var n=V.getVariantChanges(Object.assign(_(p,["vmReference","variantsMap"]),{changeInstance:true,vReference:p.newVReference}));var r=[];if(n.length>0){r=f.slice();f.some(function(o){if(n[0]&&o.getId()===n[0].getId()){n.shift();r.shift();}else{return true;}});}else{r=f;}var s={changesToBeReverted:r.reverse(),changesToBeApplied:n};return s;}
var S={switchVariant:function(p){p.changesMap=p.flexController._oChangePersistence.getChangesMapForComponent().mChanges;p.variantsMap=V.getContent({reference:p.flexController.getComponentName()});var c=a(p);return R.revertMultipleChanges(c.changesToBeReverted,p).then(p.flexController.applyVariantChanges.bind(p.flexController,c.changesToBeApplied,p.appComponent)).then(V.setCurrentVariant.bind(null,p));}};return S;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState',["sap/ui/fl/Variant","sap/ui/fl/Change","sap/base/util/ObjectPath","sap/base/util/includes","sap/base/util/restricted/_omit","sap/base/Log","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/fl/LayerUtils","sap/ui/fl/apply/_internal/flexState/FlexState","sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/controlVariants/Utils"],function(V,C,O,i,_,L,U,a,F,b,c){"use strict";
function d(p){var r=[];if(p.variantData.content.variantReference){r=g.getVariantChanges(Object.assign(p,{vReference:p.variantData.content.variantReference,changeInstance:true}));return r.filter(function(R){return a.compareAgainstCurrentLayer(R.getDefinition().layer,p.variantData.content.layer)===-1;});}return r;}
function e(p){var v=g.getContent(p.reference);var h=O.get([p.vmReference,"variants"],v);return h||[];}
function f(v,o,A){var s=o.changeType;if(!v){v={};}if(!v[s]){v[s]=[];}if(A){v[s].push(o);return true;}return v[s].some(function(E,I){if(E.fileName===o.fileName){v[s].splice(I,1);return true;}});}
var g={getContent:function(r){return F.getVariantsState(r);},getVariantChanges:function(p){var v=g.getContent(p.reference);var s=p.vReference||v[p.vmReference].defaultVariant;var r=[];if(s&&typeof s==="string"){var o=g.getVariant(Object.assign(p,{vReference:s}));r=o.controlChanges;if(p.changeInstance){r=r.map(function(h,j){var k;if(!h.getDefinition){k=new C(h);o.controlChanges.splice(j,1,k);}else{k=h;}return k;});}}return r;},getVariant:function(p){var v;var h=e(p);h.some(function(o){if(o.content.fileName===p.vReference){v=o;return true;}});return v;},addVariantToVariantManagement:function(p){var v=g.getContent(p.reference);var h=v[p.vmReference].variants.slice().splice(1);var I=c.getIndexToSortVariant(h,p.variantData);if(p.variantData.content.variantReference){var r=d(p);p.variantData.controlChanges=r.concat(p.variantData.controlChanges);}v[p.vmReference].variants.splice(I+1,0,p.variantData);return I+1;},removeVariantFromVariantManagement:function(p){var I;var v=g.getContent(p.reference);var h=v[p.vmReference].variants.some(function(o,j){var k=new V(o);if(k.getId()===p.variant.getId()){I=j;return true;}});if(h){v[p.vmReference].variants.splice(I,1);}return I;},setVariantData:function(p){var v=g.getContent(p.reference);var h=v[p.vmReference].variants;var o=h[p.previousIndex];Object.keys(p.variantData).forEach(function(P){if(o.content.content[P]){o.content.content[P]=p.variantData[P];}});if(o.content.fileName!==p.vmReference){h.splice(p.previousIndex,1);var s=c.getIndexToSortVariant(h.slice(1),o);h.splice(s+1,0,o);return s+1;}h.splice(p.previousIndex,1,o);return p.previousIndex;},addChangeToVariant:function(p){var E=g.getVariantChanges(Object.assign(p,{changeInstance:true}));var h=E.map(function(o){return o.getDefinition().fileName;});if(!i(h,p.change.getDefinition().fileName)){var v=g.getVariant(p);v.controlChanges=E.concat([p.change]);return true;}return false;},removeChangeFromVariant:function(p){var h=g.getVariantChanges(Object.assign(p,{changeInstance:true}));var v=g.getVariant(p);var j=false;if(v){v.controlChanges=h.filter(function(o){if(!j&&o.getId()===p.change.getId()){j=true;return false;}return true;});}return j;},loadInitialChanges:function(p){var v=g.getContent(p.reference);return Object.keys(v).reduce(function(I,s){var h=v[s].currentVariant?"currentVariant":"defaultVariant";var A={vmReference:s,vReference:v[s][h],reference:p.reference};return I.concat(g.getVariantChanges(Object.assign({},p,A)));},[]);},fillVariantModel:function(p){var v=g.getContent(p.reference);return Object.keys(v).reduce(function(o,s){o[s]={defaultVariant:v[s].defaultVariant,variants:[]};if(v[s].currentVariant){o[s].currentVariant=v[s].currentVariant;}e(Object.assign(p,{vmReference:s})).forEach(function(h,j){o[s].variants[j]=JSON.parse(JSON.stringify({key:h.content.fileName,title:h.content.content.title,layer:h.content.layer,favorite:h.content.content.favorite,visible:h.content.content.visible,author:O.get("content.support.user",h)}));});return o;},{});},updateChangesForVariantManagementInMap:function(p){var v=g.getContent(p.reference);var o=v[p.vmReference];if(p.changeContent.fileType==="ctrl_variant_change"){o.variants.some(function(h){if(h.content.fileName===p.changeContent.selector.id){return f(h.variantChanges,p.changeContent,p.add);}});}else if(p.changeContent.fileType==="ctrl_variant_management_change"){return f(o.variantManagementChanges,p.changeContent,p.add);}},setCurrentVariant:function(p){var v=g.getContent(p.reference);v[p.vmReference].currentVariant=p.newVReference;}};return g;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/prepareAppDescriptorMap',["sap/ui/fl/Change"],function(C){"use strict";return function(p){var c=p.storageResponse.changes.appDescriptorChanges||[];var a=c.map(function(o){return new C(o);});return{appDescriptorChanges:a};};});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/prepareChangesMap',["sap/ui/fl/Change"],function(C){"use strict";return function(p){var c=p.storageResponse.changes.changes;var a=c.map(function(o){return new C(o);});return{changes:a};};});
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/prepareVariantsMap',["sap/ui/fl/Utils","sap/base/util/ObjectPath","sap/base/Log","sap/ui/fl/Change","sap/base/util/includes","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/base/util/isEmptyObject","sap/base/util/each","sap/base/util/values","sap/base/util/merge","sap/ui/core/Component","sap/ui/fl/LayerUtils"],function(U,O,L,C,i,V,a,e,v,m,b,c){"use strict";
function d(z,A){var B=m({},z);A.forEach(function(D){B[D.fileName]={content:D,controlChanges:[],variantChanges:{}};});return B;}
function f(z,A){var B=m({},z);A.forEach(function(D){B[D.variantReference]=B[D.variantReference]||s(D.variantReference);B[D.variantReference].controlChanges.push(D);});return B;}
function g(z,A){var B=m({},z);A.forEach(function(D){B[D.selector.id]=B[D.selector.id]||s(D.selector.id);var E=B[D.selector.id].variantChanges[D.changeType]||[];E.push(D);B[D.selector.id].variantChanges[D.changeType]=E;});return B;}
function r(z){var A=m({},z);v(A).forEach(function(B){var D=B.content.variantReference;var R;if(D){R=j(A,D,B.content.variantManagementReference);}B.controlChanges=h(R,B.content.layer).concat(B.controlChanges);});return A;}
function h(R,z){if(!R){return[];}return v(m({},R.controlChanges)).filter(function(A){return c.compareAgainstCurrentLayer(A.layer,z)===-1;});}
function j(z,A,B){var R=z[A];if(!R&&A===B){R=s(A);z[A]=R;}return R;}
function k(S){var z={};z=d(z,S.variants);z=f(z,S.variantDependentControlChanges);z=g(z,S.variantChanges);z=r(z);return z;}
function l(){return{variantManagementChanges:{},variants:[]};}
function n(R,z,T){var A=m({},R);v(z).forEach(function(B){var D=B.content.variantManagementReference;if(!A[D]){A[D]=l();}B=y(B);B=u(B);if(!A[D].currentVariant&&B.content.content.visible&&i(T,B.content.fileName)){A[D].currentVariant=B.content.fileName;}A[D].defaultVariant=D;var S=V.getIndexToSortVariant(A[D].variants,B);A[D].variants.splice(S,0,B);});return A;}
function o(R,z){var A=m({},R);z.forEach(function(B){var D=B.selector.id;if(!A[D]){A[D]=l();}var E=B.changeType;if(!A[D].variantManagementChanges[E]){A[D].variantManagementChanges[E]=[];}A[D].variantManagementChanges[E].push(B);A[D]=t(A[D]);});return A;}
function p(R){var z=m({},R);e(z,function(A,B){var S=B.variants.findIndex(function(E){return E.content.fileName===A;});var D;if(S===-1){D=s(A);}else{D=B.variants[S];B.variants.splice(S,1);}B.variants.unshift(D);});return z;}
function q(z,A,T){var R={};R=n(R,z,T);R=o(R,A);R=p(R);return R;}
function s(z){var R=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");return{content:{fileName:z,variantManagementReference:z,content:{title:R.getText("STANDARD_VARIANT_TITLE"),favorite:true,visible:true},support:{user:V.DEFAULT_AUTHOR}},variantChanges:{},controlChanges:[]};}
function t(z){var A=m({},z);var B=A.variantManagementChanges;var D;if(!a(B)){D=w(B["setDefault"]);if(D){A.defaultVariant=D.getContent().defaultVariant;}}return A;}
function u(z){var A=m({},z);var B=A.variantChanges;var D;e(B,function(E,F){switch(E){case"setTitle":D=w(F);if(D){A.content.content.title=D.getText("title");}break;case"setFavorite":D=w(F);if(D){A.content.content.favorite=D.getContent().favorite;}break;case"setVisible":D=w(F);if(D){A.content.content.visible=D.getContent().visible;}break;default:L.error("No valid changes on variant "+A.content.content.title+" available");}});return A;}
function w(z){if(z.length>0){return new C(z[z.length-1]);}return false;}
function x(T){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl").getText(T);}
function y(z){var A=m({},z);if(A.content.fileName===A.content.variantManagementReference){if(!O.get("content.support.user",A)){var S={support:{user:V.DEFAULT_AUTHOR}};m(A.content,S);}}if(!A.content.content.favorite){A.content.content.favorite=true;}if(!A.content.content.visible){A.content.content.visible=true;}var T=A.content.content.title.match(/.i18n>(\w+)./);if(T){A.content.content.title=x(T[1]);}return A;}
return function(P){if(a(P)||!O.get("storageResponse.changes.variants",P)){return{};}var T=[];if(P.componentId){var z=b.get(P.componentId);var A=z.getComponentData();T=O.get(["technicalParameters",V.VARIANT_TECHNICAL_PARAMETER],A)||[];}var B=k(P.storageResponse.changes);B=q(B,P.storageResponse.changes.variantManagementChanges,T);m(P.storageResponse.changes,{variantSection:B});return B;};});
sap.ui.predefine('sap/ui/fl/apply/_internal/storageResultDisassemble',["sap/ui/fl/apply/_internal/StorageUtils"],function(S){"use strict";
function _(f,c){if(c.content.fileName!==c.content.variantManagementReference){f.push(c.content);}c.controlChanges.forEach(function(o){f.push(o);});for(var C in c.variantChanges){f=f.concat(c.variantChanges[C]);}return f;}
return function(r){var f=r.changes||[];for(var v in r.variantSection){var V=r.variantSection[v];for(var c in V.variantManagementChanges){f=f.concat(V.variantManagementChanges[c]);}f=V.variants.reduce(_,f);}var g=S.getGroupedFlexObjects(f);return S.filterAndSortResponses(g);};});
sap.ui.predefine('sap/ui/fl/apply/api/ControlVariantApplyAPI',["sap/ui/fl/ControlPersonalizationAPI"],function(O){"use strict";var C={clearVariantParameterInURL:function(p){O.clearVariantParameterInURL(p.control);},activateVariant:function(p){return O.activateVariant(p.element,p.variantReference);}};return C;},true);
sap.ui.predefine('sap/ui/fl/apply/api/FlexRuntimeInfoAPI',["sap/ui/fl/ControlPersonalizationAPI","sap/ui/fl/Utils","sap/ui/fl/apply/_internal/ChangesController"],function(O,U,C){"use strict";var F={isPersonalized:function(p){return O.isPersonalized(p.selectors,p.changeTypes);},waitForChanges:function(p){var f=p.element||p.selectors[0];var w=p.element||p.selectors;return C.getFlexControllerInstance(f).waitForChangesToBeApplied(w);},isFlexSupported:function(p){return!!U.getAppComponentForControl(p.element);},hasVariantManagement:function(p){return O.hasVariantManagement(p.element);}};return F;},true);
sap.ui.predefine('sap/ui/fl/apply/api/SmartVariantManagementApplyAPI',["sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/DefaultVariant","sap/ui/fl/StandardVariant","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/registry/Settings","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/base/Log"],function(F,D,S,C,a,U,L,b){"use strict";var c={_PERSISTENCY_KEY:"persistencyKey",loadChanges:function(p){var o=p.control;var A=U.getAppDescriptor(o);var s=U.getSiteId(o);var d=this._getStableId(o);var P={appDescriptor:A,siteId:s,includeVariants:true};var e=C.getChangePersistenceForControl(o);return F.initialize({componentId:U.getAppComponentForControl(o).getId()}).then(function(){return e.getChangesForVariant(this._PERSISTENCY_KEY,d,P);}.bind(this));},getChangeById:function(p){var o=p.control;var i=p.id;if(!i||!o){b.error("sId or oControl is not defined");return undefined;}var d=this._getChangeMap(o);return d[i];},isVariantSharingEnabled:function(){return a.getInstance().then(function(i){return i.isVariantSharingEnabled();});},isApplicationVariant:function(p){var o=p.control;if(U.isApplicationVariant(o)){return true;}var d=U.getComponentForControl(o);if(d&&d.getAppComponent){d=d.getAppComponent();if(d){return true;}}return false;},isVendorLayer:function(){return L.isVendorLayer();},isVariantDownport:function(){return c.isVendorLayer()&&U.isHotfixMode();},getDefaultVariantId:function(p){var o=this._getChangeMap(p.control);return D.getDefaultVariantId(o);},getExecuteOnSelect:function(p){var o=this._getChangeMap(p.control);return S.getExecuteOnSelect(o);},_getStableId:function(o){if(!o){return undefined;}var s;try{s=o.getPersistencyKey();}catch(e){s="";}return s;},_getChangeMap:function(o){var d=C.getChangePersistenceForControl(o);var s=c._getStableId(o);return d.getSmartVariantManagementChangeMap()[s]||{};}};return c;},true);
sap.ui.predefine('sap/ui/fl/apply/api/UI2PersonalizationApplyAPI',["sap/ui/fl/apply/_internal/ChangesController","sap/ui/fl/Cache"],function(C,a){"use strict";var U={load:function(p){var f=C.getDescriptorFlexControllerInstance(p.selector);p.reference=f.getComponentName();p.appVersion=f.getAppVersion();if(!p.reference||!p.containerKey){return Promise.reject(new Error("not all mandatory properties were provided for the loading of the personalization"));}return a.getPersonalization(p.reference,p.containerKey,p.itemName);}};return U;},true);
sap.ui.predefine('sap/ui/fl/apply/connectors/BaseConnector',[],function(){"use strict";var B={loadFlexData:function(){return Promise.reject("loadFlexData is not implemented");}};return B;},true);
sap.ui.predefine('sap/ui/fl/variants/VariantManagement',["sap/ui/model/Context","sap/ui/model/PropertyBinding","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/core/InvisibleText","sap/ui/core/Control","sap/ui/core/Icon","sap/ui/layout/HorizontalLayout","sap/ui/layout/Grid","sap/m/SearchField","sap/m/RadioButton","sap/m/ColumnListItem","sap/m/Column","sap/m/Text","sap/m/Bar","sap/m/Table","sap/m/Page","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/Button","sap/m/CheckBox","sap/m/Dialog","sap/m/Input","sap/m/Label","sap/m/Title","sap/m/ResponsivePopover","sap/m/SelectList","sap/m/ObjectIdentifier","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/VBox","sap/ui/events/KeyCodes","sap/ui/core/library","sap/m/library","sap/ui/fl/Utils"],function(C,P,J,F,a,D,I,b,c,H,G,S,R,d,f,T,B,g,h,i,j,k,l,m,n,L,o,p,q,O,r,s,V,K,t,u,v){"use strict";var w=u.OverflowToolbarPriority;var x=u.ButtonType;var y=u.PlacementType;var z=u.PopinDisplay;var A=u.ScreenSize;var E=t.ValueState;var M=t.TextAlign;
var N=b.extend("sap.ui.fl.variants.VariantManagement",{
metadata:{library:"sap.ui.fl",designtime:"sap/ui/fl/designtime/variants/VariantManagement.designtime",properties:{showExecuteOnSelection:{type:"boolean",group:"Misc",defaultValue:false},showSetAsDefault:{type:"boolean",group:"Misc",defaultValue:true},manualVariantKey:{type:"boolean",group:"Misc",defaultValue:false},inErrorState:{type:"boolean",group:"Misc",defaultValue:false},editable:{type:"boolean",group:"Misc",defaultValue:true},modelName:{type:"string",group:"Misc",defaultValue:null},updateVariantInURL:{type:"boolean",group:"Misc",defaultValue:false},resetOnContextChange:{type:"boolean",group:"Misc",defaultValue:true}},associations:{"for":{type:"sap.ui.core.Control",multiple:true}},events:{save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},execute:{type:"boolean"},def:{type:"boolean"}}},manage:{},initialized:{},select:{parameters:{key:{type:"string"}}}}},
renderer:function(e,Q){e.write("<div ");e.writeControlData(Q);e.addClass("sapUiFlVarMngmt");e.writeClasses();var U=Q._oRb.getText("VARIANT_MANAGEMENT_TRIGGER_TT");e.write(" title='"+U+"'");e.write(">");e.renderControl(Q.oVariantLayout);e.write("</div>");}
});
N.INNER_MODEL_NAME="$sapUiFlVariants";N.MAX_NAME_LEN=100;N.COLUMN_FAV_IDX=0;N.COLUMN_NAME_IDX=1;
N.prototype.init=function(){this._sModelName=v.VARIANT_MODEL_NAME;this.attachModelContextChange(this._setModel,this);this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");this._createInnerModel();this.oVariantInvisibleText=new I();this.oVariantText=new o(this.getId()+"-text",{text:{path:'currentVariant',model:this._sModelName,formatter:function(Q){var U="";if(Q){U=this.getSelectedVariantText(Q);this._setInvisibleText(U,this.getModified());}return U;}.bind(this)}});this.oVariantText.addStyleClass("sapUiFlVarMngmtClickable");this.oVariantText.addStyleClass("sapUiFlVarMngmtTitle");if(D.system.phone){this.oVariantText.addStyleClass("sapUiFlVarMngmtTextPhoneMaxWidth");}else{this.oVariantText.addStyleClass("sapUiFlVarMngmtTextMaxWidth");}var e=new L(this.getId()+"-modified",{text:"*",visible:{path:"modified",model:this._sModelName,formatter:function(Q){var U=this.getCurrentVariantKey();if(U){this._setInvisibleText(this.getSelectedVariantText(U),Q);}return((Q===null)||(Q===undefined))?false:Q;}.bind(this)}});e.setVisible(false);e.addStyleClass("sapUiFlVarMngmtModified");e.addStyleClass("sapUiFlVarMngmtClickable");e.addStyleClass("sapMTitleStyleH4");this.oVariantPopoverTrigger=new k(this.getId()+"-trigger",{icon:"sap-icon://slim-arrow-down",type:x.Transparent});this.oVariantPopoverTrigger.addAriaLabelledBy(this.oVariantInvisibleText);this.oVariantPopoverTrigger.addStyleClass("sapUiFlVarMngmtTriggerBtn");this.oVariantPopoverTrigger.addStyleClass("sapMTitleStyleH4");this.oVariantLayout=new H({content:[this.oVariantText,e,this.oVariantPopoverTrigger]});this.oVariantLayout.addStyleClass("sapUiFlVarMngmtLayout");e.setVisible(false);this.oVariantInvisibleText.toStatic();this.addDependent(this.oVariantLayout);};
N.prototype.getTitle=function(){return this.oVariantText;};
N.prototype._setInvisibleText=function(e,Q){var U;if(e){if(Q){U="VARIANT_MANAGEMENT_SEL_VARIANT_MOD";}else{U="VARIANT_MANAGEMENT_SEL_VARIANT";}this.oVariantInvisibleText.setText(this._oRb.getText(U,[e]));}};
N.prototype._createInnerModel=function(){var e=new J({showExecuteOnSelection:false,showSetAsDefault:true,editable:true,popoverTitle:this._oRb.getText("VARIANT_MANAGEMENT_VARIANTS")});this.setModel(e,N.INNER_MODEL_NAME);this._bindProperties();};
N.prototype._bindProperties=function(){this.bindProperty("showExecuteOnSelection",{path:"/showExecuteOnSelection",model:N.INNER_MODEL_NAME});this.bindProperty("showSetAsDefault",{path:"/showSetAsDefault",model:N.INNER_MODEL_NAME});this.bindProperty("editable",{path:"/editable",model:N.INNER_MODEL_NAME});};
N.prototype.getOriginalDefaultVariantKey=function(){var e=this.getModel(this._sModelName);if(e&&this.oContext){return e.getProperty(this.oContext+"/originalDefaultVariant");}return null;};
N.prototype.setDefaultVariantKey=function(e){var Q=this.getModel(this._sModelName);if(Q&&this.oContext){Q.setProperty(this.oContext+"/defaultVariant",e);}};
N.prototype.getDefaultVariantKey=function(){var e=this.getModel(this._sModelName);if(e&&this.oContext){return e.getProperty(this.oContext+"/defaultVariant");}return null;};
N.prototype.setCurrentVariantKey=function(e){var Q=this.getModel(this._sModelName);if(Q&&this.oContext){Q.setProperty(this.oContext+"/currentVariant",e);}return this;};
N.prototype.getCurrentVariantKey=function(){var e=this.getModel(this._sModelName);if(e&&this.oContext){return e.getProperty(this.oContext+"/currentVariant");}return null;};
N.prototype._assignPopoverTitle=function(){var e;var Q;var U=this.getModel(this._sModelName);if(U&&this.oContext){e=U.getProperty(this.oContext+"/popoverTitle");}if(e!==undefined){Q=this.getModel(N.INNER_MODEL_NAME);if(Q){Q.setProperty("/popoverTitle",e);}}};
N.prototype.getVariants=function(){return this._getItems();};
N.prototype.setModified=function(e){var Q=this.getModel(this._sModelName);if(Q&&this.oContext){Q.setProperty(this.oContext+"/modified",e);}};
N.prototype.getModified=function(){var e=this.getModel(this._sModelName);if(e&&this.oContext){return e.getProperty(this.oContext+"/modified");}return false;};
N.prototype.getSelectedVariantText=function(e){var Q=this._getItemByKey(e);if(Q){return Q.title;}return"";};
N.prototype.getStandardVariantKey=function(){var e=this._getItems();if(e&&e[0]){return e[0].key;}return null;};
N.prototype.getShowFavorites=function(){var e=this.getModel(this._sModelName);if(e&&this.oContext){return e.getProperty(this.oContext+"/showFavorites");}return false;};
N.prototype._clearDeletedItems=function(){this._aDeletedItems=[];};
N.prototype._addDeletedItem=function(e){this._aDeletedItems.push(e);};
N.prototype._getDeletedItems=function(){return this._aDeletedItems;};
N.prototype._getItems=function(){var e=[];if(this.oContext&&this.oContext.getObject()){e=this.oContext.getObject().variants.filter(function(Q){if(!Q.hasOwnProperty("visible")){return true;}return Q.visible;});}return e;};
N.prototype._getItemByKey=function(e){var Q=null;var U=this._getItems();U.some(function(W){if(W.key===e){Q=W;}return(Q!==null);});return Q;};
N.prototype._rebindControl=function(){this.oVariantText.unbindProperty("text");this.oVariantText.bindProperty("text",{path:'currentVariant',model:this._sModelName,formatter:function(e){var Q=this.getSelectedVariantText(e);return Q;}.bind(this)});this.oVariantText.unbindProperty("visible");this.oVariantText.bindProperty("visible",{path:"modified",model:this._sModelName,formatter:function(e){return(e===null||e===undefined)?false:e;}});};
N.prototype.setModelName=function(e){if(this.getModelName()){this.oContext=null;}this.setProperty("modelName",e);this._sModelName=e;this._rebindControl();return this;};
N.prototype._setBindingContext=function(){var e;var Q;if(!this.oContext){e=this.getModel(this._sModelName);if(e){Q=this._getLocalId(e);if(Q){this.oContext=new C(e,"/"+Q);this.setBindingContext(this.oContext,this._sModelName);if(!this.getModelName()&&e.registerToModel){e.registerToModel(this);}this._assignPopoverTitle();this._registerPropertyChanges(e);this.fireInitialized();}}}};
N.prototype._getLocalId=function(e){if(this.getModelName()&&(this._sModelName!==v.VARIANT_MODEL_NAME)){return this.getId();}return e.getVariantManagementReferenceForControl(this);};
N.prototype._setModel=function(){this._setBindingContext();};
N.prototype._registerPropertyChanges=function(e){var Q=new P(e,this.oContext+"/variantsEditable");Q.attachChange(function(W){if(W&&W.oSource&&W.oSource.oModel&&W.oSource.sPath){var X;var Y=W.oSource.oModel.getProperty(W.oSource.sPath);X=this.getModel(N.INNER_MODEL_NAME);if(X){X.setProperty("/editable",Y);}}}.bind(this));var U=new P(e,this.oContext+"/variantBusy");U.attachChange(function(W){if(W&&W.oSource&&W.oSource.oModel&&W.oSource.sPath){var X=W.oSource.oModel.getProperty(W.oSource.sPath);this._handleBusy(X);}}.bind(this));};
N.prototype._handleBusy=function(e){if(e!==undefined){this.getAssociation("for",[]).forEach(function(Q){var U=sap.ui.getCore().byId(Q);if(U&&U.setBusy){U.setBusy(e);}});}};
N.prototype.handleOpenCloseVariantPopover=function(){if(!this.bPopoverOpen){this._openVariantList();}else if(this.oVariantPopOver&&this.oVariantPopOver.isOpen()){this.oVariantPopOver.close();}else if(this.getInErrorState()&&this.oErrorVariantPopOver&&this.oErrorVariantPopOver.isOpen()){this.oErrorVariantPopOver.close();}};
N.prototype.getFocusDomRef=function(){if(this.oVariantPopoverTrigger){return this.oVariantPopoverTrigger.getFocusDomRef();}};
N.prototype.onclick=function(){if(this.oVariantPopoverTrigger&&!this.bPopoverOpen){this.oVariantPopoverTrigger.focus();}this.handleOpenCloseVariantPopover();};
N.prototype.onkeyup=function(e){if(e.which===K.F4||e.which===K.SPACE||e.altKey===true&&e.which===K.ARROW_UP||e.altKey===true&&e.which===K.ARROW_DOWN){this._openVariantList();}};
N.prototype.onAfterRendering=function(){this.oVariantText.$().off("mouseover").on("mouseover",function(){this.oVariantPopoverTrigger.addStyleClass("sapUiFlVarMngmtTriggerBtnHover");}.bind(this));this.oVariantText.$().off("mouseout").on("mouseout",function(){this.oVariantPopoverTrigger.removeStyleClass("sapUiFlVarMngmtTriggerBtnHover");}.bind(this));};
N.prototype._openInErrorState=function(){var Q;if(!this.oErrorVariantPopOver){Q=new V({fitContainer:true,alignItems:sap.m.FlexAlignItems.Center,items:[new c({size:"4rem",color:"lightgray",src:"sap-icon://message-error"}),new o({titleStyle:sap.ui.core.TitleLevel.H2,text:this._oRb.getText("VARIANT_MANAGEMENT_ERROR_TEXT1")}),new T({textAlign:sap.ui.core.TextAlign.Center,text:this._oRb.getText("VARIANT_MANAGEMENT_ERROR_TEXT2")})]});Q.addStyleClass("sapUiFlVarMngmtErrorPopover");this.oErrorVariantPopOver=new p(this.getId()+"-errorpopover",{title:{path:"/popoverTitle",model:N.INNER_MODEL_NAME},contentWidth:"400px",placement:y.VerticalPreferredBottom,content:[new h(this.getId()+"-errorselpage",{showSubHeader:false,showNavButton:false,showHeader:false,content:[Q]})],afterOpen:function(){this.bPopoverOpen=true;}.bind(this),afterClose:function(){if(this.bPopoverOpen){setTimeout(function(){this.bPopoverOpen=false;}.bind(this),200);}}.bind(this),contentHeight:"300px"});this.oErrorVariantPopOver.attachBrowserEvent("keyup",function(e){if(e.which===32){this.oErrorVariantPopOver.close();}}.bind(this));}if(this.bPopoverOpen){return;}this.oErrorVariantPopOver.openBy(this.oVariantLayout);};
N.prototype._createVariantList=function(){if(this.oVariantPopOver){return;}this.oVariantManageBtn=new k(this.getId()+"-manage",{text:this._oRb.getText("VARIANT_MANAGEMENT_MANAGE"),enabled:true,press:function(){this._openManagementDialog();}.bind(this),layoutData:new s({priority:w.Low})});this.oVariantSaveBtn=new k(this.getId()+"-mainsave",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVE"),press:function(){this._handleVariantSave();}.bind(this),visible:{path:"modified",model:this._sModelName,formatter:function(Q){return Q;}},type:sap.m.ButtonType.Emphasized,layoutData:new s({priority:w.Low})});this.oVariantSaveAsBtn=new k(this.getId()+"-saveas",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVEAS"),press:function(){this._openSaveAsDialog();}.bind(this),layoutData:new s({priority:w.Low})});this._oVariantList=new q(this.getId()+"-list",{selectedKey:{path:"currentVariant",model:this._sModelName},itemPress:function(Q){var U=null;if(Q&&Q.getParameters()){var W=Q.getParameters().item;if(W){U=W.getKey();}}if(U){this.setCurrentVariantKey(U);this.fireEvent("select",{key:U});this.oVariantPopOver.close();}}.bind(this)});this._oVariantList.setNoDataText(this._oRb.getText("VARIANT_MANAGEMENT_NODATA"));var e=new sap.ui.core.Item({key:'{'+this._sModelName+">key}",text:'{'+this._sModelName+">title}"});this._oVariantList.bindAggregation("items",{path:"variants",model:this._sModelName,template:e});this._oSearchField=new S(this.getId()+"-search");this._oSearchField.attachLiveChange(function(Q){this._triggerSearch(Q,this._oVariantList);}.bind(this));this.oVariantSelectionPage=new h(this.getId()+"-selpage",{subHeader:new i({content:[this._oSearchField]}),content:[this._oVariantList],footer:new r({content:[new j(this.getId()+"-spacer"),this.oVariantSaveBtn,this.oVariantSaveAsBtn,this.oVariantManageBtn]}),showNavButton:false,showHeader:false,showFooter:{path:"/editable",model:N.INNER_MODEL_NAME}});this.oVariantPopOver=new p(this.getId()+"-popover",{title:{path:"/popoverTitle",model:N.INNER_MODEL_NAME},contentWidth:"400px",placement:y.VerticalPreferredBottom,content:[this.oVariantSelectionPage],afterOpen:function(){this.bPopoverOpen=true;}.bind(this),afterClose:function(){if(this.bPopoverOpen){setTimeout(function(){this.bPopoverOpen=false;}.bind(this),200);}}.bind(this),contentHeight:"300px"});this.oVariantPopOver.addStyleClass("sapUiFlVarMngmtPopover");if(this.oVariantLayout.$().closest(".sapUiSizeCompact").length>0){this.oVariantPopOver.addStyleClass("sapUiSizeCompact");}this.addDependent(this.oVariantPopOver);};
N.prototype.showSaveButton=function(e){if(e===false){this.oVariantSaveAsBtn.setType(sap.m.ButtonType.Emphasized);this.oVariantSaveBtn.setVisible(false);}else{this.oVariantSaveAsBtn.setType(sap.m.ButtonType.Default);this.oVariantSaveBtn.setVisible(true);}};
N.prototype._openVariantList=function(){var e;if(this.getInErrorState()){this._openInErrorState();return;}if(this.bPopoverOpen){return;}if(!this.oContext){return;}this._createVariantList();this._oSearchField.setValue("");this._oVariantList.getBinding("items").filter(this._getFilters());this.oVariantSelectionPage.setShowSubHeader(this._oVariantList.getItems().length>9);this.showSaveButton(false);if(this.getModified()){e=this._getItemByKey(this.getCurrentVariantKey());if(e&&e.change){this.showSaveButton(true);}}this.oVariantPopOver.openBy(this.oVariantLayout);};
N.prototype._triggerSearch=function(e,Q){if(!e){return;}var U=e.getParameters();if(!U){return;}var W=U.newValue?U.newValue:"";var X=new F({path:"title",operator:a.Contains,value1:W});Q.getBinding("items").filter(this._getFilters(X));};
N.prototype._createSaveAsDialog=function(){if(!this.oSaveAsDialog){this.oInputName=new n(this.getId()+"-name",{liveChange:function(){this._checkVariantNameConstraints(this.oInputName,this.oSaveSave);}.bind(this)});var e=new L(this.getId()+"-namelabel",{text:this._oRb.getText("VARIANT_MANAGEMENT_NAME"),required:true});e.setLabelFor(this.oInputName);this.oDefault=new l(this.getId()+"-default",{text:this._oRb.getText("VARIANT_MANAGEMENT_SETASDEFAULT"),visible:{path:"/showSetAsDefault",model:N.INNER_MODEL_NAME},width:"100%"});this.oExecuteOnSelect=new l(this.getId()+"-execute",{text:this._oRb.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT"),visible:{path:"/showExecuteOnSelection",model:N.INNER_MODEL_NAME},width:"100%"});this.oInputManualKey=new n(this.getId()+"-key",{liveChange:function(){this._checkVariantNameConstraints(this.oInputManualKey);}.bind(this)});this.oLabelKey=new L(this.getId()+"-keylabel",{text:this._oRb.getText("VARIANT_MANAGEMENT_KEY"),required:true});this.oLabelKey.setLabelFor(this.oInputManualKey);this.oSaveSave=new k(this.getId()+"-variantsave",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVE"),press:function(){this._bSaveCanceled=false;this._handleVariantSaveAs(this.oInputName.getValue());}.bind(this),enabled:true});var Q=new G({defaultSpan:"L12 M12 S12"});if(this.getShowSetAsDefault()){Q.addContent(this.oDefault);}if(this.getShowExecuteOnSelection()){Q.addContent(this.oExecuteOnSelect);}this.oSaveAsDialog=new m(this.getId()+"-savedialog",{title:this._oRb.getText("VARIANT_MANAGEMENT_SAVEDIALOG"),beginButton:this.oSaveSave,endButton:new k(this.getId()+"-variantcancel",{text:this._oRb.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){this._bSaveCanceled=true;this.oSaveAsDialog.close();}.bind(this)}),content:[e,this.oInputName,this.oLabelKey,this.oInputManualKey,Q],stretch:D.system.phone});this.oSaveAsDialog.addStyleClass("sapUiPopupWithPadding");this.oSaveAsDialog.addStyleClass("sapUiFlVarMngmtSaveDialog");if(this.oVariantLayout.$().closest(".sapUiSizeCompact").length>0){this.oSaveAsDialog.addStyleClass("sapUiSizeCompact");}this.addDependent(this.oSaveAsDialog);}};
N.prototype._openSaveAsDialog=function(){this._createSaveAsDialog();this.oInputName.setValue(this.getSelectedVariantText(this.getCurrentVariantKey()));this.oSaveSave.setEnabled(false);this.oInputName.setEnabled(true);this.oInputName.setValueState(E.None);this.oInputName.setValueStateText(null);this.oDefault.setSelected(false);this.oExecuteOnSelect.setSelected(false);if(this.oVariantPopOver){this.oVariantPopOver.close();}if(this.getManualVariantKey()){this.oInputManualKey.setVisible(true);this.oInputManualKey.setEnabled(true);this.oInputManualKey.setValueState(E.None);this.oInputManualKey.setValueStateText(null);this.oLabelKey.setVisible(true);}else{this.oInputManualKey.setVisible(false);this.oLabelKey.setVisible(false);}this.oSaveAsDialog.open();};
N.prototype._handleVariantSaveAs=function(e){var Q=null;var U=e.trim();var W=this.oInputManualKey.getValue().trim();if(U===""){this.oInputName.setValueState(E.Error);this.oInputName.setValueStateText(this._oRb.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));return;}if(this.getManualVariantKey()){if(W===""){this.oInputManualKey.setValueState(E.Error);this.oInputManualKey.setValueStateText(this._oRb.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));return;}Q=W;}if(this.oSaveAsDialog){this.oSaveAsDialog.close();}if(this.oDefault.getSelected()){this.setDefaultVariantKey(Q);}this.setModified(false);this.fireSave({key:Q,name:U,overwrite:false,def:this.oDefault.getSelected(),execute:this.oExecuteOnSelect.getSelected()});};
N.prototype._handleVariantSave=function(){var e=this._getItemByKey(this.getCurrentVariantKey());var Q=false;if(this.getDefaultVariantKey()===e.key){Q=true;}if(this.oVariantPopOver){this.oVariantPopOver.close();}this.fireSave({name:e.title,overwrite:true,key:e.key,def:Q});this.setModified(false);};
N.prototype.openManagementDialog=function(e,Q){if(e&&this.oManagementDialog){this.oManagementDialog.destroy();this.oManagementDialog=undefined;}this._openManagementDialog(Q);};
N.prototype._triggerSearchInManageDialog=function(e,Q){if(!e){return;}var U=e.getParameters();if(!U){return;}var W=U.newValue?U.newValue:"";var X=[this._getVisibleFilter(),new F({filters:[new F({path:"title",operator:a.Contains,value1:W}),new F({path:"author",operator:a.Contains,value1:W})],and:false})];Q.getBinding("items").filter(X);this._bDeleteOccured=true;};
N.prototype.getManageDialog=function(){return this.oManagementDialog;};
N.prototype._createManagementDialog=function(){if(!this.oManagementDialog||this.oManagementDialog.bIsDestroyed){this.oManagementTable=new g(this.getId()+"-managementTable",{growing:true,columns:[new f({width:"3rem",visible:{path:"showFavorites",model:this._sModelName}}),new f({header:new T({text:this._oRb.getText("VARIANT_MANAGEMENT_NAME")}),width:"14rem"}),new f({header:new T({text:this._oRb.getText("VARIANT_MANAGEMENT_DEFAULT")}),width:"4rem",demandPopin:true,popinDisplay:z.Inline,minScreenWidth:A.Tablet,visible:{path:"/showSetAsDefault",model:N.INNER_MODEL_NAME}}),new f({header:new T({text:this._oRb.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT")}),width:"6rem",hAlign:M.Center,demandPopin:true,popinDisplay:z.Inline,minScreenWidth:"800px",visible:{path:"/showExecuteOnSelection",model:N.INNER_MODEL_NAME}}),new f({header:new T({text:this._oRb.getText("VARIANT_MANAGEMENT_AUTHOR")}),width:"8rem",demandPopin:true,popinDisplay:z.Inline,minScreenWidth:"900px"}),new f({width:"2rem",hAlign:M.Center}),new f({visible:false})]});this.oManagementSave=new k(this.getId()+"-managementsave",{text:this._oRb.getText("VARIANT_MANAGEMENT_OK"),enabled:true,type:sap.m.ButtonType.Emphasized,press:function(){this._handleManageSavePressed();}.bind(this)});this.oManagementCancel=new k(this.getId()+"-managementcancel",{text:this._oRb.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){this._resumeManagementTableBinding();this.oManagementDialog.close();this._handleManageCancelPressed();}.bind(this)});this.oManagementDialog=new m(this.getId()+"-managementdialog",{resizable:true,draggable:true,customHeader:new B(this.getId()+"-managementHeader",{contentMiddle:[new T(this.getId()+"-managementHeaderText",{text:this._oRb.getText("VARIANT_MANAGEMENT_MANAGEDIALOG")})]}),beginButton:this.oManagementSave,endButton:this.oManagementCancel,content:[this.oManagementTable],stretch:D.system.phone});this.oManagementDialog.isPopupAdaptationAllowed=function(){return false;};this._oSearchFieldOnMgmtDialog=new S();this._oSearchFieldOnMgmtDialog.attachLiveChange(function(Q){this._triggerSearchInManageDialog(Q,this.oManagementTable);}.bind(this));var e=new B(this.getId()+"-mgmHeaderSearch",{contentRight:[this._oSearchFieldOnMgmtDialog]});this.oManagementDialog.setSubHeader(e);if(this.oVariantLayout.$().closest(".sapUiSizeCompact").length>0){this.oManagementDialog.addStyleClass("sapUiSizeCompact");}this.addDependent(this.oManagementDialog);this.oManagementTable.bindAggregation("items",{path:"variants",model:this._sModelName,factory:this._templateFactoryManagementDialog.bind(this),filters:this._getVisibleFilter()});this._bDeleteOccured=false;}};
N.prototype._setFavoriteIcon=function(e,Q){if(e){e.setSrc(Q?"sap-icon://favorite":"sap-icon://unfavorite");e.setTooltip(this._oRb.getText(Q?"VARIANT_MANAGEMENT_FAV_DEL_TOOLTIP":"VARIANT_MANAGEMENT_FAV_ADD_TOOLTIP"));}};
N.prototype._templateFactoryManagementDialog=function(e,Q){var U=null;var W;var X;var Y;var Z=Q.getObject();if(!Z){return undefined;}var $=function(g1){this._checkVariantNameConstraints(g1.oSource,this.oManagementSave,g1.oSource.getBindingContext(this._sModelName).getObject().key);}.bind(this);var _=function(g1){this._handleManageTitleChanged(g1.oSource.getBindingContext(this._sModelName).getObject());}.bind(this);var a1=function(g1){if(g1.getParameters().selected===true){this._handleManageDefaultVariantChange(g1.oSource,g1.oSource.getBindingContext(this._sModelName).getObject());}}.bind(this);var b1=function(g1){this._handleManageExecuteOnSelectionChanged(g1.oSource.getBindingContext(this._sModelName).getObject());}.bind(this);var c1=function(g1){this._handleManageDeletePressed(g1.oSource.getBindingContext(this._sModelName).getObject());var h1=g1.oSource.getParent();if(h1){h1.setVisible(false);}}.bind(this);var d1=function(g1){this._handleManageFavoriteChanged(g1.oSource,g1.oSource.getBindingContext(this._sModelName).getObject());}.bind(this);if(Z.rename){Y=new n({liveChange:$,change:_,value:'{'+this._sModelName+">title}"});}else{Y=new O({title:'{'+this._sModelName+">title}"});if(U){Y.setTooltip(U);}}W=new k({icon:"sap-icon://sys-cancel",enabled:true,type:x.Transparent,press:c1,tooltip:this._oRb.getText("VARIANT_MANAGEMENT_DELETE"),visible:Z.remove});this._assignColumnInfoForDeleteButton(W);X=this.oContext.getPath();var e1=new c({src:{path:"favorite",model:this._sModelName,formatter:function(g1){return g1?"sap-icon://favorite":"sap-icon://unfavorite";}},tooltip:{path:'favorite',model:this._sModelName,formatter:function(g1){return this._oRb.getText(g1?"VARIANT_MANAGEMENT_FAV_DEL_TOOLTIP":"VARIANT_MANAGEMENT_FAV_ADD_TOOLTIP");}.bind(this)},press:d1});e1.addStyleClass("sapUiFlVarMngmtFavColor");var f1=new d({cells:[e1,Y,new R({groupName:this.getId(),select:a1,selected:{path:X+"/defaultVariant",model:this._sModelName,formatter:function(g1){return Z.key===g1;}}}),new l({select:b1,selected:'{'+this._sModelName+">executeOnSelect}"}),new T({text:'{'+this._sModelName+">author}",textAlign:"Begin"}),W,new T({text:'{'+this._sModelName+">key}"})]});return f1;};
N.prototype._openManagementDialog=function(e){this._createManagementDialog();if(this.oVariantPopOver){this.oVariantPopOver.close();}this._suspendManagementTableBinding();this._clearDeletedItems();this.oManagementSave.setEnabled(false);this._oSearchFieldOnMgmtDialog.setValue("");if(this._bDeleteOccured){this._bDeleteOccured=false;this.oManagementTable.bindAggregation("items",{path:"variants",model:this._sModelName,factory:this._templateFactoryManagementDialog.bind(this),filters:this._getVisibleFilter()});}if(e){this.oManagementDialog.addStyleClass(e);}this.oManagementDialog.open();};
N.prototype._assignColumnInfoForDeleteButton=function(e){if(!this._oInvisibleDeleteColumnName){this._oInvisibleDeleteColumnName=new I({text:this._oRb.getText("VARIANT_MANAGEMENT_ACTION_COLUMN")});this.oManagementDialog.addContent(this._oInvisibleDeleteColumnName);}if(this._oInvisibleDeleteColumnName){e.addAriaLabelledBy(this._oInvisibleDeleteColumnName);}};
N.prototype._handleManageDefaultVariantChange=function(e,Q){var U=Q.key;if(!this._anyInErrorState(this.oManagementTable)){this.oManagementSave.setEnabled(true);}if(this.getShowFavorites()&&!Q.favorite&&e){Q.favorite=true;this._setFavoriteIcon(e.getParent().getCells()[N.COLUMN_FAV_IDX],true);}this.setDefaultVariantKey(U);};
N.prototype._handleManageCancelPressed=function(){var e;var Q;this._getDeletedItems().forEach(function(U){U.visible=true;});this._getItems().forEach(function(U){U.title=U.originalTitle;U.favorite=U.originalFavorite;U.executeOnSelection=U.originalExecuteOnSelection;});e=this.getOriginalDefaultVariantKey();if(e!==this.getDefaultVariantKey()){this.setDefaultVariantKey(e);}Q=this.getModel(this._sModelName);if(Q){Q.checkUpdate();}};
N.prototype._handleManageFavoriteChanged=function(e,Q){if(!this._anyInErrorState(this.oManagementTable)){this.oManagementSave.setEnabled(true);}if((this.getDefaultVariantKey()===Q.key)&&Q.favorite){return;}Q.favorite=!Q.favorite;this._setFavoriteIcon(e,Q.favorite);};
N.prototype._getRowForKey=function(e){var Q=null;if(this.oManagementTable){this.oManagementTable.getItems().some(function(U){if(e===U.getCells()[0].getBindingContext(this._sModelName).getObject().key){Q=U;}return Q!==null;}.bind(this));}return Q;};
N.prototype._handleManageDeletePressed=function(e){var Q;var U=e.key;if(this.oManagementTable.getItems().length===1){return;}if(!this._anyInErrorState(this.oManagementTable)){this.oManagementSave.setEnabled(true);}e.visible=false;this._addDeletedItem(e);if((U===this.getDefaultVariantKey())){this.setDefaultVariantKey(this.getStandardVariantKey());if(this.getShowFavorites()){var W=this._getItemByKey(this.getStandardVariantKey());if(W&&!W.favorite){var X=this._getRowForKey(this.getStandardVariantKey());if(X){W.favorite=true;this._setFavoriteIcon(X.getCells()[N.COLUMN_FAV_IDX],true);}}}}Q=this.getModel(this._sModelName);if(Q){Q.checkUpdate();}this.oManagementCancel.focus();};
N.prototype._handleManageExecuteOnSelectionChanged=function(){if(!this._anyInErrorState(this.oManagementTable)){this.oManagementSave.setEnabled(true);}};
N.prototype._handleManageTitleChanged=function(){if(!this._anyInErrorState(this.oManagementTable)){this.oManagementSave.setEnabled(true);}};
N.prototype._handleManageSavePressed=function(){this._getDeletedItems().some(function(e){if(e.key===this.getCurrentVariantKey()){var Q=this.getStandardVariantKey();this.setModified(false);this.setCurrentVariantKey(Q);this.fireEvent("select",{key:Q});return true;}return false;}.bind(this));this.fireManage();this._resumeManagementTableBinding();this.oManagementDialog.close();};
N.prototype._resumeManagementTableBinding=function(){if(this.oManagementTable){var e=this.oManagementTable.getBinding("items");if(e){e.resume();}}};
N.prototype._suspendManagementTableBinding=function(){if(this.oManagementTable){var e=this.oManagementTable.getBinding("items");if(e){e.suspend();}}};
N.prototype._anyInErrorState=function(e){var Q;var U;var W=false;if(e){Q=e.getItems();Q.some(function(X){U=X.getCells()[N.COLUMN_NAME_IDX];if(U&&U.getValueState&&(U.getValueState()===E.Error)){W=true;}return W;});}return W;};
N.prototype._getFilters=function(e){var Q=[];if(e){Q.push(e);}Q.push(this._getVisibleFilter());if(this.getShowFavorites()){Q.push(this._getFilterFavorites());}return Q;};
N.prototype._getVisibleFilter=function(){return new F({path:"visible",operator:a.EQ,value1:true});};
N.prototype._getFilterFavorites=function(){return new F({path:"favorite",operator:a.EQ,value1:true});};
N.prototype._checkVariantNameConstraints=function(e,Q,U){if(!e){return;}var W=e.getValue();W=W.trim();if(!this._checkIsDuplicate(W,U)){if(W===""){e.setValueState(E.Error);e.setValueStateText(this._oRb.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));}else if(W.indexOf('{')>-1){e.setValueState(E.Error);e.setValueStateText(this._oRb.getText("VARIANT_MANAGEMENT_NOT_ALLOWED_CHAR",["{"]));}else if(W.length>N.MAX_NAME_LEN){e.setValueState(E.Error);e.setValueStateText(this._oRb.getText("VARIANT_MANAGEMENT_MAX_LEN",[N.MAX_NAME_LEN]));}else{e.setValueState(E.None);e.setValueStateText(null);}}else{e.setValueState(E.Error);e.setValueStateText(this._oRb.getText("VARIANT_MANAGEMENT_ERROR_DUPLICATE"));}if(Q){if(e.getValueState()===E.Error){Q.setEnabled(false);}else{Q.setEnabled(true);}}};
N.prototype._checkIsDuplicate=function(e,Q){var U=false;var W=this._getItems();var X=e.toLowerCase();W.some(function(Y){if(Y.title.toLowerCase()===X){if(Q&&(Q===Y.key)){return false;}U=true;}return U;});return U;};
N.prototype.exit=function(){var e;if(this.oVariantInvisibleText){this.oVariantInvisibleText.destroy(true);this.oVariantInvisibleText=undefined;}if(this.oDefault&&!this.oDefault._bIsBeingDestroyed){this.oDefault.destroy();}this.oDefault=undefined;if(this.oExecuteOnSelect&&!this.oExecuteOnSelect._bIsBeingDestroyed){this.oExecuteOnSelect.destroy();}this.oExecuteOnSelect=undefined;this._oRb=undefined;this.oContext=undefined;this._oVariantList=undefined;this.oVariantSelectionPage=undefined;this.oVariantLayout=undefined;this.oVariantText=undefined;this.oVariantPopoverTrigger=undefined;this._oSearchField=undefined;this._oSearchFieldOnMgmtDialog=undefined;e=this.getModel(N.INNER_MODEL_NAME);if(e){e.destroy();}};
return N;});
sap.ui.predefine('sap/ui/fl/variants/VariantModel',["sap/ui/model/json/JSONModel","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/BusyIndicator","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/Change","sap/ui/fl/changeHandler/Base","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/base/util/merge","sap/base/util/includes","sap/base/util/ObjectPath"],function(J,a,B,U,L,C,b,R,c,f,i,O){"use strict";
function _(){var v=Object.keys(this.oData);v.forEach(function(s){var p={variantManagementReference:s,currentVariantReference:this.oData[s].currentVariant||this.oData[s].defaultVariant,newVariantReference:true};var m=this.oChangePersistence.loadSwitchChangesMapForComponent(p);h(R.revertMultipleChanges.bind(null,m.changesToBeReverted,{appComponent:this.oAppComponent,modifier:a,flexController:this.oFlexController}),this,s).then(function(){delete this.oData[s];delete this.oVariantController.getChangeFileContent()[s];this._ensureStandardVariantExists(s);}.bind(this));}.bind(this));c.initialize({model:this});c.update({parameters:[],updateHashEntry:true,model:this});return this._oVariantSwitchPromise;}
function d(E,p){return h(function(P,v){var m=v.model;var s=v.vmReference;var j=false;var t=P.key;var S=P.key;return Promise.resolve().then(function(){if(O.get([s,"currentVariant"],m.oData)&&m.oData[s].currentVariant!==m.oData[s].originalCurrentVariant){S=m.oData[s].originalCurrentVariant;j=true;return m.updateCurrentVariant(s,t,m.oAppComponent,true);}}).then(function(){if(O.get([s,"modified"],m.oData)===true){var k=m.oVariantController.getVariantChanges(s,S,true);return e({changes:k,vmReference:s,vReference:S,revert:!j,model:m}).then(function(){m.oData[s].originalCurrentVariant=t;m.oData[s].modified=false;m.checkUpdate(true);});}});}.bind(null,E.getParameters(),p),p.model,p.vmReference);}
function e(p){var v=p.model._getDirtyChangesFromVariantChanges(p.changes);return Promise.resolve().then(function(){if(p.revert){return R.revertMultipleChanges(v,{appComponent:p.model.oAppComponent,modifier:a,flexController:p.model.oFlexController});}}).then(function(){v.forEach(function(o){p.model.oVariantController.removeChangeFromVariant(o,p.vmReference,p.vReference);p.model.oFlexController.deleteChange(o,p.model.oAppComponent);});});}
function g(m,v,j){m.oData[v].variantBusy=j;m.checkUpdate();}
function h(j,m,v){m._oVariantSwitchPromise=m._oVariantSwitchPromise.catch(function(){}).then(g.bind(null,m,v,true)).then(j).then(g.bind(null,m,v,false)).catch(function(E){g(m,v,false);throw E;});m.oFlexController.setVariantSwitchPromise(m._oVariantSwitchPromise);return m._oVariantSwitchPromise;}
var V=J.extend("sap.ui.fl.variants.VariantModel",{constructor:function(D,F,A,o){this.pSequentialImportCompleted=Promise.resolve();J.apply(this,arguments);this.bObserve=o;if(!F){F=sap.ui.requireSync("sap/ui/fl/FlexControllerFactory").createForControl(A);}this.oFlexController=F;this.oChangePersistence=this.oFlexController._oChangePersistence;this.oVariantController=this.oChangePersistence._oVariantController;this.oAppComponent=A;this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");this._oVariantSwitchPromise=Promise.resolve();this.oVariantController.assignResetMapListener(_.bind(this));c.initialize({model:this});if(D&&typeof D==="object"){Object.keys(D).forEach(function(k){D[k].variants.forEach(function(v){if(!D[k].currentVariant&&(v.key===D[k].defaultVariant)){D[k].currentVariant=v.key;}v.originalTitle=v.title;v.originalFavorite=v.favorite;v.originalVisible=v.visible;});D[k].originalCurrentVariant=D[k].currentVariant;D[k].originalDefaultVariant=D[k].defaultVariant;});this.setData(D);}}});
V.prototype.updateCurrentVariant=function(v,n,A,I){var s=this.oData[v].originalCurrentVariant;var p={variantManagementReference:v,currentVariantReference:s,newVariantReference:n};var S=function(p){var m=this.oChangePersistence.loadSwitchChangesMapForComponent(p);return R.revertMultipleChanges(m.changesToBeReverted,{appComponent:A||this.oAppComponent,modifier:a,flexController:this.oFlexController}).then(this.oFlexController.applyVariantChanges.bind(this.oFlexController,m.changesToBeApplied,A||this.oAppComponent)).then(function(){this.oData[v].originalCurrentVariant=n;this.oData[v].currentVariant=n;if(this.oData[v].updateVariantInURL){c.updateVariantInURL({vmReference:v,newVReference:n,model:this});this.oVariantController.updateCurrentVariantInMap(v,n);}this.checkUpdate();}.bind(this));}.bind(this,p);if(I){return S();}return h(S,this,v);};
V.prototype.getCurrentVariantReference=function(v){return this.oData[v].currentVariant;};
V.prototype.getVariantManagementReference=function(v){var s="";var I=-1;Object.keys(this.oData).some(function(k){return this.oData[k].variants.some(function(o,j){if(o.key===v){s=k;I=j;return true;}});}.bind(this));return{variantManagementReference:s,variantIndex:I};};
V.prototype.getVariant=function(v,s){return this.oVariantController.getVariant(s||this.getVariantManagementReference(v).variantManagementReference,v);};
V.prototype.getVariantProperty=function(v,p){return this.getVariant(v).content.content[p];};
V.prototype.addChange=function(o){var v=o.getVariantReference();var s=this.getVariantManagementReference(v).variantManagementReference;this.oData[s].modified=!!this.oData[s].variantsEditable;this.checkUpdate(true);return this.oVariantController.addChangeToVariant(o,s,v);};
V.prototype.removeChange=function(o){var v=o.getVariantReference();var s=this.getVariantManagementReference(v).variantManagementReference;return this.oVariantController.removeChangeFromVariant(o,s,v);};
V.prototype._getVariantTitleCount=function(n,v){var D=this.getData();return D[v].variants.reduce(function(j,o){if(n.toLowerCase()===o.title.toLowerCase()&&o.visible){j++;}return j;},0);};
V.prototype._duplicateVariant=function(p){var n=p.newVariantReference;var s=p.sourceVariantReference;var v=p.variantManagementReference;var S=this.getVariant(s);var j=this.oVariantController.getVariantChanges(v,s,true).map(function(m){return m.getDefinition();});var D={content:{},controlChanges:j,variantChanges:{}};var k=L.compareAgainstCurrentLayer(S.content.layer,!this._bDesignTimeMode?"USER":"");Object.keys(S.content).forEach(function(K){if(K==="fileName"){D.content[K]=n;}else if(K==="variantReference"){if(k===0){D.content[K]=S.content["variantReference"];}else if(k===-1){D.content[K]=s;}}else if(K==="content"){D.content[K]=JSON.parse(JSON.stringify(S.content[K]));D.content.content.title=p.title;}else{D.content[K]=S.content[K];}});D.content["layer"]=p.layer;j=D.controlChanges.slice();var o={};var l;D.controlChanges=j.reduce(function(m,q){if(L.compareAgainstCurrentLayer(q.layer,!this._bDesignTimeMode?"USER":"")===0){o=f({},q);o.variantReference=D.content.fileName;if(!o.support){o.support={};}o.support.sourceChangeFileName=q.fileName;o.packageName="$TMP";l=C.createInitialFileContent(o);m.push(new C(l));}return m;}.bind(this),[]);return D;};
V.prototype.copyVariant=function(p){var D=this._duplicateVariant(p);var v={key:D.content.fileName,layer:p.layer,title:D.content.content.title,originalTitle:D.content.content.title,favorite:true,originalFavorite:true,rename:true,change:true,remove:true,visible:true,originalVisible:true};var o=this.oFlexController.createVariant(D,p.appComponent);var j=[];[o].concat(o.getControlChanges()).forEach(function(k){j.push(this.oChangePersistence.addDirtyChange(k));}.bind(this));var I=this.oVariantController.addVariantToVariantManagement(f({},o.getDefinitionWithChanges(),{content:{content:{visible:v.visible,favorite:v.favorite}}}),p.variantManagementReference);this.oData[p.variantManagementReference].variants.splice(I,0,v);return this.updateCurrentVariant(p.variantManagementReference,o.getId(),p.appComponent,true).then(function(){return j;});};
V.prototype.removeVariant=function(p){var j=this.oChangePersistence.getDirtyChanges().filter(function(o){return(o.getVariantReference&&o.getVariantReference()===p.variant.getId())||o.getId()===p.variant.getId();});return this.updateCurrentVariant(p.variantManagementReference,p.sourceVariantReference,p.component).then(function(){var I=this.oVariantController.removeVariantFromVariantManagement(p.variant,p.variantManagementReference);this.oData[p.variantManagementReference].variants.splice(I,1);this.checkUpdate();j.forEach(function(o){this.oChangePersistence.deleteChange(o);}.bind(this));}.bind(this));};
V.prototype.collectModelChanges=function(v,l){var D=this.getData()[v];var m=D.variants;var j=[];var p={};m.forEach(function(o){if(o.originalTitle!==o.title){p={variantReference:o.key,changeType:"setTitle",title:o.title,originalTitle:o.originalTitle,layer:l};j.push(p);}if(o.originalFavorite!==o.favorite){p={variantReference:o.key,changeType:"setFavorite",favorite:o.favorite,originalFavorite:o.originalFavorite,layer:l};j.push(p);}if(!o.visible&&o.originalVisible){p={variantReference:o.key,changeType:"setVisible",visible:false,layer:l};j.push(p);}});if(D.originalDefaultVariant!==D.defaultVariant){p={variantManagementReference:v,changeType:"setDefault",defaultVariant:D.defaultVariant,originalDefaultVariant:D.originalDefaultVariant,layer:l};j.push(p);}return j;};
V.prototype.manageVariants=function(v,s,l,j){return new Promise(function(r){v.attachEventOnce("manage",{resolve:r,variantManagementReference:s,layer:l},this.fnManageClickRta,this);v.openManagementDialog(true,j);}.bind(this));};
V.prototype.setVariantProperties=function(v,p,A){var j=-1;var o;var k=null;var D=this.getData();if(p.variantReference){j=this.getVariantManagementReference(p.variantReference).variantIndex;o=D[v].variants[j];}var n={};var m={};switch(p.changeType){case"setTitle":m.title=p.title;o.title=p.title;o.originalTitle=o.title;break;case"setFavorite":m.favorite=p.favorite;o.favorite=p.favorite;o.originalFavorite=o.favorite;break;case"setVisible":m.visible=p.visible;m.createdByReset=false;o.visible=p.visible;o.originalVisible=o.visible;break;case"setDefault":m.defaultVariant=p.defaultVariant;D[v].defaultVariant=p.defaultVariant;D[v].originalDefaultVariant=D[v].defaultVariant;var H=c.getStoredHashParams({model:this});if(H){if(D[v].defaultVariant!==D[v].currentVariant&&H.indexOf(D[v].currentVariant)===-1){c.update({parameters:H.concat(D[v].currentVariant),updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this});}else if(D[v].defaultVariant===D[v].currentVariant&&H.indexOf(D[v].currentVariant)>-1){H.splice(H.indexOf(D[v].currentVariant),1);c.update({parameters:H,updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this});}}if(!A&&D[v].currentVariant!==p.defaultVariant){this.updateCurrentVariant(v,p.defaultVariant,p.appComponent);}break;default:break;}if(j>-1){var s=this.oVariantController._setVariantData(m,v,j);D[v].variants.splice(j,1);D[v].variants.splice(s,0,o);}else if(this.oVariantController._mVariantManagement[v]){this.oVariantController._mVariantManagement[v].defaultVariant=p.defaultVariant;}if(A===true){n.changeType=p.changeType;n.layer=p.layer;if(p.changeType==="setDefault"){n.fileType="ctrl_variant_management_change";n.selector=a.getSelector(v,p.appComponent);}else{if(p.changeType==="setTitle"){b.setTextInChange(n,"title",p.title,"XFLD");}n.fileType="ctrl_variant_change";n.selector=a.getSelector(p.variantReference,p.appComponent);}k=this.oFlexController.createBaseChange(n,p.appComponent);k.setContent(m);this.oVariantController._updateChangesForVariantManagementInMap(k.getDefinition(),v,true);this.oChangePersistence.addDirtyChange(k);}else{if(p.change){this.oVariantController._updateChangesForVariantManagementInMap(p.change.getDefinition(),v,false);this.oChangePersistence.deleteChange(p.change);}}this.setData(D);this.checkUpdate(true);return k;};
V.prototype._ensureStandardVariantExists=function(v){if(!this.oVariantController){throw new Error("An sap.ui.fl.variants.VariantController instance was not found.");}var D=this.getData();if(!D[v]){D[v]={currentVariant:v,originalCurrentVariant:v,defaultVariant:v,originalDefaultVariant:v,variants:[{key:v,title:this._oResourceBundle.getText("STANDARD_VARIANT_TITLE"),originalTitle:this._oResourceBundle.getText("STANDARD_VARIANT_ORIGINAL_TITLE"),favorite:true,originalFavorite:true,visible:true,originalVisible:true,author:this.oVariantController.DEFAULT_AUTHOR}]};this.setData(D);var o={changes:{variantSection:{}}};var j={defaultVariant:v,variantManagementChanges:{},variants:[{content:{fileName:v,fileType:"ctrl_variant",variantManagementReference:v,variantReference:"",support:{user:this.oVariantController.DEFAULT_AUTHOR},content:{title:this._oResourceBundle.getText("STANDARD_VARIANT_TITLE")}},controlChanges:[],variantChanges:{}}]};o.changes.variantSection[v]=j;this.oVariantController.setChangeFileContent(o,{});}};
V.prototype.setModelPropertiesForControl=function(v,D,o){var r=function(k,v,D){if((k.layer===L.getCurrentLayer(!D))&&(k.key!==v)){return true;}return false;};this.oData[v].modified=false;this.oData[v].showFavorites=true;var j=this._bDesignTimeMode;if(j!==D){this._bDesignTimeMode=D;if(D){c.clearAllVariantURLParameters({model:this});}else if(j){c.update({parameters:c.getStoredHashParams({model:this}),updateURL:true,updateHashEntry:false,model:this});}}if(!(typeof this.fnManageClick==="function"&&typeof this.fnManageClickRta==="function")){this._initializeManageVariantsEvents();}o.detachManage(this.fnManageClick,this);if(D){this.oData[v].variantsEditable=false;this.oData[v].variants.forEach(function(k){k.rename=true;k.change=true;k.remove=r(k,v,D);});}else{if(this.oData[v]._isEditable){o.attachManage({variantManagementReference:v},this.fnManageClick,this);this.oData[v].variantsEditable=true;this.oData[v].variants.forEach(function(k){k.remove=r(k,v,D);if(k.layer===L.getCurrentLayer(true)){k.rename=true;k.change=true;}else{k.rename=false;k.change=false;}});}else{this.oData[v].variantsEditable=false;this.oData[v].variants.forEach(function(k){k.remove=false;k.rename=false;k.change=false;});}}};
V.prototype._initializeManageVariantsEvents=function(){this.fnManageClickRta=function(E,D){var j=this.collectModelChanges(D.variantManagementReference,D.layer);D.resolve(j);};this.fnManageClick=function(E,D){if(!this.oFlexController||!this.oVariantController){return;}var j=this.collectModelChanges(D.variantManagementReference,L.getCurrentLayer(true));j.forEach(function(o){o.appComponent=this.oAppComponent;this.setVariantProperties(D.variantManagementReference,o,true);}.bind(this));this.oChangePersistence.saveDirtyChanges();};};
V.prototype._handleSave=function(E){var v=E.getSource();var A=U.getAppComponentForControl(v);var s=this.getLocalId(v.getId(),A);return h(function(j,A,p){var S=p["def"];var k=this.getCurrentVariantReference(j);var l=this.oVariantController.getVariantChanges(j,k,true);if(p["overwrite"]){return this.oFlexController.saveSequenceOfDirtyChanges(this._getDirtyChangesFromVariantChanges(l)).then(function(r){this.checkDirtyStateForControlModels([j]);return r;}.bind(this));}var n=U.createDefaultFileName();var P={variantManagementReference:j,appComponent:A,layer:L.getCurrentLayer(true),title:p["name"],sourceVariantReference:k,newVariantReference:n};return this.copyVariant(P).then(function(m){if(S){var o={changeType:"setDefault",defaultVariant:n,originalDefaultVariant:this.oData[j].defaultVariant,appComponent:A,layer:L.getCurrentLayer(true),variantManagementReference:j};var q=this.setVariantProperties(j,o,true);m.push(q);}this.oData[j].modified=false;this.checkUpdate(true);return e({changes:l,vmReference:j,vReference:k,model:this}).then(this.oFlexController.saveSequenceOfDirtyChanges.bind(this.oFlexController,m));}.bind(this));}.bind(this,s,A,E.getParameters()),this,s);};
V.prototype.getLocalId=function(I,A){return a.getSelector(I,A).id;};
V.prototype.getVariantManagementReferenceForControl=function(v){var s=v.getId();var A=U.getAppComponentForControl(v);return(A&&A.getLocalId(s))||s;};
V.prototype.switchToDefaultForVariantManagement=function(v){if(this.oData[v].currentVariant!==this.oData[v].defaultVariant){B.show(200);this.updateCurrentVariant(v,this.oData[v].defaultVariant).then(function(){B.hide();});}};
V.prototype.switchToDefaultForVariant=function(v){Object.keys(this.oData).forEach(function(s){if(!v||this.oData[s].currentVariant===v){this.switchToDefaultForVariantManagement(s);}}.bind(this));};
V.prototype.registerToModel=function(v){var s=this.getVariantManagementReferenceForControl(v);this._ensureStandardVariantExists(s);this.oData[s]._isEditable=v.getEditable();v.attachEvent("select",{vmReference:s,model:this},d);v.attachSave(this._handleSave,this);this.setModelPropertiesForControl(s,false,v);var u=v.getUpdateVariantInURL();this.oData[s].updateVariantInURL=u;c.attachHandlers({vmReference:s,updateURL:!!u,model:this});c.handleModelContextChange({model:this,vmControl:v});};
V.prototype._getDirtyChangesFromVariantChanges=function(j){var k=j.map(function(o){return o.getDefinition().fileName;});return this.oChangePersistence.getDirtyChanges().filter(function(o){return i(k,o.getId());});};
V.prototype.checkDirtyStateForControlModels=function(v){v.forEach(function(s){var m=this.oData[s];if(m.modified===true){var j=this.getCurrentVariantReference(s);var k=this.oVariantController.getVariantChanges(s,j,true);var D=this._getDirtyChangesFromVariantChanges(k);if(D.length===0){m.modified=false;}}}.bind(this));this.checkUpdate(true);};
V.prototype.getCurrentControlVariantIds=function(){return Object.keys(this.oData||{}).reduce(function(j,v){return j.concat([this.oData[v].currentVariant]);}.bind(this),[]);};
return V;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/CompatibilityConnector',["sap/ui/fl/apply/_internal/Storage","sap/ui/fl/write/_internal/Storage","sap/ui/fl/FakeLrepConnector"],function(A,W,F){"use strict";
function _(m){return!!F.prototype[m];}
var C=function(){};
C.loadChanges=function(c,p){p=p||{};if(_("loadChanges")){return F.prototype.loadChanges(c,p);}return A.loadFlexData({reference:c.name,appVersion:c.appVersion,componentName:p.appName,cacheKey:p.cacheKey,siteId:p.siteId,appDescriptor:p.appDescriptor,draftLayer:p.draftLayer}).then(function(f){return{changes:f,loadModules:false};});};
C.loadSettings=function(){if(_("loadSettings")){return F.prototype.loadSettings();}return W.loadFeatures();};
C.create=function(f,c,i,d){if(_("create")){return F.prototype.create(f,c,i);}var a=f;if(!Array.isArray(a)){a=[f];}return W.write({layer:a[0].layer,flexObjects:a,transport:c,isLegacyVariant:i,draft:d});};
C.update=function(f,c){if(_("update")){return F.prototype.update(f,c);}return W.update({flexObject:f,layer:f.layer,transport:c});};
C.deleteChange=function(f,c){if(_("deleteChange")){return F.prototype.deleteChange(f,c);}return W.remove({flexObject:f,layer:f.layer,transport:c});};
C.getFlexInfo=function(p){if(_("getFlexInfo")){return F.prototype.getFlexInfo(p);}return W.getFlexInfo(p);};
C.resetChanges=function(p){if(_("resetChanges")){return F.prototype.resetChanges(p);}return W.reset(p);};
return C;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/SaveAs',["sap/ui/fl/descriptorRelated/api/DescriptorVariantFactory","sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory","sap/ui/fl/apply/_internal/ChangesController","sap/ui/fl/Utils","sap/ui/fl/Change","sap/base/Log","sap/base/util/includes","sap/base/util/merge"],function(D,a,C,U,b,L,i,m){"use strict";
function _(p){if(p&&p.package&&p.transport&&p.selector&&p.selector.appId){return Promise.resolve({packageName:p.package,transport:p.transport});}return Promise.resolve({packageName:"",transport:""});}
function c(A,t){if(t){if(t.transport&&t.packageName!=="$TMP"){return A.setTransportRequest(t.transport).then(A.setPackage(t.packageName));}return Promise.resolve();}return Promise.reject();}
function d(n){var I=[];n.forEach(function(o){var p=o.getDefinition();I.push(a.createNew(p.changeType,p.content,p.texts));});return Promise.all(I);}
function e(o,A){var p={reference:A.getId()};var s=U.createNamespace(p,"changes");o.setNamespace(s);o.setComponent(A.getId());if(A.getVersion()){o.setValidAppVersions({creation:A.getVersion(),from:A.getVersion()});}}
function f(A,o){var n=[];A.forEach(function(I){I.replaceHostingIdForTextKey(o.getId(),o.getReference(),I.getContent(),I.getTexts());n.push(o.addDescriptorInlineChange(I));});return Promise.all(n);}
function g(s){var o=C.getDescriptorFlexControllerInstance(s)._oChangePersistence;if(o){var n=o.getDirtyChanges();n=n.slice();return n;}return[];}
function h(s){var F=C.getFlexControllerInstance(s)._oChangePersistence;if(F){var u=F.getDirtyChanges();u=u.slice();return u;}return[];}
function j(s){var F=C.getFlexControllerInstance(s)._oChangePersistence;var o=C.getDescriptorFlexControllerInstance(s)._oChangePersistence;return F===o;}
function k(s,A,o){var n=[];if(A){g(s).forEach(function(p){if(i(a.getDescriptorChangeTypes(),p.getDefinition().changeType)){n.push(p);}else{e(p,o);}});}else{h(s).forEach(function(p){e(p,o);});n=g(s);}return n;}
function l(s){g(s).forEach(function(o){if(i(a.getDescriptorChangeTypes(),o.getChangeType())){C.getDescriptorFlexControllerInstance(s)._oChangePersistence.deleteChange(o);}});}
var S={saveAs:function(p){var A;var o;var n=false;return D.createAppVariant(p).then(function(q){A=m({},q);return _(p);}).then(function(t){return c(A,t);}).then(function(){n=j(p.selector);var q=k(p.selector,n,A);return d(q);}).then(function(q){return f(q,A);}).then(function(){return A.submit().catch(function(E){E.messageKey="MSG_SAVE_APP_VARIANT_FAILED";E.saveAsFailed=true;throw E;});}).then(function(r){o=m({},r);if(n){l(p.selector);}var F=C.getFlexControllerInstance(p.selector);var u=h(p.selector);if(u.length){return F.saveAll(true).catch(function(E){if(n){l(p.selector);}return this.deleteAppVariant({referenceAppId:p.id}).then(function(){E.messageKey="MSG_COPY_UNSAVED_CHANGES_FAILED";throw E;});}.bind(this));}return Promise.resolve();}.bind(this)).then(function(){if(!n){l(p.selector);}return o;}).catch(function(E){L.error("the app variant could not be created.",E.message||E.name);throw E;});},updateAppVariant:function(p){var A;var o;return D.loadAppVariant(p.referenceAppId,false,p.layer,p.bIsForSapDelivery).then(function(n){if(!n){throw new Error("App variant with ID: "+p.referenceAppId+"does not exist");}A=m({},n);if(p&&p.transport&&p.selector&&p.selector.appId){A.setTransportRequest(p.transport);}}).then(function(){var n=[];g(p.selector).forEach(function(q){if(i(a.getDescriptorChangeTypes(),q.getDefinition().changeType)){n.push(q);}});return d(n);}).then(function(n){return f(n,A);}).then(function(){return A.submit().catch(function(E){if(E==="cancel"){return Promise.reject("cancel");}E.messageKey="MSG_UPDATE_APP_VARIANT_FAILED";throw E;});}).then(function(r){o=m({},r);l(p.selector);return o;}).catch(function(E){if(E!=="cancel"){L.error("the app variant could not be updated.",E.message||E.name);throw E;}});},deleteAppVariant:function(p){var A;return D.loadAppVariant(p.referenceAppId,true,p.layer).catch(function(E){E.messageKey="MSG_LOAD_APP_VARIANT_FAILED";throw E;}).then(function(o){A=m({},o);}).then(function(){return A.submit().catch(function(E){if(E==="cancel"){return Promise.reject("cancel");}E.messageKey="MSG_DELETE_APP_VARIANT_FAILED";throw E;});}).catch(function(E){if(E!=="cancel"){L.error("the app variant could not be deleted.",E.message||E.name);throw E;}});}};return S;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/Storage',["sap/ui/fl/apply/_internal/StorageUtils","sap/ui/fl/write/_internal/StorageFeaturesMerger","sap/base/util/ObjectPath"],function(S,a,O){"use strict";var W="sap/ui/fl/write/_internal/connectors/";
function _(){return S.getConnectors(W,false);}
function f(l,C){var F=C.filter(function(o){return o.layers.indexOf("ALL")!==-1||o.layers.indexOf(l)!==-1;});if(F.length===1){return F[0];}if(F.length===0){throw new Error("No Connector configuration could be found to write into layer: "+l);}if(F.length>1){throw new Error("sap.ui.core.Configuration 'flexibilityServices' has a misconfiguration: Multiple Connector configurations were found to write into layer: "+l);}}
function b(C){var i=C.map(function(o){return o.writeConnectorModule.loadFeatures({url:o.url}).then(function(F){return{features:F,layers:o.layers};}).catch(S.logAndResolveDefault.bind(null,{features:{},layers:o.layers},o,"loadFeatures"));});return Promise.all(i);}
function c(p,C){p.url=C.url;return C.writeConnectorModule.versions.load(p);}
function d(p,C){p.url=C.url;return C.writeConnectorModule.versions.activateDraft(p);}
function g(l){if(!l){return Promise.reject("No layer was provided");}return _().then(f.bind(this,l));}
function e(A,p){var v;if(p.draft){v=new Promise(function(r,i){sap.ui.require(["sap/ui/fl/write/api/FeaturesAPI"],function(F){F.isVersioningEnabled(p.layer).then(function(D){if(D){r();}else{i("Draft is not supported for the given layer: "+p.layer);}});});});}else{v=Promise.resolve();}return v.then(g.bind(undefined,p.layer)).then(function(C){p.url=C.url;var o=O.get(A,C.writeConnectorModule);return o.call(C.writeConnectorModule,p);});}
var h={};
h.write=function(p){return e("write",p);};
h.remove=function(p){return e("remove",p);};
h.update=function(p){return e("update",p);};
h.reset=function(p){return e("reset",p);};
h.getFlexInfo=function(p){return e("getFlexInfo",p);};
h.loadFeatures=function(){return _().then(b).then(a.mergeResults);};
h.publish=function(p){return e("publish",p);};
h.versions={load:function(p){return _().then(f.bind(undefined,p.layer)).then(c.bind(undefined,p));},activateDraft:function(p){return _().then(f.bind(undefined,p.layer)).then(d.bind(undefined,p));}};return h;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/StorageFeaturesMerger',["sap/base/util/merge"],function(m){"use strict";var D={isKeyUser:false,isVariantSharingEnabled:false,isAtoAvailable:false,isAtoEnabled:false,draft:{},isProductiveSystem:true,isZeroDowntimeUpgradeRunning:false,system:"",client:""};
function _(r){var d={};var b=!!r.features.isVersioningEnabled;r.layers.forEach(function(l){d[l]=b;});return d;}
return{mergeResults:function(r){var R=D;r.forEach(function(o){Object.keys(o.features).forEach(function(k){if(k!=="isVersioningEnabled"){R[k]=o.features[k];}});R.draft=m(R.draft,_(o));});return R;}};});
sap.ui.predefine('sap/ui/fl/write/_internal/Versions',["sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/write/_internal/Storage"],function(C,S){"use strict";var _={};
function a(v){return v.some(function(o){return o.versionNumber===0;});}
function b(v,o){if(a(v)){v.pop();}v.push(o);return v;}
var V={};
V.getVersions=function(p){var r=p.reference;var l=p.layer;if(_[r]&&_[r][l]){return Promise.resolve(_[r][l]);}return S.versions.load(p).then(function(v){_[r]=_[r]||{};_[r][l]=v;return _[r][l];});};
V.clearInstances=function(){_={};};
V.activateDraft=function(p){var v;return V.getVersions(p).then(function(c){var d=a(c);v=c;var o=C.getChangePersistenceForComponent(p.reference);var D=o.getDirtyChanges().length>0;if(D){return o.saveDirtyChanges(false,undefined,true);}if(!d&&!D){return Promise.reject("No draft exists");}}).then(function(){return S.versions.activateDraft(p);}).then(function(o){return b(v,o);});};
return V;});
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/BackendConnector',["sap/base/util/merge","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/BackendConnector","sap/ui/fl/apply/_internal/connectors/Utils","sap/ui/fl/write/_internal/connectors/Utils","sap/base/util/restricted/_pick"],function(m,B,A,a,W,_){"use strict";
function b(p){var P={};if(p.draft){P.draft=p.draft;}var w=a.getUrl(this.ROUTES.CHANGES,p,P);delete p.fileName;var t=a.getUrl(this.ROUTES.TOKEN,p,P);var r=W.getRequestOptions(this.applyConnector,t,p.flexObjects||p.flexObject,"application/json; charset=utf-8","json");return W.sendRequest(w,p.method,r);}
function c(p){p.fileName=p.flexObject.fileName;return b.call(this,p);}
var d=m({},B,{xsrfToken:null,reset:function(p){var P=["reference","appVersion","generator"];var e=_(p,P);if(p.selectorIds){e.selector=p.selectorIds;}if(p.changeTypes){e.changeType=p.changeTypes;}delete p.reference;var r=a.getUrl(this.ROUTES.CHANGES,p,e);var t=a.getUrl(this.ROUTES.TOKEN,p);var R=W.getRequestOptions(this.applyConnector,t);return W.sendRequest(r,"DELETE",R);},write:function(p){p.method="POST";return b.call(this,p);},update:function(p){p.method="PUT";return c.call(this,p);},remove:function(p){var P={namespace:p.flexObject.namespace};p.fileName=p.flexObject.fileName;var D=a.getUrl(this.ROUTES.CHANGES,p,P);delete p.fileName;var t=a.getUrl(this.ROUTES.TOKEN,p);var r=W.getRequestOptions(this.applyConnector,t,undefined,"application/json; charset=utf-8","json");return W.sendRequest(D,"DELETE",r);},loadFeatures:function(p){if(this.applyConnector.settings){return Promise.resolve({response:this.applyConnector.settings});}var f=a.getUrl(this.ROUTES.SETTINGS,p);return a.sendRequest(f).then(function(r){return r.response;});}});d.applyConnector=A;return d;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/JsObjectConnector',["sap/base/util/merge","sap/ui/fl/apply/_internal/connectors/JsObjectConnector","sap/ui/fl/write/_internal/connectors/ObjectStorageConnector"],function(m,L,O){"use strict";var J=m({},O,{oStorage:L.oStorage});return J;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/KeyUserConnector',["sap/base/util/merge","sap/ui/fl/write/_internal/connectors/BackendConnector","sap/ui/fl/apply/_internal/connectors/KeyUserConnector","sap/ui/fl/apply/_internal/connectors/Utils","sap/ui/fl/Layer"],function(m,B,A,a,L){"use strict";var P="/flex/keyuser";var b="/v1";var K=m({},B,{layers:[L.CUSTOMER],ROUTES:{CHANGES:P+b+"/changes/",SETTINGS:P+b+"/settings",TOKEN:P+b+"/settings",VERSIONS:{GET:P+b+"/versions/",ACTIVATE:P+b+"/versions/draft/activate/"}}});K.versions={load:function(p){var v=a.getUrl(K.ROUTES.VERSIONS.GET,p);return a.sendRequest(v).then(function(r){return r.response;});},activateDraft:function(p){var v=a.getUrl(K.ROUTES.VERSIONS.ACTIVATE,p);return a.sendRequest(v,"POST").then(function(r){return r.response;});}};K.applyConnector=A;return K;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/LocalStorageConnector',["sap/base/util/merge","sap/ui/fl/write/_internal/connectors/ObjectStorageConnector"],function(m,O){"use strict";var L=m({},O,{oStorage:window.localStorage});return L;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/LrepConnector',["sap/base/util/merge","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/LrepConnector","sap/ui/fl/apply/_internal/connectors/Utils","sap/ui/fl/write/_internal/connectors/Utils","sap/ui/fl/write/_internal/transport/TransportSelection","sap/ui/fl/registry/Settings","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Change","sap/ui/core/Component","sap/ui/core/BusyIndicator","sap/base/Log","sap/m/MessageBox","sap/base/util/restricted/_pick"],function(m,B,A,a,W,T,S,L,b,C,c,d,e,M,_){"use strict";var R={FLEX_INFO:"/flex/info/",PUBLISH:"/actions/make_changes_transportable/",CHANGES:"/changes/",VARIANTS:"/variants/",SETTINGS:"/flex/settings",TOKEN:"/actions/getcsrftoken/",APPVARIANTS:"/appdescr_variants/",APPVARIANTS_OVERVIEW:"/app_variant_overview/"};var f=function(p){var r;if(p.isLegacyVariant){r=R.VARIANTS;}else if(p.isAppVariant){r=R.APPVARIANTS;}else{r=R.CHANGES;}var P=p.transport?{changelist:p.transport}:{};if(p.skipIam){P.skipIam=p.skipIam;}A._addClientAndLanguageInfo(P);if(p.flexObject&&!p.isAppVariant){p.fileName=p.flexObject.fileName;}var w=a.getUrl(r,p,P);delete p.reference;delete p.fileName;var t=a.getUrl(R.TOKEN,p);var o=W.getRequestOptions(A,t,p.flexObjects||p.flexObject,"application/json; charset=utf-8","json");return W.sendRequest(w,p.method,o);};var g=function(o){var p=o.getDefinition().layer===L.VENDOR?o.getPackage():"";return new C({fileName:o.getDefinition().fileName,fileType:o.getDefinition().fileType,packageName:p,namespace:o.getNamespace()});};var h=function(p){var t;if(p.transport){t=Promise.resolve({transport:p.transport});}else{var o=g(p.appVariant);t=new T().openTransportSelection(o);}return t.then(function(k){if(k==="cancel"){return Promise.reject("cancel");}if(k&&k.transport!==undefined){return k.transport;}return Promise.reject(new Error("Transport information could not be determined"));});};var i=function(p){if(!p.transport&&p.settings.isAtoEnabled()&&p.skipIam&&b.isCustomerDependentLayer(p.layer)){p.transport="ATO_NOTIFICATION";}};var j=m({},B,{layers:["ALL"],reset:function(p){d.show(0);var k=[];var t=Promise.resolve();if(p.layer!==L.USER){k=p.changes;t=S.getInstance().then(function(s){if(!s.isProductiveSystem()){return new T().setTransports(k,c.get(p.reference)).then(function(){k.some(function(o){if(o.getRequest()){p.changelist=o.getRequest();return true;}return false;});});}});}return t.then(function(){d.show(0);var P=["reference","layer","appVersion","changelist","generator"];var l=_(p,P);A._addClientAndLanguageInfo(l);if(p.selectorIds){l.selector=p.selectorIds;}if(p.changeTypes){l.changeType=p.changeTypes;}delete p.reference;var r=a.getUrl(R.CHANGES,p,l);var s=a.getUrl(R.TOKEN,p);var o=W.getRequestOptions(A,s);return W.sendRequest(r,"DELETE",o).then(function(n){d.hide();return Promise.resolve(n);}).catch(function(E){d.hide();return Promise.reject(E);});});},publish:function(p){var H=function(E){d.hide();var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");var s=r.getText("MSG_TRANSPORT_ERROR",E?[E.message||E]:undefined);var k=r.getText("HEADER_TRANSPORT_ERROR");e.error("transport error"+E);M.show(s,{icon:M.Icon.ERROR,title:k,styleClass:p.transportDialogSettings.styleClass});return"Error";};var t=new T();return t.openTransportSelection(null,p.transportDialogSettings.rootControl,p.transportDialogSettings.styleClass).then(function(o){if(t.checkTransportInfo(o)){d.show(0);var k={reference:p.reference,appVersion:p.appVersion,layer:p.layer};return t._prepareChangesForTransport(o,p.localChanges,p.appVariantDescriptors,k).then(function(){d.hide();});}return"Cancel";})['catch'](H);},getFlexInfo:function(p){var P=["layer","appVersion"];var k=_(p,P);A._addClientAndLanguageInfo(k);var D=a.getUrl(R.FLEX_INFO,p,k);return a.sendRequest(D).then(function(r){return r.response;});},loadFeatures:function(p){if(A.settings){return Promise.resolve(A.settings);}var P={};A._addClientAndLanguageInfo(P);var F=a.getUrl(R.SETTINGS,p,P);return a.sendRequest(F).then(function(r){return r.response;});},write:function(p){p.method="POST";return f(p);},update:function(p){if(p.flexObject.fileType==="variant"){p.isLegacyVariant=true;}p.method="PUT";return f(p);},remove:function(p){var P={namespace:p.flexObject.namespace,layer:p.flexObject.layer};if(p.transport){P.changelist=p.transport;}A._addClientAndLanguageInfo(P);p.fileName=p.flexObject.fileName;var r=p.flexObject.fileType==="variant"?R.VARIANTS:R.CHANGES;var D=a.getUrl(r,p,P);D=decodeURIComponent(D);delete p.fileName;var t=a.getUrl(R.TOKEN,p);var o=W.getRequestOptions(A,t,undefined,"application/json; charset=utf-8","json");return W.sendRequest(D,"DELETE",o);}});j.applyConnector=A;j.appVariant={getManifest:function(p){var s=p.appVarUrl;var r=W.getRequestOptions(A,undefined,undefined,"application/json; charset=utf-8","json");return W.sendRequest(s,"GET",r);},load:function(p){var s=a.getUrl(R.APPVARIANTS,p);var r=W.getRequestOptions(A,undefined,undefined,"application/json; charset=utf-8","json");return W.sendRequest(s,"GET",r);},create:function(p){i(p);p.method="POST";p.isAppVariant=true;return f(p);},assignCatalogs:function(p){var P={};P.action=p.action;delete p.action;P.assignFromAppId=p.assignFromAppId;delete p.assignFromAppId;var s=a.getUrl(R.APPVARIANTS,p,P);delete p.reference;var t=a.getUrl(R.TOKEN,p);var r=W.getRequestOptions(A,t,undefined,"application/json; charset=utf-8","json");return W.sendRequest(s,"POST",r);},unassignCatalogs:function(p){var P={};P.action=p.action;delete p.action;var s=a.getUrl(R.APPVARIANTS,p,P);delete p.reference;var t=a.getUrl(R.TOKEN,p);var r=W.getRequestOptions(A,t,undefined,"application/json; charset=utf-8","json");return W.sendRequest(s,"POST",r);},update:function(p){return h(p).then(function(t){if(t){p.transport=t;}p.method="PUT";p.isAppVariant=true;return f(p);});},remove:function(p){return h(p).then(function(t){var P={};if(t){P.changelist=t;}var D=a.getUrl(R.APPVARIANTS,p,P);delete p.reference;var s=a.getUrl(R.TOKEN,p);var r=W.getRequestOptions(A,s,undefined,"application/json; charset=utf-8","json");return W.sendRequest(D,"DELETE",r);});},list:function(p){var P={};P.layer=p.layer;P["sap.app/id"]=p.reference;delete p.layer;delete p.reference;var s=a.getUrl(R.APPVARIANTS_OVERVIEW,p,P);var r=W.getRequestOptions(A,undefined,undefined,"application/json; charset=utf-8","json");return W.sendRequest(s,"GET",r);}};return j;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/ObjectPathConnector',["sap/base/util/merge","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/ObjectPathConnector","sap/base/util/LoaderExtensions"],function(m,B,A,L){"use strict";return m({},B,{layers:[],loadFeatures:function(p){var P=A.jsonPath||p.path;if(P){return L.loadResource({dataType:"json",url:P,async:true}).then(function(f,r){r.componentClassName=f;return r.settings||{};}.bind(null,p.flexReference));}return Promise.resolve({});}});},true);
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/ObjectStorageConnector',["sap/base/util/merge","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/ObjectStorageUtils"],function(m,B,O){"use strict";
function s(p,c){var d=true;if(p.selectorIds){if(c.selector){d=p.selectorIds.indexOf(c.selector.id)>-1;}else{d=false;}}if(d&&p.changeTypes){d=p.changeTypes.indexOf(c.changeType)>-1;}return d;}
function a(f,c){if(!f.creation){var n=Date.now()+c;f.creation=new Date(n).toISOString();}return f;}
var b=m({},B,{oStorage:undefined,layers:["ALL"],write:function(p){var P=p.flexObjects.map(function(f,i){var k=O.createFlexObjectKey(f);f=a(f,++i);var F=this.oStorage._itemsStoredAsObjects?f:JSON.stringify(f);return this.oStorage.setItem(k,F);}.bind(this));return Promise.all(P).then(function(){});},update:function(p){var f=p.flexObject;var k=O.createFlexObjectKey(p.flexObject);var F=this.oStorage._itemsStoredAsObjects?f:JSON.stringify(f);var S=this.oStorage.setItem(k,F);return Promise.resolve(S);},reset:function(p){return O.forEachObjectInStorage({storage:this.oStorage,reference:p.reference,layer:p.layer},function(f){if(s(p,f.changeDefinition)){return this.oStorage.removeItem(f.key);}}.bind(this));},remove:function(p){var k=O.createFlexObjectKey(p.flexObject);this.oStorage.removeItem(k);var r=this.oStorage.removeItem(k);return Promise.resolve(r);},loadFeatures:function(){return Promise.resolve({isKeyUser:true,isVariantSharingEnabled:true});},getFlexInfo:function(p){p.storage=this.oStorage;return O.getAllFlexObjects(p).then(function(f){return{isResetEnabled:f.length>0};});}});return b;});
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/PersonalizationConnector',["sap/base/util/merge","sap/ui/fl/write/_internal/connectors/BackendConnector","sap/ui/fl/apply/_internal/connectors/PersonalizationConnector","sap/ui/fl/Layer"],function(m,B,A,L){"use strict";var P="/flex/personalization";var a="/v1";var F={isProductiveSystem:true};var b=m({},B,{layers:[L.USER],ROUTES:{CHANGES:P+a+"/changes/",TOKEN:P+a+"/actions/getcsrftoken"},loadFeatures:function(){return Promise.resolve(F);}});b.applyConnector=A;return b;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/SessionStorageConnector',["sap/base/util/merge","sap/ui/fl/write/_internal/connectors/ObjectStorageConnector"],function(m,O){"use strict";var S=m({},O,{oStorage:window.sessionStorage});return S;});
sap.ui.predefine('sap/ui/fl/write/_internal/connectors/Utils',["sap/ui/fl/apply/_internal/connectors/Utils"],function(A){"use strict";
function u(p){return A.sendRequest(p.tokenUrl,"HEAD").then(function(r){if(r&&r.xsrfToken){p.applyConnector.xsrfToken=r.xsrfToken;p.xsrfToken=r.xsrfToken;return p;}});}
function a(p,U,m){return u(p).then(A.sendRequest.bind(undefined,U,m));}
function b(s,t,k){if(!t[k]){t[k]=s[k];return;}if(Array.isArray(t[k])){t[k]=t[k].concat(s[k]);return;}if(typeof t[k]==='object'){Object.keys(s[k]).forEach(function(i){b(s[k],t[k],i);});}t[k]=s[k];}
return{getRequestOptions:function(o,t,f,c,d){var O={xsrfToken:o.xsrfToken,tokenUrl:t,applyConnector:o};if(f){O.payload=JSON.stringify(f);}if(c){O.contentType=c;}if(d){O.dataType=d;}return O;},sendRequest:function(U,m,p){if(!p.applyConnector||(!p.applyConnector.xsrfToken&&!(m==='GET')&&!(m==='HEAD'))){return a(p,U,m);}return A.sendRequest(U,m,p).then(function(r){return r;}).catch(function(f){if(f.status===403){return a(p,U,m);}throw f;});},mergeResults:function(r){var R={};r.forEach(function(o){Object.keys(o).forEach(function(k){b(o,R,k);});});return R;}};});
sap.ui.predefine('sap/ui/fl/write/api/AppVariantWriteAPI',["sap/ui/fl/apply/_internal/ChangesController","sap/ui/fl/write/_internal/SaveAs","sap/ui/fl/write/_internal/connectors/LrepConnector"],function(C,S,L){"use strict";var _=function(f,p){if(!p.layer){return Promise.reject("Layer must be provided");}var F=C.getDescriptorFlexControllerInstance(p.selector);p.reference=F.getComponentName();p.url="/sap/bc/lrep";return L.appVariant[f](p);};var A={saveAs:function(p){if(!p.layer){return Promise.reject("Layer must be provided");}var f=C.getDescriptorFlexControllerInstance(p.selector);p.reference=f.getComponentName();return S.saveAs(p);},deleteAppVariant:function(p){if(!p.layer){return Promise.reject("Layer must be provided");}var f=C.getDescriptorFlexControllerInstance(p.selector);p.referenceAppId=f.getComponentName();return S.deleteAppVariant(p);},listAllAppVariants:function(p){return _("list",p);},getManifest:function(p){if(!p.layer){return Promise.reject("Layer must be provided");}return L.appVariant.getManifest(p);},assignCatalogs:function(p){return _("assignCatalogs",p);},unassignCatalogs:function(p){return _("unassignCatalogs",p);}};return A;},true);
sap.ui.predefine('sap/ui/fl/write/api/ChangesWriteAPI',["sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/ChangesController","sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory","sap/ui/fl/descriptorRelated/api/DescriptorChangeFactory","sap/base/Log","sap/ui/core/Component","sap/ui/core/Element","sap/ui/core/util/reflection/JsControlTreeModifier","sap/base/util/includes","sap/base/util/restricted/_omit"],function(A,R,C,D,a,L,b,E,J,i,_){"use strict";var c={create:function(p){var f;if(i(D.getDescriptorChangeTypes(),p.changeSpecificData.changeType)){f=C.getDescriptorFlexControllerInstance(p.selector);var r=f.getComponentName();var l;if(p.changeSpecificData.layer){l=p.changeSpecificData.layer;delete p.changeSpecificData.layer;}return D.createDescriptorInlineChange(p.changeSpecificData.changeType,p.changeSpecificData.content,p.changeSpecificData.texts).then(function(o){return new a().createNew(r,o,l,p.selector);}).catch(function(e){L.error("the change could not be created.",e.message);throw e;});}f=C.getFlexControllerInstance(p.selector);if(p.selector instanceof b){return f.createBaseChange(p.changeSpecificData,p.selector);}return f.createChange(p.changeSpecificData,p.selector);},apply:function(p){var f=C.getFlexControllerInstance(p.element);p.appComponent=C.getAppComponentForSelector(p.element);if(!p.modifier){p.modifier=J;}var d=f.checkForOpenDependenciesForControl(p.change.getSelector(),p.modifier,p.appComponent);if(!d&&p.element instanceof E){return A.applyChangeOnControl(p.change,p.element,_(p,["element","change"]));}return Promise.reject(new Error("The following Change cannot be applied because of a dependency: "+p.change.getId()));},revert:function(p){var o;if(p.element instanceof E){o=C.getAppComponentForSelector(p.element);}var r={modifier:J,appComponent:o};return R.revertChangeOnControl(p.change,p.element,r);}};return c;},true);
sap.ui.predefine('sap/ui/fl/write/api/ControlPersonalizationWriteAPI',["sap/ui/fl/ControlPersonalizationAPI","sap/ui/fl/Utils"],function(O,U){"use strict";var C={add:function(p){p.changes.forEach(function(P){P.selectorControl=P.selectorElement;});p.controlChanges=p.changes;return O.addPersonalizationChanges(p);},reset:function(p){p.selectors=p.selectors||[];return O.resetChanges(p.selectors,p.changeTypes);},save:function(p){var a=p.selector.appComponent||U.getAppComponentForControl(p.selector);return O.saveChanges(p.changes,a);},buildSelectorFromElementIdAndType:function(p){var a=U.getAppComponentForControl(p.element);if(!a||!p.elementId||!p.elementType){throw new Error("Not enough information given to build selector.");}return{elementId:p.elementId,elementType:p.elementType,appComponent:a,id:p.elementId,controlType:p.elementType};}};return C;},true);
sap.ui.predefine('sap/ui/fl/write/api/FeaturesAPI',["sap/ui/fl/registry/Settings"],function(S){"use strict";var F={isPublishAvailable:function(){return S.getInstance().then(function(s){return!s.isProductiveSystem();});},isKeyUser:function(){return S.getInstance().then(function(s){return s.isKeyUser();});},isVersioningEnabled:function(l){return S.getInstance().then(function(s){return s.isVersioningEnabled(l);});}};return F;});
sap.ui.predefine('sap/ui/fl/write/api/PersistenceWriteAPI',["sap/base/util/includes","sap/base/util/restricted/_omit","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/ChangesController","sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory","sap/ui/fl/write/api/FeaturesAPI","sap/ui/fl/write/_internal/SaveAs","sap/base/Log"],function(i,_,J,F,C,D,a,S,L){"use strict";
function b(o){return(o._getMap&&i(D.getDescriptorChangeTypes(),o._getMap().changeType))||(o.getChangeType&&i(D.getDescriptorChangeTypes(),o.getChangeType()));}
function h(p){p.includeCtrlVariants=true;p.invalidateCache=false;return P._getUIChanges(p).then(function(d){return d.length>0;});}
function c(p){p.includeCtrlVariants=true;p.invalidateCache=false;return P._getUIChanges(p).then(function(d){return d.some(function(o){return o.packageName==="$TMP"||o.packageName==="";});});}
var P={hasHigherLayerChanges:function(p){return C.getFlexControllerInstance(p.selector).hasHigherLayerChanges(_(p,"selector"));},save:function(p){var f=C.getFlexControllerInstance(p.selector);var d=C.getDescriptorFlexControllerInstance(p.selector);if(p.selector.appId){if(!p.layer){return Promise.reject("Layer must be provided");}if(p.isForSAPDelivery&&p.layer==='CUSTOMER'){return Promise.reject("Layer provided is not compatible");}p.referenceAppId=d.getComponentName();return S.updateAppVariant(p);}p.invalidateCache=true;p.componentId=C.getAppComponentForSelector(p.selector).getId();return f.saveAll(p.skipUpdateCache,p.draft).then(d.saveAll.bind(d,p.skipUpdateCache,p.draft)).then(P._getUIChanges.bind(null,_(p,"skipUpdateCache")));},getResetAndPublishInfo:function(p){return Promise.all([h(p),c(p),a.isPublishAvailable()]).then(function(r){var f={isResetEnabled:r[0],isPublishEnabled:r[1]};var d=r[2];var I=!f.isResetEnabled||(d&&!f.isPublishEnabled);if(I){return C.getFlexControllerInstance(p.selector).getResetAndPublishInfo(p).then(function(R){f.isResetEnabled=f.isResetEnabled||R.isResetEnabled;f.isPublishEnabled=f.isPublishEnabled||R.isPublishEnabled;return f;}).catch(function(e){L.error("Sending request to flex/info route failed: "+e.message);return f;});}return f;});},reset:function(p){var A=C.getAppComponentForSelector(p.selector);var f=C.getFlexControllerInstance(A);var d=[p.layer,p.generator,A,p.selectorIds,p.changeTypes];return f.resetChanges.apply(f,d);},publish:function(p){p.styleClass=p.styleClass||"";var A=C.getAppComponentForSelector(p.selector);return C.getFlexControllerInstance(A)._oChangePersistence.transportAllUIChanges({},p.styleClass,p.layer,p.appVariantDescriptors);},add:function(p){if(b(p.change)){return p.change.store();}var A=C.getAppComponentForSelector(p.selector);return C.getFlexControllerInstance(A).addPreparedChange(p.change,A);},remove:function(p){if(!p.selector){throw new Error("An invalid selector was passed so change could not be removed with id: "+p.change.getId());}var A=C.getAppComponentForSelector(p.selector);if(!A){throw new Error("Invalid application component for selector, change could not be removed with id: "+p.change.getId());}if(b(p.change)){var d=C.getDescriptorFlexControllerInstance(A);d.deleteChange(p.change,A);return;}var e=J.bySelector(p.change.getSelector(),A);var f=C.getFlexControllerInstance(A);if(e){F.destroyAppliedCustomData(e,p.change,J);}f.deleteChange(p.change,A);},_getUIChanges:function(p){if(p.layer){p.currentLayer=p.layer;}return C.getFlexControllerInstance(p.selector)._oChangePersistence.getChangesForComponent(_(p,["invalidateCache","selector"]),p.invalidateCache);}};return P;},true);
sap.ui.predefine('sap/ui/fl/write/api/SmartVariantManagementWriteAPI',["sap/ui/fl/DefaultVariant","sap/ui/fl/StandardVariant","sap/ui/fl/apply/api/SmartVariantManagementApplyAPI","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/write/_internal/transport/TransportSelection"],function(D,S,a,C,T){"use strict";var b={add:function(p){var s=a._getStableId(p.control);var c=C.getChangePersistenceForControl(p.control);return c.addChangeForVariant(a._PERSISTENCY_KEY,s,p.changeSpecificData);},save:function(p){var s=a._getStableId(p.control);var c=C.getChangePersistenceForControl(p.control);return c.saveAllChangesForVariant(s);},setDefaultVariantId:function(p){var P;var c;var s=a._getStableId(p.control);var m={};m[a._PERSISTENCY_KEY]=s;var o=C.getChangePersistenceForControl(p.control);P={defaultVariantId:p.defaultVariantId,reference:o.getComponentName(),selector:m,validAppVersions:{creation:o._mComponent.appVersion,from:o._mComponent.appVersion}};var d=a._getChangeMap(p.control);c=D.updateDefaultVariantId(d,p.defaultVariantId);if(c){return c;}c=D.createChangeObject(P);var e=c.getId();d[e]=c;return c;},setExecuteOnSelect:function(p){var P;var c;var s=a._getStableId(p.control);var m={};m[a._PERSISTENCY_KEY]=s;var o=C.getChangePersistenceForControl(p.control);P={executeOnSelect:p.executeOnSelect,reference:o.getComponentName(),selector:m};var d=a._getChangeMap(p.control);c=S.updateExecuteOnSelect(d,p.executeOnSelect);if(c){return c;}c=S.createChangeObject(P);var e=c.getId();d[e]=c;return c;},_getTransportSelection:function(){return new T();}};return b;},true);
sap.ui.predefine('sap/ui/fl/write/api/UI2PersonalizationWriteAPI',["sap/ui/fl/apply/_internal/ChangesController","sap/ui/fl/Cache"],function(C,a){"use strict";var U={create:function(p){var f=C.getDescriptorFlexControllerInstance(p.selector);p.reference=f.getComponentName();if(!p.reference||!p.containerKey||!p.itemName||!p.content){return Promise.reject(new Error("not all mandatory properties were provided for the storage of the personalization"));}return a.setPersonalization({reference:p.reference,containerKey:p.containerKey,itemName:p.itemName,content:p.content});},deletePersonalization:function(p){var f=C.getDescriptorFlexControllerInstance(p.selector);p.reference=f.getComponentName();if(!p.reference||!p.containerKey||!p.itemName){return Promise.reject(new Error("not all mandatory properties were provided for the deletion of the personalization"));}return a.deletePersonalization(p.reference,p.containerKey,p.itemName);}};return U;},true);
sap.ui.predefine('sap/ui/fl/write/api/VersionsAPI',["sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/write/_internal/Versions","sap/ui/fl/Utils"],function(F,V,U){"use strict";var a={};
a.isDraftAvailable=function(p){return a.getVersions(p).then(function(v){var d=v.find(function(o){return o.versionNumber===0;});return!!d;});};
a.getVersions=function(p){if(!p.selector){return Promise.reject("No selector was provided");}if(!p.layer){return Promise.reject("No layer was provided");}var A=U.getAppComponentForControl(p.selector);var r=U.getComponentClassName(A);if(!r){return Promise.reject("The application ID could not be determined");}return V.getVersions({reference:r,layer:p.layer});};
a.activateDraft=function(p){if(!p.selector){return Promise.reject("No selector was provided");}if(!p.layer){return Promise.reject("No layer was provided");}var A=U.getAppComponentForControl(p.selector);var r=U.getComponentClassName(A);if(!r){return Promise.reject("The application ID could not be determined");}return V.activateDraft({reference:r,layer:p.layer});};
a.loadDraftForApplication=function(p){if(!p.selector){return Promise.reject("No selector was provided");}if(!p.layer){return Promise.reject("No layer was provided");}var A=U.getAppComponentForControl(p.selector);var r=U.getComponentClassName(A);if(!r){return Promise.reject("The application ID could not be determined");}F.clearState(r);return F.initialize({componentId:r,draftLayer:p.layer});};
return a;});
sap.ui.predefine('sap/ui/fl/write/connectors/BaseConnector',[],function(){"use strict";var B={layers:[],write:function(){return Promise.reject("write is not implemented");},update:function(){return Promise.reject("write is not implemented");},remove:function(){return Promise.reject("remove is not implemented");},reset:function(){return Promise.reject("reset is not implemented");},publish:function(){return Promise.reject("publish is not implemented");},getFlexInfo:function(){return Promise.resolve({});},loadFeatures:function(){return Promise.reject("loadFeatures is not implemented");},versions:{load:function(){return Promise.reject("versions.load is not implemented");},activateDraft:function(){return Promise.reject("versions.activateDraft is not implemented");}}};return B;},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine('sap/ui/fl/Cache',["sap/ui/fl/LrepConnector","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/Utils","sap/base/Log"],function(L,F,U,a){"use strict";var C=function(){};
function _(s){return F.getFlexObjectsFromStorageResponse(s).changes;}
function b(s,d){if(!d){return s;}return s===C.NOTAG?s.replace(/>$/,''.concat('-',d,'>')):s.concat('-',d);}
function c(s){return s.replace(/(^W\/|")/g,'');}
C.NOTAG="<NoTag>";
C.clearEntries=function(){F.clearState();};
C.getChangesFillingCache=function(m,p,i){var P=Promise.resolve();if(i){P=F.clearAndInitialize(p);}return P.then(function(){return F.getStorageResponse(m.name);}).catch(function(){return{};});};
C.getCacheKey=function(m,A){if(!m||!m.name||!A){a.warning("Not all parameters were passed to determine a flexibility cache key.");return Promise.resolve(C.NOTAG);}return this.getChangesFillingCache(m).then(function(w){if(w&&w.etag){return c(w.etag);}return C.NOTAG;}).then(function(s){var v=A.getModel(U.VARIANT_MODEL_NAME);var d=v?v.getCurrentControlVariantIds():[];return b(s,d.join("-"));});};
C.addChange=function(o,d){var e=_(o.name);if(!e){return;}e.push(d);};
C.setVariantManagementSection=function(o,v){var f=F.getFlexObjectsFromStorageResponse(o.name);if(!f.variantSection){return;}f.variantSection=v;};
C.updateChange=function(o,d){var e=_(o.name);if(!e){return;}for(var i=0;i<e.length;i++){if(e[i].fileName===d.fileName){e.splice(i,1,d);break;}}};
C.deleteChange=function(o,d){var e=_(o.name);if(!e){return;}for(var i=0;i<e.length;i++){if(e[i].fileName===d.fileName){e.splice(i,1);break;}}};
C.removeChanges=function(o,d){var e=F.getFlexObjectsFromStorageResponse(o.name);e.changes=e.changes.filter(function(f){return d.indexOf(f.fileName)===-1;});var v=e.variantSection;Object.keys(v).forEach(function(i){v[i].variants.forEach(function(V){V.controlChanges=V.controlChanges.filter(function(f){return d.indexOf(f.getFileName())===-1;});});});};
C.getPersonalization=function(r,s,i){var m={name:r};return this.getChangesFillingCache(m).then(function(R){if(!R||!R.changes||!R.changes.ui2personalization||!R.changes.ui2personalization[s]){return i?undefined:[];}if(!i){return R.changes.ui2personalization[s]||[];}return R.changes.ui2personalization[s].filter(function(e){return e.itemName===i;})[0];});};
C.setPersonalization=function(p){if(!p||!p.reference||!p.containerKey||!p.itemName||!p.content){return Promise.reject("not all mandatory properties were provided for the storage of the personalization");}return L.createConnector().send("/sap/bc/lrep/ui2personalization/","PUT",p,{}).then(this._addPersonalizationToEntries.bind(this,p));};
C._addPersonalizationToEntries=function(p){var e=F.getFlexObjectsFromStorageResponse(p.reference);var P=e.ui2personalization;if(!P[p.containerKey]){P[p.containerKey]=[];}P[p.containerKey].push(p);};
C.deletePersonalization=function(r,s,i){if(!r||!s||!i){return Promise.reject("not all mandatory properties were provided for the storage of the personalization");}var u="/sap/bc/lrep/ui2personalization/?reference=";u+=r+"&containerkey="+s+"&itemname="+i;return L.createConnector().send(u,"DELETE",{}).then(this._removePersonalizationFromEntries.bind(this,r,s,i));};
C._removePersonalizationFromEntries=function(r,s,i){var g=C.getPersonalization(r,s);var G=C.getPersonalization(r,s,i);return Promise.all([g,G]).then(function(p){var I=p[0];var t=p[1];var n=I.indexOf(t);I.splice(n,1);});};
return C;},true);
sap.ui.predefine('sap/ui/fl/Change',["sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/registry/Settings","sap/base/Log","sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory","sap/base/util/includes"],function(q,M,U,L,S,a,D,i){"use strict";
var C=M.extend("sap.ui.fl.Change",{
constructor:function(f){M.apply(this);if(!q.isPlainObject(f)){a.error("Constructor : sap.ui.fl.Change : oFile is not defined");}this._oDefinition=f;this._sRequest='';this._bUserDependent=(f.layer==="USER");this._vRevertData=null;this._aUndoOperations=null;this.setState(C.states.NEW);this.setModuleName(f.moduleName);this.setInitialApplyState();this._oChangeProcessingPromises={};},
metadata:{properties:{state:{type:"string"},moduleName:{type:"string"},applyState:{type:"int"}}}
});
C.states={NEW:"NEW",PERSISTED:"NONE",DELETED:"DELETE",DIRTY:"UPDATE"};C.applyState={INITIAL:0,APPLYING:1,APPLY_FINISHED:2,REVERTING:3,REVERT_FINISHED:4};C.operations={APPLY:0,REVERT:1};
C.prototype.setState=function(s){if(this._isValidState(s)){this.setProperty("state",s);}return this;};
C.prototype.setQueuedForRevert=function(){this._aQueuedProcesses.unshift(C.operations.REVERT);};
C.prototype.isQueuedForRevert=function(){return this._aQueuedProcesses.indexOf(C.operations.REVERT)>-1;};
C.prototype.setQueuedForApply=function(){this._aQueuedProcesses.unshift(C.operations.APPLY);};
C.prototype.isQueuedForApply=function(){return this._aQueuedProcesses.indexOf(C.operations.APPLY)>-1;};
C.prototype.setInitialApplyState=function(){this._aQueuedProcesses=[];this.setApplyState(C.applyState.INITIAL);};
C.prototype.startApplying=function(){this.setApplyState(C.applyState.APPLYING);};
C.prototype.markFinished=function(r){this._aQueuedProcesses.pop();this._resolveChangeProcessingPromiseWithError(C.operations.APPLY,r);this.setApplyState(C.applyState.APPLY_FINISHED);};
C.prototype.startReverting=function(){this.setApplyState(C.applyState.REVERTING);};
C.prototype.markRevertFinished=function(r){this._aQueuedProcesses.pop();this._resolveChangeProcessingPromiseWithError(C.operations.REVERT,r);this.setApplyState(C.applyState.REVERT_FINISHED);};
C.prototype.hasApplyProcessStarted=function(){return this.getApplyState()===C.applyState.APPLYING;};
C.prototype.isApplyProcessFinished=function(){return this.getApplyState()===C.applyState.APPLY_FINISHED;};
C.prototype.hasRevertProcessStarted=function(){return this.getApplyState()===C.applyState.REVERTING;};
C.prototype.isRevertProcessFinished=function(){return this.getApplyState()===C.applyState.REVERT_FINISHED;};
C.prototype.isCurrentProcessFinished=function(){return this._aQueuedProcesses.length===0;};
C.prototype.addChangeProcessingPromise=function(k){if(!this._oChangeProcessingPromises[k]){this._oChangeProcessingPromises[k]={};this._oChangeProcessingPromises[k].promise=new Promise(function(r){this._oChangeProcessingPromises[k].resolveFunction={resolve:r};}.bind(this));}return this._oChangeProcessingPromises[k].promise;};
C.prototype.addChangeProcessingPromises=function(){var r=[];this._aQueuedProcesses.forEach(function(p){r.push(this.addChangeProcessingPromise(p));},this);return r;};
C.prototype.addPromiseForApplyProcessing=function(){return this.addChangeProcessingPromise(C.operations.APPLY);};
C.prototype._resolveChangeProcessingPromiseWithError=function(k,r){if(this._oChangeProcessingPromises[k]){this._oChangeProcessingPromises[k].resolveFunction.resolve(r);delete this._oChangeProcessingPromises[k];}};
C.prototype._isValidState=function(s){var b=false;Object.keys(C.states).some(function(k){if(C.states[k]===s){b=true;}return b;});if(!b){return false;}if((this.getState()===C.states.NEW)&&(s===C.states.DIRTY)){return false;}return true;};
C.prototype.isValid=function(){var I=true;if(typeof(this._oDefinition)!=="object"){I=false;}if(!this._oDefinition.fileType){I=false;}if(!this._oDefinition.fileName){I=false;}if(!this._oDefinition.changeType){I=false;}if(!this._oDefinition.layer){I=false;}if(!this._oDefinition.originalLanguage){I=false;}return I;};
C.prototype.isVariant=function(){return this._oDefinition.fileType==="variant";};
C.prototype.getChangeType=function(){if(this._oDefinition){return this._oDefinition.changeType;}};
C.prototype.getFileName=function(){if(this._oDefinition){return this._oDefinition.fileName;}};
C.prototype.getFileType=function(){if(this._oDefinition){return this._oDefinition.fileType;}};
C.prototype.getOriginalLanguage=function(){if(this._oDefinition&&this._oDefinition.originalLanguage){return this._oDefinition.originalLanguage;}return"";};
C.prototype.getContext=function(){if(this._oDefinition&&this._oDefinition.context){return this._oDefinition.context;}return"";};
C.prototype.getPackage=function(){return this._oDefinition.packageName;};
C.prototype.getNamespace=function(){return this._oDefinition.namespace;};
C.prototype.setNamespace=function(n){this._oDefinition.namespace=n;};
C.prototype.getProjectId=function(){return this._oDefinition.projectId;};
C.prototype.setProjectId=function(p){this._oDefinition.projectId=p;};
C.prototype.getId=function(){return this._oDefinition.fileName;};
C.prototype.getContent=function(){return this._oDefinition.content;};
C.prototype.setContent=function(c){this._oDefinition.content=c;this.setState(C.states.DIRTY);};
C.prototype.getVariantReference=function(){return this._oDefinition.variantReference||"";};
C.prototype.setVariantReference=function(v){this._oDefinition.variantReference=v;this.setState(C.states.DIRTY);};
C.prototype.getSelector=function(){return this._oDefinition.selector;};
C.prototype.getSourceSystem=function(){return this._oDefinition.sourceSystem;};
C.prototype.getSourceClient=function(){return this._oDefinition.sourceClient;};
C.prototype.getOwnerId=function(){return this._oDefinition.support?this._oDefinition.support.user:"";};
C.prototype.getText=function(t){if(typeof(t)!=="string"){a.error("sap.ui.fl.Change.getTexts : sTextId is not defined");}if(this._oDefinition.texts){if(this._oDefinition.texts[t]){return this._oDefinition.texts[t].value;}}return"";};
C.prototype.setText=function(t,n){if(typeof(t)!=="string"){a.error("sap.ui.fl.Change.setTexts : sTextId is not defined");return;}if(this._oDefinition.texts){if(this._oDefinition.texts[t]){this._oDefinition.texts[t].value=n;this.setState(C.states.DIRTY);}}};
C.prototype.isReadOnly=function(){return this._isReadOnlyDueToLayer()||this._isReadOnlyWhenNotKeyUser()||this.isChangeFromOtherSystem();};
C.prototype._isReadOnlyWhenNotKeyUser=function(){if(this.isUserDependent()){return false;}var r=this.getDefinition().reference;if(!r){return true;}var s=S.getInstanceOrUndef();if(!s){return true;}return!s.isKeyUser();};
C.prototype.isLabelReadOnly=function(){if(this._isReadOnlyDueToLayer()){return true;}return this._isReadOnlyDueToOriginalLanguage();};
C.prototype._isReadOnlyDueToLayer=function(){var c;c=L.getCurrentLayer(this._bUserDependent);return(this._oDefinition.layer!==c);};
C.prototype.isChangeFromOtherSystem=function(){var s=this.getSourceSystem();var b=this.getSourceClient();if(!s||!b){return false;}var o=S.getInstanceOrUndef();if(!o){return true;}var c=o.getSystem();var d=o.getClient();if(!c||!d){return false;}return(s!==c||b!==d);};
C.prototype._isReadOnlyDueToOriginalLanguage=function(){var c;var o;o=this.getOriginalLanguage();if(!o){return false;}c=U.getCurrentLanguage();return(c!==o);};
C.prototype.markForDeletion=function(){this.setState(C.states.DELETED);};
C.prototype.setRequest=function(r){if(typeof(r)!=="string"){a.error("sap.ui.fl.Change.setRequest : sRequest is not defined");}this._sRequest=r;};
C.prototype.getRequest=function(){return this._sRequest;};
C.prototype.getLayer=function(){return this._oDefinition.layer;};
C.prototype.getComponent=function(){return this._oDefinition.reference;};
C.prototype.setComponent=function(c){this._oDefinition.reference=c;};
C.prototype.setValidAppVersions=function(v){this._oDefinition.validAppVersions=v;};
C.prototype.getCreation=function(){return this._oDefinition.creation;};
C.prototype.isUserDependent=function(){return(this._bUserDependent);};
C.prototype.getPendingAction=function(){return this.getState();};
C.prototype.getDefinition=function(){return this._oDefinition;};
C.prototype.setResponse=function(r){var R=JSON.stringify(r);if(R){this._oDefinition=JSON.parse(R);this.setState(C.states.PERSISTED);}};
C.prototype.getFullFileIdentifier=function(){var l=this.getLayer();var n=this.getNamespace();var f=this.getDefinition().fileName;var F=this.getDefinition().fileType;return l+"/"+n+"/"+f+"."+F;};
C.prototype.addDependentControl=function(c,A,p,m){if(!c){throw new Error("Parameter vControl is mandatory");}if(!A){throw new Error("Parameter sAlias is mandatory");}if(!p){throw new Error("Parameter mPropertyBag is mandatory");}if(!this._oDefinition.dependentSelector){this._oDefinition.dependentSelector={};}if(this._oDefinition.dependentSelector[A]){throw new Error("Alias '"+A+"' already exists in the change.");}var o=p.modifier;var b=p.appComponent;if(Array.isArray(c)){var s=[];c.forEach(function(d){s.push(o.getSelector(d,b,m));});this._oDefinition.dependentSelector[A]=s;}else{this._oDefinition.dependentSelector[A]=o.getSelector(c,b,m);}delete this._aDependentSelectorList;};
C.prototype.getDependentControl=function(A,p){var d=[];var o;if(!A){throw new Error("Parameter sAlias is mandatory");}if(!p){throw new Error("Parameter mPropertyBag is mandatory");}var m=p.modifier;var b=p.appComponent;if(!this._oDefinition.dependentSelector){return undefined;}o=this._oDefinition.dependentSelector[A];if(Array.isArray(o)){o.forEach(function(s){d.push(m.bySelector(s,b,p.view));});return d;}return m.bySelector(o,b,p.view);};
C.prototype.getDependentSelectorList=function(){var t=this;var d=[this.getSelector()];if(!this._aDependentSelectorList){if(this._oDefinition.dependentSelector){Object.keys(this._oDefinition.dependentSelector).forEach(function(A){var c=t._oDefinition.dependentSelector[A];if(!Array.isArray(c)){c=[c];}c.forEach(function(o){if(o&&U.indexOfObject(d,o)===-1){d.push(o);}});});}this._aDependentSelectorList=d;}return this._aDependentSelectorList;};
C.prototype.getDependentControlSelectorList=function(){var d=this.getDependentSelectorList().concat();if(d.length>0){var s=this.getSelector();var I=U.indexOfObject(d,s);if(I>-1){d.splice(I,1);}}return d;};
C.prototype.getRevertData=function(){return this._vRevertData;};
C.prototype.hasRevertData=function(){return this._vRevertData!==null;};
C.prototype.setRevertData=function(d){this._vRevertData=d;};
C.prototype.resetRevertData=function(){this.setRevertData(null);};
C.prototype.getUndoOperations=function(){return this._aUndoOperations;};
C.prototype.setUndoOperations=function(d){this._aUndoOperations=d;};
C.prototype.resetUndoOperations=function(){this.setUndoOperations(null);};
C.createInitialFileContent=function(p){if(!p){p={};}var f;if(p.fileType){f=p.fileType;}else{f=p.isVariant?"variant":"change";}var n={fileName:p.id||U.createDefaultFileName(p.changeType),fileType:f,changeType:p.changeType||"",moduleName:p.moduleName||"",reference:p.reference||"",packageName:p.packageName||"",content:p.content||{},selector:p.selector||{id:""},layer:p.layer||L.getCurrentLayer(p.isUserDependent),texts:p.texts||{},namespace:p.namespace||U.createNamespace(p,"changes"),projectId:p.projectId||(p.reference&&p.reference.replace(".Component",""))||"",creation:"",originalLanguage:U.getCurrentLanguage(),conditions:{},context:p.context||"",support:{generator:p.generator||"Change.createInitialFileContent",service:p.service||"",user:"",sapui5Version:sap.ui.version,sourceChangeFileName:p.support&&p.support.sourceChangeFileName||"",compositeCommand:p.support&&p.support.compositeCommand||""},oDataInformation:p.oDataInformation||{},dependentSelector:p.dependentSelector||{},validAppVersions:p.validAppVersions||{},jsOnly:p.jsOnly||false,variantReference:p.variantReference||"",appDescriptorChange:i(D.getDescriptorChangeTypes(),p.changeType)};return n;};
return C;},true);
sap.ui.predefine('sap/ui/fl/ChangePersistence',["sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/Change","sap/ui/fl/Variant","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/write/_internal/CompatibilityConnector","sap/ui/fl/Cache","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/context/ContextManager","sap/ui/fl/write/_internal/Storage","sap/ui/fl/variants/VariantController","sap/ui/core/Component","sap/ui/model/json/JSONModel","sap/ui/thirdparty/jquery","sap/base/util/merge","sap/base/util/isEmptyObject","sap/base/Log","sap/ui/fl/apply/_internal/flexState/FlexState"],function(D,C,V,U,L,a,b,A,c,S,d,e,J,q,m,i,f,F){"use strict";var g=function(j){this._mComponent=j;this._mChanges=h();this._mChangesInitial=m({},this._mChanges);this._mVariantsChanges={};if(!this._mComponent||!this._mComponent.name){f.error("The Control does not belong to an SAPUI5 component. Personalization and changes for this control might not work as expected.");throw new Error("Missing component name.");}this._oVariantController=new d(this._mComponent.name,this._mComponent.appVersion,{});this._aDirtyChanges=[];this._oMessagebundle=undefined;this._mChangesEntries={};this._bHasChangesOverMaxLayer=false;this.HIGHER_LAYER_CHANGES_EXIST="higher_layer_changes_exist";};
function h(){return{mChanges:{},mDependencies:{},mDependentChangesOnMe:{},mControlsWithDependencies:{},aChanges:[]};}
g.prototype.getComponentName=function(){return this._mComponent.name;};
g.prototype.getCacheKey=function(o){return b.getCacheKey(this._mComponent,o);};
g.prototype._preconditionsFulfilled=function(j,I,o){var k=o instanceof C?o.getDefinition():o;if(!k.fileName){f.warning("A change without fileName is detected and excluded from component: "+this._mComponent.name);return false;}function l(){if(I){return(k.fileType==="change")||(k.fileType==="variant");}return(k.fileType==="change")&&(k.changeType!=="defaultVariant");}function n(){if(I){if((k.fileType==="variant")||(k.changeType==="defaultVariant")){return k.selector&&k.selector.persistencyKey;}}return true;}function p(){return c.doesContextMatch(k,j);}function r(){if((k.fileType==="ctrl_variant")||(k.fileType==="ctrl_variant_change")||(k.fileType==="ctrl_variant_management_change")){return k.variantManagementReference||k.variantReference||(k.selector&&k.selector.id);}}if((l()&&n()&&p())||r()){return true;}return false;};
g.prototype.getChangesForComponent=function(p,I){return b.getChangesFillingCache(this._mComponent,p,I).then(function(w){var o=m({},w);var l=p&&p.component&&U.getAppComponentForControl(p.component);var n=o.changes&&Array.isArray(o.changes.changes)&&o.changes.changes.length!==0;var v=o.changes&&o.changes.variantSection&&!i(o.changes.variantSection);if(!n&&!v){return[];}var s=l?l.getComponentData():(p&&p.componentData||{});var t=o.changes.changes;if(!this._oMessagebundle&&o.messagebundle&&l){if(!l.getModel("i18nFlexVendor")){if(t.some(function(H){return H.layer==="VENDOR";})){this._oMessagebundle=o.messagebundle;var M=new J(this._oMessagebundle);l.setModel(M,"i18nFlexVendor");}}}var u=p&&p.includeCtrlVariants;var x=p&&p.currentLayer;var y=!(p&&p.ignoreMaxLayerParameter);var z=[o.changes.variantSection];if(x){t=t.filter(this._filterChangeForCurrentLayer.bind(this,x));z.push(false,x);}else if(L.isLayerFilteringRequired()&&y){t=t.filter(this._filterChangeForMaxLayer.bind(this));z.push(true);}else if(this._bHasChangesOverMaxLayer&&!y){this._bHasChangesOverMaxLayer=false;return this.HIGHER_LAYER_CHANGES_EXIST;}if(v){if(u||z.length>1){var B=this._getAllCtrlVariantChanges.apply(this,z);t=u?t.concat(B):t;}this._oVariantController.checkAndSetVariantContent(o,s&&s.technicalParameters);}if(!u&&!i(this._oVariantController.getChangeFileContent())){t=t.concat(this._oVariantController.loadInitialChanges());}var E=p&&p.includeVariants;var G=o.changes.contexts||[];return new Promise(function(H){c.getActiveContexts(G).then(function(K){H(t.filter(this._preconditionsFulfilled.bind(this,K,E)).map(k.bind(this,o)));}.bind(this));}.bind(this));}.bind(this));function j(v,o){var l;Object.keys(v).some(function(s){return v[s].variants.some(function(n){if(n.content.fileName===o.getDefinition().variantReference){l=n;return true;}});});return l;}function r(v,o){return v.controlChanges.some(function(l,n){if(l.fileName===o.getDefinition().fileName){v.controlChanges.splice(n,1,o);return true;}});}function k(o,l){var n;if(l instanceof C){n=l;this._mChangesEntries[n.getFileName()]=n;}else{if(!this._mChangesEntries[l.fileName]){this._mChangesEntries[l.fileName]=new C(l);}n=this._mChangesEntries[l.fileName];n.setState(C.states.PERSISTED);if(n.getVariantReference()){var v=this._oVariantController.getChangeFileContent();var s=j.call(this,v,n);if(s&&r(s,n)){b.setVariantManagementSection(this._mComponent,v);}}}return n;}};
g.prototype._filterChangeForMaxLayer=function(o){if(L.isOverMaxLayer(this._getLayerFromChangeOrChangeContent(o))){if(!this._bHasChangesOverMaxLayer){this._bHasChangesOverMaxLayer=true;}return false;}return true;};
g.prototype._filterChangeForCurrentLayer=function(l,o){return l===this._getLayerFromChangeOrChangeContent(o);};
g.prototype._getLayerFromChangeOrChangeContent=function(o){var s;if(o instanceof V||o instanceof C){s=o.getLayer();}else{s=o.layer;}return s;};
g.prototype._getAllCtrlVariantChanges=function(v,j,s){var k=[];var l=function(){return true;};if(j){l=this._filterChangeForMaxLayer.bind(this);}else if(typeof s==="string"&&s!==""){l=this._filterChangeForCurrentLayer.bind(this,s);}Object.keys(v).forEach(function(n){var o=v[n];o.variants=o.variants.filter(function(p){return!p.content.layer||l(p.content);});o.variants.forEach(function(p){if(Array.isArray(p.variantChanges.setVisible)){p.variantChanges.setVisible=p.variantChanges.setVisible.filter(l);var r=p.variantChanges.setVisible.slice(-1)[0];if(r&&!r.content.visible&&r.content.createdByReset){return;}k=k.concat(p.variantChanges.setVisible);}Object.keys(p.variantChanges).forEach(function(t){if(t!=="setVisible"){p.variantChanges[t]=p.variantChanges[t].filter(l);k=p.variantChanges[t].length>0?k.concat(p.variantChanges[t].slice(-1)[0]):k;}});k=(p.content.fileName!==n)?k.concat([p.content]):k;p.controlChanges=p.controlChanges.filter(l);k=k.concat(p.controlChanges);});Object.keys(o.variantManagementChanges).forEach(function(p){o.variantManagementChanges[p]=o.variantManagementChanges[p].filter(l);k=o.variantManagementChanges[p].length>0?k.concat(o.variantManagementChanges[p].slice(-1)[0]):k;});});return k;};
g.prototype.getSmartVariantManagementChangeMap=function(){return this._mVariantsChanges;};
g.prototype.getChangesForVariant=function(s,j,p){if(this._mVariantsChanges[j]){return Promise.resolve(this._mVariantsChanges[j]);}var k=function(o){var n=false;var r=o._oDefinition.selector;q.each(r,function(t,v){if(t===s&&v===j){n=true;}});return n;};var l=function(n,t){f.error("key : "+n+" and text : "+t.value);};return this.getChangesForComponent(p).then(function(n){return n.filter(k);}).then(function(n){if(!this._mVariantsChanges[j]){this._mVariantsChanges[j]={};}var I;n.forEach(function(o){I=o.getId();if(o.isValid()){if(this._mVariantsChanges[j][I]&&o.isVariant()){f.error("Id collision - two or more variant files having the same id detected: "+I);q.each(o.getDefinition().texts,l);f.error("already exists in variant : ");q.each(this._mVariantsChanges[j][I].getDefinition().texts,l);}this._mVariantsChanges[j][I]=o;}}.bind(this));return this._mVariantsChanges[j];}.bind(this));};
g.prototype.addChangeForVariant=function(s,j,p){var o;var I;var k;var l;var n;if(!p){return undefined;}if(!p.type){f.error("sap.ui.fl.Persistence.addChange : type is not defined");}var r=q.type(p.content);if(r!=='object'&&r!=='array'){f.error("mParameters.content is not of expected type object or array, but is: "+r,"sap.ui.fl.Persistence#addChange");}k={};if(typeof(p.texts)==="object"){q.each(p.texts,function(t,u){k[t]={value:u,type:"XFLD"};});}var v={creation:this._mComponent.appVersion,from:this._mComponent.appVersion};if(this._mComponent.appVersion&&p.developerMode){v.to=this._mComponent.appVersion;}I={changeType:p.type,service:p.ODataService,texts:k,content:p.content,reference:this._mComponent.name,isVariant:p.isVariant,packageName:p.packageName,isUserDependent:p.isUserDependent,validAppVersions:v};I.selector={};I.selector[s]=j;o=C.createInitialFileContent(I);if(p.id){o.fileName=p.id;}l=new C(o);n=l.getId();if(!this._mVariantsChanges[j]){this._mVariantsChanges[j]={};}this._mVariantsChanges[j][n]=l;return l.getId();};
g.prototype.saveAllChangesForVariant=function(s){var p=[];q.each(this._mVariantsChanges[s],function(j,o){var k=o.getId();switch(o.getPendingAction()){case"NEW":p.push(a.create(o.getDefinition(),o.getRequest(),o.isVariant()).then(function(r){if(r&&r.response&&r.response[0]){o.setResponse(r.response[0]);}else{o.setState(C.states.PERSISTED);}b.addChange({name:this._mComponent.name,appVersion:this._mComponent.appVersion},o.getDefinition());return r;}.bind(this)));break;case"UPDATE":p.push(a.update(o.getDefinition(),o.getRequest()).then(function(r){if(r&&r.response){o.setResponse(r.response);}else{o.setState(C.states.PERSISTED);}b.updateChange({name:this._mComponent.name,appVersion:this._mComponent.appVersion},o.getDefinition());return r;}.bind(this)));break;case"DELETE":p.push(a.deleteChange(o.getDefinition(),o.getRequest()).then(function(r){var o=this._mVariantsChanges[s][k];if(o.getPendingAction()==="DELETE"){delete this._mVariantsChanges[s][k];}b.deleteChange({name:this._mComponent.name,appVersion:this._mComponent.appVersion},o.getDefinition());return r;}.bind(this)));break;default:break;}}.bind(this));return Promise.all(p);};
function _(s,o){return s.idIsLocal?o.createId(s.id):s.id;}
g.prototype.loadChangesMapForComponent=function(o){return this.getChangesForComponent({component:o}).then(j.bind(this));function j(k){this._mChanges=h();k.forEach(this._addChangeAndUpdateDependencies.bind(this,o));this._mChangesInitial=m({},this._mChanges);return this.getChangesMapForComponent.bind(this);}};
g.prototype.checkForOpenDependenciesForControl=function(s,M,o){return Object.keys(this._mChanges.mDependencies).some(function(k){return this._mChanges.mDependencies[k].changeObject.getDependentSelectorList().some(function(j){return j===M.getControlIdBySelector(s,o);});},this);};
g.prototype.copyDependenciesFromInitialChangesMap=function(o,j,k){var I=m({},this._mChangesInitial.mDependencies);var l=I[o.getId()];if(l){var n=[];l.dependencies.forEach(function(s){if(j(s)){this._mChanges.mDependentChangesOnMe[s]=this._mChanges.mDependentChangesOnMe[s]||[];this._mChanges.mDependentChangesOnMe[s].push(o.getId());n.push(s);}}.bind(this));o.getDependentControlSelectorList().forEach(function(s){this._mChanges.mControlsWithDependencies[_(s,k)]=true;}.bind(this));l.dependencies=n;this._mChanges.mDependencies[o.getId()]=l;}return this._mChanges;};
g.prototype._addChangeAndUpdateDependencies=function(o,j){j.setInitialApplyState();D.addChangeAndUpdateDependencies(j,o,this._mChanges);};
g.prototype._addRunTimeCreatedChangeAndUpdateDependencies=function(o,j){D.addRuntimeChangeAndUpdateDependencies(j,o,this._mChanges,this._mChangesInitial);};
g.prototype.getChangesMapForComponent=function(){return this._mChanges;};
g.prototype.getChangesForView=function(v,p){return this.getChangesForComponent(p).then(function(k){return k.filter(j.bind(this));}.bind(this));function j(o){var s=o.getSelector();if(!s){return false;}var k=s.id;if(!k||!p){return false;}var l=k.slice(0,k.lastIndexOf("--"));var v;if(o.getSelector().idIsLocal){var n=p.appComponent;if(n){v=n.getLocalId(p.viewId);}}else{v=p.viewId;}return l===v;}};
g.prototype.addChange=function(v,o){var j=this.addDirtyChange(v);this._addRunTimeCreatedChangeAndUpdateDependencies(o,j);this._addPropagationListener(o);return j;};
g.prototype.addDirtyChange=function(v){var n;if(v instanceof C||v instanceof V){n=v;}else{n=new C(v);}if(this._aDirtyChanges.indexOf(n)===-1){this._aDirtyChanges.push(n);}return n;};
g.prototype._addPropagationListener=function(o){var j=U.getAppComponentForControl(o);if(j instanceof e){var k=function(P){return!P._bIsSapUiFlFlexControllerApplyChangesOnControl;};var n=j.getPropagationListeners().every(k);if(n){var M=j.getManifestObject();var v=U.getAppVersionFromManifest(M);var l=sap.ui.require("sap/ui/fl/FlexControllerFactory");var p=l.create(this.getComponentName(),v);var P=A.applyAllChangesForControl.bind(A,this.getChangesMapForComponent.bind(this),j,p);P._bIsSapUiFlFlexControllerApplyChangesOnControl=true;j.addPropagationListener(P);}}};
g.prototype.saveDirtyChanges=function(s,j,k){var l=j||this._aDirtyChanges;var n=l.slice(0);var r=this._getRequests(l);var p=this._getPendingActions(l);if(p.length===1&&r.length===1&&p[0]==="NEW"){var R=r[0];var P=this._prepareDirtyChanges(l);return a.create(P,R,undefined,k).then(function(o){this._massUpdateCacheAndDirtyState(l,n,s);return o;}.bind(this));}return this.saveSequenceOfDirtyChanges(n,s,k);};
g.prototype.saveSequenceOfDirtyChanges=function(j,s,k){var l=this.getDirtyChanges();return j.reduce(function(p,o){return p.then(this._performSingleSaveAction(o,k)).then(this._updateCacheAndDirtyState.bind(this,l,o,s));}.bind(this),Promise.resolve());};
g.prototype._performSingleSaveAction=function(o,j){return function(){if(o.getPendingAction()==="NEW"){return a.create(o.getDefinition(),o.getRequest(),undefined,j);}if(o.getPendingAction()==="DELETE"){return a.deleteChange(o.getDefinition(),o.getRequest());}};};
g.prototype._updateCacheAndDirtyState=function(j,o,s){if(!s){if(o.getPendingAction()==="NEW"){U.isChangeRelatedToVariants(o)?b.setVariantManagementSection(this._mComponent,m({},this._oVariantController.getChangeFileContent())):b.addChange(this._mComponent,o.getDefinition());}else if(o.getPendingAction()==="DELETE"){U.isChangeRelatedToVariants(o)?b.setVariantManagementSection(this._mComponent,m({},this._oVariantController.getChangeFileContent())):b.deleteChange(this._mComponent,o.getDefinition());}}var I=j.indexOf(o);if(I>-1){j.splice(I,1);}};
g.prototype._massUpdateCacheAndDirtyState=function(j,k,s){k.forEach(function(o){this._updateCacheAndDirtyState(j,o,s);},this);};
g.prototype._getRequests=function(j){var r=[];j.forEach(function(o){var R=o.getRequest();if(r.indexOf(R)===-1){r.push(R);}});return r;};
g.prototype._getPendingActions=function(j){var p=[];j.forEach(function(o){var P=o.getPendingAction();if(p.indexOf(P)===-1){p.push(P);}});return p;};
g.prototype._prepareDirtyChanges=function(j){var k=[];j.forEach(function(o){k.push(o.getDefinition());});return k;};
g.prototype.getDirtyChanges=function(){return this._aDirtyChanges;};
g.prototype.deleteChange=function(o,r){var n=this._aDirtyChanges.indexOf(o);if(n>-1){if(o.getPendingAction()==="DELETE"){return;}this._aDirtyChanges.splice(n,1);this._deleteChangeInMap(o,r);return;}o.markForDeletion();this.addDirtyChange(o);this._deleteChangeInMap(o,r);};
g.prototype._deleteChangeInMap=function(o,r){var s=o.getId();var j=this._mChanges.mChanges;var M=r?this._mChangesInitial:this._mChanges;var k=M.mDependencies;var l=M.mDependentChangesOnMe;Object.keys(j).some(function(n){var p=j[n];var t=p.map(function(E){return E.getId();}).indexOf(o.getId());if(t!==-1){p.splice(t,1);return true;}});Object.keys(k).forEach(function(n){if(n===s){delete k[n];}else if(k[n].dependencies&&Array.isArray(k[n].dependencies)&&k[n].dependencies.indexOf(s)!==-1){k[n].dependencies.splice(k[n].dependencies.indexOf(s),1);if(k[n].dependencies.length===0){delete k[n];}}});Object.keys(l).forEach(function(n){if(n===s){delete l[n];}else if(Array.isArray(l[n])&&l[n].indexOf(s)!==-1){l[n].splice(l[n].indexOf(s),1);if(l[n].length===0){delete l[n];}}});var I=this._mChanges.aChanges.indexOf(o);if(I!==-1){this._mChanges.aChanges.splice(I,1);}};
g.prototype.loadSwitchChangesMapForComponent=function(p){p.changesMap=this._mChanges.mChanges;return this._oVariantController.getChangesForVariantSwitch(p);};
g.prototype.transportAllUIChanges=function(r,s,l,j){return this.getChangesForComponent({currentLayer:l,includeCtrlVariants:true}).then(function(k){return S.publish({transportDialogSettings:{rootControl:r,styleClass:s},layer:l,reference:this.getComponentName(),appVersion:this._mComponent.appVersion,localChanges:k,appVariantDescriptors:j});}.bind(this));};
g.prototype._getChangesFromMapByNames=function(n){return this._mChanges.aChanges.filter(function(o){return n.indexOf(o.getFileName())!==-1;});};
g.prototype.resetChanges=function(l,G,s,j){var k=s&&s.length>0;var n=j&&j.length>0;if(!G&&!k&&!n){f.error("Of the generator, selector IDs and change types parameters at least one has to filled");return Promise.reject("Of the generator, selector IDs and change types parameters at least one has to filled");}return this.getChangesForComponent({currentLayer:l,includeCtrlVariants:true}).then(function(o){var p={reference:this.getComponentName(),appVersion:this._mComponent.appVersion,layer:l,changes:o};if(G){p.generator=G;}if(k){p.selectorIds=s;}if(n){p.changeTypes=j;}return a.resetChanges(p);}.bind(this)).then(function(r){var o=[];if(s||j){var N=[];if(r&&r.response&&r.response.length>0){r.response.forEach(function(p){N.push(p.name);});}b.removeChanges(this._mComponent,N);o=this._getChangesFromMapByNames(N);}return o;}.bind(this));};
g.prototype.resetVariantMap=function(r){F.clearPreparedMaps(this._mComponent.name);return this._oVariantController.resetMap(r);};
g.prototype.getResetAndPublishInfo=function(p){return a.getFlexInfo(p);};
return g;},true);
sap.ui.predefine('sap/ui/fl/ChangePersistenceFactory',["sap/ui/core/Component","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/ChangePersistence","sap/ui/fl/Utils"],function(C,F,a,U){"use strict";var b={};b._instanceCache={};
b.getChangePersistenceForComponent=function(c,A){var o;A=A||U.DEFAULT_APP_VERSION;if(!b._instanceCache[c]){b._instanceCache[c]={};}o=b._instanceCache[c][A];if(!o){var d={name:c,appVersion:A};o=new a(d);b._instanceCache[c][A]=o;}return o;};
b.getChangePersistenceForControl=function(c){var s;s=U.getComponentClassName(c);var A=U.getAppVersionFromManifest(U.getAppComponentForControl(c).getManifest());return b.getChangePersistenceForComponent(s,A);};
b.registerLoadComponentEventHandler=function(){C._fnLoadComponentCallback=this._onLoadComponent.bind(this);};
b._onLoadComponent=function(c,m){if(!U.isApplication(m)||!c.id){return;}F.initialize({componentData:c.componentData,asyncHints:c.asyncHints,manifest:m,componentId:c.id});};
return b;},true);
sap.ui.predefine('sap/ui/fl/DefaultVariant',["sap/ui/fl/Change"],function(C){"use strict";var D=function(){};
D.prototype.getDefaultVariantId=function(c){var d=this.getNewestDefaultVariantChangeDeleteTheRest(c);if(d){return d.getContent().defaultVariantName;}return"";};
D.prototype.getNewestDefaultVariantChangeDeleteTheRest=function(c){var d=this.getDefaultVariantChanges(c).sort(function(a,b){var e=new Date(a.getCreation());var f=new Date(b.getCreation());if(isNaN(e.getDate())){return-1;}if(isNaN(f.getDate())){return 1;}return f-e;});var n=d.shift();d.forEach(function(o){o.markForDeletion();});return n;};
D.prototype.getDefaultVariantChanges=function(c){if(!c||typeof c!=='object'){return[];}return Object.keys(c).map(a).filter(d);function a(s){return c[s];}function d(o){return o.getChangeType()==='defaultVariant';}};
D.prototype.updateDefaultVariantId=function(c,n){var N=this.getNewestDefaultVariantChangeDeleteTheRest(c);if(N){var o=N.getContent();o.defaultVariantName=n;N.setContent(o);}return N;};
D.prototype._createChangeFile=function(p){var f;p.changeType='defaultVariant';f=C.createInitialFileContent(p);f.content.defaultVariantName=p.defaultVariantId;f.layer='USER';return f;};
D.prototype.createChangeObject=function(p){var f;var c;f=this._createChangeFile(p);c=new C(f);return c;};
return new D();},true);
sap.ui.predefine('sap/ui/fl/EventHistory',function(){"use strict";var E=function(){};E._aEventIds=["ControlForPersonalizationRendered"];E._aUnsubscribedEventIds=[];E._oHistory={};
E.start=function(){E._aEventIds.forEach(function(e){if(E._aUnsubscribedEventIds.indexOf(e)===-1){sap.ui.getCore().getEventBus().subscribe("sap.ui",e,E.saveEvent);E._oHistory[e]=[];}});};
E.saveEvent=function(c,e,p){var o={channelId:c,eventId:e,parameters:p.getId()};if(E._oHistory[e]){var b=E._oHistory[e].some(function(O){return(O.channelId===o.channelId&&O.eventId===o.eventId&&O.parameters===o.parameters);});if(!b){E._oHistory[e].push(o);}}};
E.getHistoryAndStop=function(e){sap.ui.getCore().getEventBus().unsubscribe("sap.ui",e,E.saveEvent);E._addUnsubscribedEvent(e);return E._oHistory[e]||[];};
E._addUnsubscribedEvent=function(e){if(E._aUnsubscribedEventIds.indexOf(e)===-1){E._aUnsubscribedEventIds.push(e);}};
return E;},true);
sap.ui.predefine('sap/ui/fl/FakeLrepConnector',["sap/ui/fl/apply/_internal/connectors/ObjectPathConnector","sap/ui/fl/apply/_internal/connectors/ObjectStorageUtils"],function(O,a){"use strict";var F={};var b="sap.ui.fl";F.prototype={};
F.enableFakeConnector=function(i){this.setFlexibilityServicesAndClearCache("LocalStorageConnector",i);};
F.setFlexibilityServicesAndClearCache=function(s,i){this._oFlexibilityServices=sap.ui.getCore().getConfiguration().getFlexibilityServices();var c=[];if(i){O.setJsonPath(i);c.push({connector:"ObjectPathConnector"});}c.push({connector:s});sap.ui.getCore().getConfiguration().setFlexibilityServices(c);sap.ui.requireSync("sap/ui/fl/Cache").clearEntries();};
F.disableFakeConnector=function(){F.prototype={};sap.ui.requireSync("sap/ui/fl/Cache").clearEntries();if(this._oFlexibilityServices){sap.ui.getCore().getConfiguration().setFlexibilityServices(this._oFlexibilityServices);delete this._oFlexibilityServices;}};
F.forTesting={getNumberOfChanges:function(c,r){return c.loadFlexData({reference:r}).then(function(R){return R.reduce(function(n,o){return n+o.changes.length;},0);});},spyMethod:function(s,c,C,m){var S=s.spy(C,m);return function(n,i){i=i||0;var N=S.getCall(i).args[0].flexObjects.length;c.equal(N,n,m+" was called "+n+" times");};},clear:function(c,p){sap.ui.requireSync("sap/ui/fl/Cache").clearEntries();return c.reset(p);},setStorage:function(c,n){c.oStorage=n;},synchronous:{clearAll:function(s){Object.keys(s).map(function(k){var i=k.includes(b);if(!i){return;}s.removeItem(k);});},store:function(s,k,i){var f=a.createFlexKey(k);var I=JSON.stringify(i);s.setItem(f,I);},getNumberOfChanges:function(s,r){var c=0;Object.keys(s).map(function(k){var i=k.includes(b);if(!i){return;}var f=JSON.parse(s.getItem(k));if(f.reference===r||f.reference+".Component"===r){c++;}});return c;}}};return F;},true);
sap.ui.predefine('sap/ui/fl/FlexController',["sap/ui/fl/registry/ChangeRegistry","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/Change","sap/ui/fl/Variant","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/context/ContextManager","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/util/reflection/XmlTreeModifier","sap/ui/core/Component","sap/base/Log","sap/base/util/restricted/_uniqWith"],function(C,U,L,a,V,b,c,A,R,d,J,X,e,f,_){"use strict";var F=function(s,g){this._oChangePersistence=undefined;this._sComponentName=s||"";this._sAppVersion=g||U.DEFAULT_APP_VERSION;if(this._sComponentName&&this._sAppVersion){this._createChangePersistence();}};
F.prototype.setComponentName=function(s){this._sComponentName=s;this._createChangePersistence();};
F.prototype.getComponentName=function(){return this._sComponentName;};
F.prototype.getAppVersion=function(){return this._sAppVersion;};
F.prototype.getVariantModelData=function(){var D;if(this._oChangePersistence&&this._oChangePersistence._oVariantController._mVariantManagement&&Object.keys(this._oChangePersistence._oVariantController._mVariantManagement).length>0){D=this._oChangePersistence._oVariantController.fillVariantModel();}return D;};
F.prototype.setVariantSwitchPromise=function(p){this._oVariantSwitchPromise=p;};
F.prototype.waitForVariantSwitch=function(){if(!this._oVariantSwitchPromise){this._oVariantSwitchPromise=Promise.resolve();}return this._oVariantSwitchPromise;};
F.prototype.createBaseChange=function(o,g){var h;var i;var j=c._getContextIdsFromUrl();if(j.length>1){throw new Error("More than one DesignTime Context is currently active.");}if(!g){throw new Error("No application component found. To offer flexibility a valid relation to its owning component must be present.");}o.reference=this.getComponentName();o.packageName="$TMP";o.context=j.length===1?j[0]:"";o.validAppVersions=U.getValidAppVersions({appVersion:this.getAppVersion(),developerMode:o.developerMode,scenario:o.scenario});h=a.createInitialFileContent(o);i=new a(h);if(o.variantReference){i.setVariantReference(o.variantReference);}return i;};
F.prototype.createChange=function(o,g){var h;var i;return Promise.resolve().then(function(){if(!g){throw new Error("A flexibility change cannot be created without a targeted control.");}var s=g.id||g.getId();if(!o.selector){o.selector={};}h=g.appComponent||U.getAppComponentForControl(g);if(!h){throw new Error("No application component found. To offer flexibility, the control with the ID '"+s+"' has to have a valid relation to its owning application component.");}Object.assign(o.selector,J.getSelector(s,h));i=this.createBaseChange(o,h);var j=g.controlType||U.getControlType(g);if(!j){throw new Error("No control type found - the change handler can not be retrieved.");}return this._getChangeHandler(i,j,g,J);}.bind(this)).then(function(j){if(j){j.completeChangeContent(i,o,{modifier:J,appComponent:h});}else{throw new Error("Change handler could not be retrieved for change "+JSON.stringify(o)+".");}return i;});};
F.prototype.createVariant=function(v,o){var g;var h;if(!o){throw new Error("No Application Component found - to offer flexibility the variant has to have a valid relation to its owning application component.");}if(v.content.variantManagementReference){var i=J.checkControlId(v.content.variantManagementReference,o);if(!i){throw new Error("Generated ID attribute found - to offer flexibility a stable VariantManagement ID is needed to assign the changes to, but for this VariantManagement control the ID was generated by SAPUI5 "+v.content.variantManagementReference);}}v.content.reference=this.getComponentName();v.content.packageName="$TMP";v.content.validAppVersions=U.getValidAppVersions(this.getAppVersion(),v.developerMode,v.scenario);h=V.createInitialFileContent(v);g=new V(h);return g;};
F.prototype.addChange=function(o,g){return this.createChange(o,g).then(function(h){var i=U.getAppComponentForControl(g);this.addPreparedChange(h,i);return h;}.bind(this));};
F.prototype.addPreparedChange=function(o,g){if(o.getVariantReference()){var m=g.getModel(U.VARIANT_MODEL_NAME);m.addChange(o);}this._oChangePersistence.addChange(o,g);return o;};
F.prototype.deleteChange=function(o,g){this._oChangePersistence.deleteChange(o);if(o.getVariantReference()){g.getModel(U.VARIANT_MODEL_NAME).removeChange(o);}};
F.prototype.createAndApplyChange=function(o,g){var h;return Promise.resolve().then(function(){return this.addChange(o,g);}.bind(this)).then(function(i){h=i;var p={modifier:J,appComponent:U.getAppComponentForControl(g),view:U.getViewForControl(g)};h.setQueuedForApply();return A.applyChangeOnControl(h,g,p);}).then(function(r){if(!r.success){var E=r.error||new Error("The change could not be applied.");this._oChangePersistence.deleteChange(h,true);throw E;}return h;}.bind(this));};
F.prototype._checkDependencies=function(o,D,m,g,r){var h=this._canChangePotentiallyBeApplied(o,g);if(!h){return[];}r.push(o);var s=o.getId();var j=D[s]&&D[s].dependencies||[];for(var i=0,n=j.length;i<n;i++){var k=U.getChangeFromChangesMap(m,j[i]);h=this._checkDependencies(k,D,m,g,r);if(h.length===0){r=[];break;}delete D[s];}return r;};
F.prototype._canChangePotentiallyBeApplied=function(o,g){var s=o.getDependentControlSelectorList();s.push(o.getSelector());return!s.some(function(S){return!J.bySelector(S,g);});};
F.prototype.waitForChangesToBeApplied=function(s){var S;if(Array.isArray(s)){S=s;}else{S=[s];}var p=S.map(function(v){return this._waitForChangesToBeApplied(v);}.bind(this));return Promise.all(p).then(function(){return undefined;});};
F.prototype._waitForChangesToBeApplied=function(s){var o=s.id&&sap.ui.getCore().byId(s.id)||s;var m=this._oChangePersistence.getChangesMapForComponent();var p=[];var D=Object.assign({},m.mDependencies);var g=m.mChanges;var h=g[o.getId()]||[];var n=h.filter(function(j){return!j.isCurrentProcessFinished();},this);var i=s.appComponent||U.getAppComponentForControl(o);var r=[];n.forEach(function(j){var k=this._checkDependencies(j,D,m.mChanges,i,[]);k.forEach(function(l){if(r.indexOf(l)===-1){r.push(l);}});}.bind(this));r.forEach(function(j){p=p.concat(j.addChangeProcessingPromises());},this);p.push(this.waitForVariantSwitch());return Promise.all(p);};
F.prototype.saveAll=function(s,D){return this._oChangePersistence.saveDirtyChanges(s,undefined,D);};
F.prototype.processXmlView=function(v,p){var o=e.get(p.componentId);var g=U.getAppComponentForControl(o);p.appComponent=g;p.modifier=X;p.view=v;return this._oChangePersistence.getChangesForView(p.viewId,p).then(A.applyAllChangesForXMLView.bind(A,p)).catch(this._handlePromiseChainError.bind(this,p.view));};
F.prototype._handlePromiseChainError=function(v,E){f.error("Error processing view "+E+".");return v;};
F.prototype._getSelectorOfChange=function(o){if(!o||!o.getSelector){return undefined;}return o.getSelector();};
F.prototype._getChangeHandler=function(o,s,g,m){var h=o.getChangeType();var l=o.getLayer();return this._getChangeRegistry().getChangeHandler(h,s,g,m,l);};
F.prototype._getChangeRegistry=function(){var i=C.getInstance();i.initSettings();return i;};
F.prototype.getComponentChanges=function(p,i){return this._oChangePersistence.getChangesForComponent(p,i);};
F.prototype.checkForOpenDependenciesForControl=function(s,m,o){return this._oChangePersistence.checkForOpenDependenciesForControl(s,m,o);};
F.prototype.hasHigherLayerChanges=function(p){p=p||{};var s=p.upToLayer||L.getCurrentLayer(false);p.includeVariants=true;p.includeCtrlVariants=true;return this.getComponentChanges(p).then(function(v){var h=v===this._oChangePersistence.HIGHER_LAYER_CHANGES_EXIST||v.some(function(o){return L.compareAgainstCurrentLayer(o.getLayer(),s)>0;});return!!h;}.bind(this));};
F.prototype._createChangePersistence=function(){this._oChangePersistence=b.getChangePersistenceForComponent(this.getComponentName(),this.getAppVersion());return this._oChangePersistence;};
F.prototype.resetChanges=function(l,g,o,s,h){return this._oChangePersistence.resetChanges(l,g,s,h).then(function(i){if(i.length!==0){return R.revertMultipleChanges(i,{appComponent:o,modifier:J,flexController:this});}}.bind(this)).then(function(){if(o){var m=o.getModel(U.VARIANT_MODEL_NAME);if(m){d.update({parameters:[],updateURL:true,updateHashEntry:true,model:m});}}});};
F.prototype.discardChanges=function(g,D){var s=L.getCurrentLayer(!!D);var i=0;var l;var o;l=g.length;while(i<g.length){o=g[i];if(o&&o.getLayer&&o.getLayer()===s){this._oChangePersistence.deleteChange(o);}if(l===g.length){i++;}else{l=g.length;}}return this._oChangePersistence.saveDirtyChanges();};
F.prototype.discardChangesForId=function(i,D){if(!i){return Promise.resolve();}var o=this._oChangePersistence.getChangesMapForComponent();var g=o.mChanges[i]||[];return this.discardChanges(g,D);};
F.prototype.applyVariantChanges=function(g,o){var p=[];var m=J;var h=g.map(function(i){this._oChangePersistence._addChangeAndUpdateDependencies(o,i);return this._getSelectorOfChange(i);}.bind(this));var s=function(S,t){return S.id===t.id;};h=_(h,s);h.forEach(function(S){p.push(function(){var i=m.bySelector(S,o);if(!i){f.error("A flexibility change tries to change a nonexistent control.");return new U.FakePromise();}return A.applyAllChangesForControl(this._oChangePersistence.getChangesMapForComponent.bind(this._oChangePersistence),o,this,i);}.bind(this));}.bind(this));return U.execPromiseQueueSequentially(p);};
F.prototype.saveSequenceOfDirtyChanges=function(D){return this._oChangePersistence.saveDirtyChanges(false,D);};
F.prototype.getResetAndPublishInfo=function(p){p.reference=this._sComponentName;p.appVersion=this._sAppVersion;return this._oChangePersistence.getResetAndPublishInfo(p);};
return F;},true);
sap.ui.predefine('sap/ui/fl/FlexControllerFactory',["sap/ui/fl/FlexController","sap/ui/fl/Utils","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/variants/VariantModel","sap/base/Log","sap/ui/performance/Measurement"],function(F,U,A,a,V,L,M){"use strict";var b={};b._instanceCache={};
b.create=function(c,s){s=s||U.DEFAULT_APP_VERSION;if(!b._instanceCache[c]){b._instanceCache[c]={};}var f=b._instanceCache[c][s];if(!f){f=new F(c,s);b._instanceCache[c][s]=f;}return f;};
b.createForControl=function(c,m){try{var o=U.getAppComponentForControl(c);var C=U.getComponentClassName(o||c);var s=U.getAppVersionFromManifest(o?o.getManifest():m);return b.create(C,s);}catch(e){L.error(e.message,undefined,"sap.ui.fl.FlexControllerFactory");}};
b.getChangesAndPropagate=function(c,C){if(U.isApplicationComponent(c)){return a.initialize({componentId:C.id||c.getId(),asyncHints:C.asyncHints}).then(_.bind(this,c));}else if(U.isEmbeddedComponent(c)){var o=U.getAppComponentForControl(c);if(o){return Promise.resolve().then(function(){var e=o.getModel(U.VARIANT_MODEL_NAME);if(!e){return _(o);}return e;}).then(function(v){c.setModel(v,U.VARIANT_MODEL_NAME);});}}};
function _(o){var m=o.getManifestObject();var f;f=b.createForControl(o,m);return f._oChangePersistence.loadChangesMapForComponent(o).then(function(g){var p=A.applyAllChangesForControl.bind(A,g,o,f);p._bIsSapUiFlFlexControllerApplyChangesOnControl=true;o.addPropagationListener(p);var d=f.getVariantModelData()||{};var v=new V(d,f,o);o.setModel(v,U.VARIANT_MODEL_NAME);M.end("flexProcessing");return v;});}
return b;},true);
sap.ui.predefine('sap/ui/fl/LayerUtils',["sap/base/util/UriParameters","sap/ui/thirdparty/hasher"],function(U,h){"use strict";var L={BASE:"BASE",VENDOR:"VENDOR",PARTNER:"PARTNER",CUSTOMER_BASE:"CUSTOMER_BASE",CUSTOMER:"CUSTOMER",USER:"USER"};var l=[L.BASE,L.VENDOR,L.PARTNER,L.CUSTOMER_BASE,L.CUSTOMER,L.USER];var m={};l.forEach(function(s,i){m[s]=i;});var a={_mLayersIndex:m,_sTopLayer:l[l.length-1],FL_MAX_LAYER_PARAM:"sap-ui-fl-max-layer",isVendorLayer:function(){return this.getCurrentLayer(false)===L.VENDOR;},isCustomerDependentLayer:function(s){return([L.CUSTOMER,L.CUSTOMER_BASE].indexOf(s)>-1);},doesCurrentLayerRequirePackage:function(){var c=this.getCurrentLayer(false);return(c===L.VENDOR)||(c===L.PARTNER)||(c===L.CUSTOMER_BASE);},getMaxLayer:function(){var p;var u=this.getUshellContainer();if(u){var P=u.getService("URLParsing").parseShellHash(h.getHash())||{};if(P.params&&P.params.hasOwnProperty(this.FL_MAX_LAYER_PARAM)){p=P.params[this.FL_MAX_LAYER_PARAM][0];}}return p||this.getUrlParameter(this.FL_MAX_LAYER_PARAM)||this._sTopLayer;},getLayerIndex:function(s){return this._mLayersIndex[s];},isOverMaxLayer:function(s){return(this.getLayerIndex(s)>this.getLayerIndex(this.getMaxLayer()));},compareAgainstCurrentLayer:function(s,c){var C=c||a.getCurrentLayer(false);if((this.getLayerIndex(C)>this.getLayerIndex(s))||!s){return-1;}else if(this.getLayerIndex(C)===this.getLayerIndex(s)){return 0;}return 1;},isLayerFilteringRequired:function(){return!(this._sTopLayer===this.getMaxLayer());},getCurrentLayer:function(i){if(i){return L.USER;}var s=this.getUrlParameter("sap-ui-layer")||"";s=s.toUpperCase();return s||L.CUSTOMER;},filterChangeDefinitionsByMaxLayer:function(c){return c.filter(function(C){if(C.layer&&a.isOverMaxLayer(C.layer)){return false;}return true;});},getUrlParameter:function(p){return U.fromQuery(window.location.search).get(p);},getUshellContainer:function(){return sap.ushell&&sap.ushell.Container;}};return a;},true);
sap.ui.predefine('sap/ui/fl/LrepConnector',["sap/ui/thirdparty/jquery","sap/ui/thirdparty/URI","sap/ui/fl/Utils","sap/base/util/merge"],function(q,u,F,b){"use strict";var L=function(p){this._initClientParam();this._initLanguageParam();if(p){this._sXsrfToken=p.XsrfToken;}};
L.createConnector=function(p){return new L(p);};
L._oLoadSettingsPromise=undefined;L.prototype._sClient=undefined;L.prototype._sLanguage=undefined;L.prototype._aSentRequestListeners=[];L.prototype._sRequestUrlPrefix="";L.DEFAULT_CONTENT_TYPE="application/json; charset=utf-8";L.ROUTES={CONTENT:"/content/",CSRF:"/actions/getcsrftoken/",PUBLISH:"/actions/publish/",DATA:"/flex/data/",MODULES:"/flex/modules/",SETTINGS:"/flex/settings",INFO:"/flex/info"};
L.prototype._initClientParam=function(){var c=F.getClient();if(c){this._sClient=c;}};
L.prototype._initLanguageParam=function(){var l;l=F.getUrlParameter("sap-language")||F.getUrlParameter("sap-ui-language");if(l){this._sLanguage=l;}};
L.prototype._resolveUrl=function(r){if(!r.startsWith("/")){r="/"+r;}r=this._sRequestUrlPrefix+r;var U=u(r).absoluteTo("");return U.toString();};
L.prototype._getDefaultHeader=function(){return{headers:{"X-CSRF-Token":this._sXsrfToken||"fetch"}};};
L.prototype._getDefaultOptions=function(m,c,d){var o;if(!c){c=L.DEFAULT_CONTENT_TYPE;}else if(c.indexOf("charset")===-1){c+="; charset=utf-8";}o=b(this._getDefaultHeader(),{type:m,async:true,contentType:c,processData:false,headers:{"Content-Type":c}});if(d&&o.contentType.indexOf("application/json")===0){o.dataType="json";if(typeof d==="object"){o.data=JSON.stringify(d);}else{o.data=d;}}else if(d){o.data=d;}if(m==="DELETE"){delete o.data;delete o.contentType;}return o;};
L.prototype.send=function(U,m,d,o){m=m||"GET";m=m.toUpperCase();o=o||{};U=this._resolveUrl(U);o=b(this._getDefaultOptions(m,o.contentType,d),o);return this._sendAjaxRequest(U,o);};
L.prototype._getMessagesFromXHR=function(x){var a;var m;var l;var i;m=[];try{a=JSON.parse(x.responseText);if(a&&a.messages&&a.messages.length>0){l=a.messages.length;for(i=0;i<l;i++){m.push({severity:a.messages[i].severity,text:a.messages[i].text});}}}catch(e){}return m;};
L.prototype._sendAjaxRequest=function(U,o){var f=F.getLrepUrl();if(!f){return Promise.reject({status:"warning",messages:[{severity:"warning",text:"Flexibility Services requests were not sent. The UI5 bootstrap is configured to not send any requests."}]});}var s=f+L.ROUTES.CSRF;var m={headers:{"X-CSRF-Token":"fetch"},type:"HEAD"};if(this._sClient){m.headers["sap-client"]=this._sClient;}return new Promise(function(r,a){function h(e,S,x){var n=x.getResponseHeader("X-CSRF-Token");this._sXsrfToken=n||this._sXsrfToken;var E=x.getResponseHeader("etag");var g={status:S,etag:E,response:e};r(g);q.each(this._aSentRequestListeners,function(i,C){C(g);});}function p(e,x,S,E){var g=new Error(E);g.status=S;g.code=x.statusCode().status;g.messages=this._getMessagesFromXHR(x);if(!g.stack){try{throw g;}catch(i){e(i);}}else{e(g);}}function c(e,S,x){this._sXsrfToken=x.getResponseHeader("X-CSRF-Token");o.headers=o.headers||{};o.headers["X-CSRF-Token"]=this._sXsrfToken;q.ajax(U,o).done(h).fail(p.bind(this,a));}function d(e,g,x,S,E){if(x.status===403){q.ajax(s,m).done(c.bind(this)).fail(function(){g({status:"error"});});}else if(o&&o.type==="DELETE"&&x.status===404){e();}else{p.call(this,g,x,S,E);}}var R=true;if(o&&o.type){if(o.type==="GET"||o.type==="HEAD"){R=false;}else if(this._sXsrfToken&&this._sXsrfToken!=="fetch"){R=false;}}if(R){q.ajax(s,m).done(c.bind(this)).fail(p.bind(this,a));}else{q.ajax(U,o).done(h.bind(this)).fail(d.bind(this,r,a));}}.bind(this));};
L.prototype._buildParams=function(p){if(!p){p=[];}if(this._sClient){p.push({name:"sap-client",value:this._sClient});}if(this._sLanguage){p.push({name:"sap-language",value:this._sLanguage});}var r="";var l=p.length;for(var i=0;i<l;i++){if(i===0){r+="?";}else if(i>0&&i<l){r+="&";}r+=p[i].name+"="+p[i].value;}return r;};
L.prototype.loadChanges=function(c,p){function _(p){var o={};if(p.cacheKey){o.cache=true;}if(p.siteId){if(!o.headers){o.headers={};}o.headers={"X-LRep-Site-Id":p.siteId};}if(p.appDescriptor){if(p.appDescriptor["sap.app"]){if(!o.headers){o.headers={};}o.headers={"X-LRep-AppDescriptor-Id":p.appDescriptor["sap.app"].id};}}return o;}function a(c,p,C){var U={};var f=F.getLrepUrl()+L.ROUTES.DATA;var s=F.getLrepUrl()+L.ROUTES.MODULES;var P="";if(p.cacheKey){P+="~"+p.cacheKey+"~/";}P+=c.name;if(p.layer){P+="&upToLayerType="+p.layer;}if(C){P+="&sap-client="+C;}if(c.appVersion&&(c.appVersion!==F.DEFAULT_APP_VERSION)){P+="&appVersion="+c.appVersion;}P=P.replace("&","?");U.flexDataUrl=U.flexDataUrl||f+P;U.flexModulesUrl=U.flexModulesUrl||s+P;return U;}p=p||{};if(!c.name){return Promise.reject(new Error("Component name not specified"));}var o=_(p);var U=a.call(this,c,p,this._sClient);return this.send(U.flexDataUrl,undefined,undefined,o).then(this._onChangeResponseReceived.bind(this,c.name,U.flexModulesUrl,p.cacheKey));};
L.prototype._onChangeResponseReceived=function(c,f,C,r){L._bServiceAvailability=true;if(r.etag===null){r.etag=C;}var m={changes:r.response,loadModules:r.response.loadModules,messagebundle:r.response.messagebundle,componentClassName:c,etag:r.etag};if(!m.loadModules){return m;}return this._loadModules(f).then(function(){return m;});};
L.prototype.loadSettings=function(){if(!L._oLoadSettingsPromise){var U=F.getLrepUrl()+L.ROUTES.SETTINGS;if(this._sClient){U+="?sap-client="+this._sClient;}L._oLoadSettingsPromise=this.send(U,undefined,undefined,{});}return L._oLoadSettingsPromise.then(function(r){L._bServiceAvailability=true;return r.response;},function(e){if(e.code===404){L._bServiceAvailability=false;}return Promise.resolve();});};
L.prototype.getStaticResource=function(n,N,t,i){var r=F.getLrepUrl()+L.ROUTES.CONTENT;r+=n+"/"+N+"."+t;var p=[];if(!i){p.push({name:"dt",value:"true"});}r+=this._buildParams(p);return this.send(r,"GET",null,null);};
L.prototype.getFileAttributes=function(n,N,t,l){var r=F.getLrepUrl()+L.ROUTES.CONTENT;r+=n+"/"+N+"."+t;var p=[];p.push({name:"metadata",value:"true"});if(l){p.push({name:"layer",value:l});}r+=this._buildParams(p);return this.send(r,"GET",null,null);};
return L;},true);
sap.ui.predefine('sap/ui/fl/Preprocessor',["sap/ui/base/Object"],function(B){"use strict";return B.extend("sap.ui.fl.Preprocessor",{});});
sap.ui.predefine('sap/ui/fl/PreprocessorImpl',["sap/ui/core/Component","sap/ui/fl/Utils","sap/ui/fl/ChangePersistenceFactory","sap/base/Log"],function(C,U,a,L){'use strict';
function i(c){return c.getChangeType()==="codeExt";}
function b(c,o){var s=o.getSelector().controllerName;return c===s;}
var P=function(){};
P.prototype.getControllerExtensions=function(c,s,A){if(A){if(!s){L.warning("No component ID for determining the anchor of the code extensions was passed.");return Promise.resolve([]);}var o=C.get(s);var d=U.getAppComponentForControl(o);if(!U.isApplication(d.getManifestObject())){return Promise.resolve([]);}var f=U.getComponentClassName(d);var e=U.getAppVersionFromManifest(d.getManifest(),e);var g=a.getChangePersistenceForComponent(f,e);return g.getChangesForComponent().then(function(h){var E=h.filter(function(j){return i(j)&&b(c,j);}).map(function(j){return j.getModuleName();});return P.getExtensionModules(E);});}L.warning("Synchronous extensions are not supported by sap.ui.fl.PreprocessorImpl");return[];};
P.getExtensionModules=function(c){if(c.length===0){return Promise.resolve([]);}return new Promise(function(r){sap.ui.require(c,function(){var m=Array.prototype.slice.call(arguments);r(m);},function(e){L.error("Code Extension not found",e.message);r([]);});});};
return P;},true);
sap.ui.predefine('sap/ui/fl/RegistrationDelegator',["sap/ui/fl/FlexControllerFactory","sap/ui/core/Component","sap/ui/fl/registry/ChangeHandlerRegistration","sap/ui/fl/ChangePersistenceFactory","sap/ui/core/mvc/Controller","sap/ui/core/mvc/XMLView","sap/ui/fl/EventHistory","sap/ui/fl/apply/_internal/changes/descriptor/Applier"],function(F,C,a,b,M,X,E,A){"use strict";var R={};
function _(){C._fnOnInstanceCreated=F.getChangesAndPropagate;}
function c(){a.getChangeHandlersOfLoadedLibsAndRegisterOnNewLoadedLibs();}
function d(){C._fnLoadComponentCallback=b._onLoadComponent.bind(b);}
function e(){M.registerExtensionProvider("sap.ui.fl.PreprocessorImpl");}
function f(){if(X.registerPreprocessor){X.registerPreprocessor("viewxml","sap.ui.fl.XmlPreprocessorImpl",true);}}
function g(){E.start();}
function h(){C._fnPreprocessManifest=A.preprocessManifest;}
R.registerAll=function(){g();c();d();e();_();f();h();};
return R;},true);
sap.ui.predefine('sap/ui/fl/StandardVariant',["sap/ui/fl/Change"],function(C){"use strict";var S=function(){};
S.prototype.getExecuteOnSelect=function(c){var a=this.getNewestStandardVariantChangeDeleteTheRest(c);if(a){return a.getContent().executeOnSelect;}return null;};
S.prototype.getNewestStandardVariantChangeDeleteTheRest=function(c){var d=this.getStandardVariantChanges(c).sort(function(a,b){var D=new Date(a.getCreation());var e=new Date(b.getCreation());if(isNaN(D.getDate())){return-1;}if(isNaN(e.getDate())){return 1;}return e-D;});var n=d.shift();d.forEach(function(o){o.markForDeletion();});return n;};
S.prototype.getStandardVariantChanges=function(c){if(!c||typeof c!=='object'){return[];}return Object.keys(c).map(a).filter(b);function a(s){return c[s];}function b(o){return o.getChangeType()==='standardVariant';}};
S.prototype.updateExecuteOnSelect=function(c,n){var N=this.getNewestStandardVariantChangeDeleteTheRest(c);if(N){var o=N.getContent();o.executeOnSelect=n;N.setContent(o);}return N;};
S.prototype._createChangeFile=function(p){var f;p.namespace=p.component+'/changes/standard';p.componentName=p.component;p.changeType='standardVariant';f=C.createInitialFileContent(p);f.content.executeOnSelect=p.executeOnSelect;f.layer='USER';return f;};
S.prototype.createChangeObject=function(p){var f;var c;f=this._createChangeFile(p);c=new C(f);return c;};
return new S();},true);
sap.ui.predefine('sap/ui/fl/Utils',["sap/ui/thirdparty/jquery","sap/ui/core/Component","sap/ui/core/util/reflection/BaseTreeModifier","sap/ui/thirdparty/hasher","sap/base/Log","sap/base/util/UriParameters","sap/base/util/uid","sap/base/strings/formatMessage","sap/ui/base/ManagedObject","sap/ui/core/mvc/View"],function(q,C,B,h,L,U,u,f,M,V){"use strict";
function a(c){if(c.length>0&&c.indexOf(".Component")<0){c+=".Component";}return c;}
var b={DEFAULT_APP_VERSION:"DEFAULT_APP_VERSION",APP_ID_AT_DESIGN_TIME:"${pro"+"ject.art"+"ifactId}",VARIANT_MODEL_NAME:"$FlexVariants",formatAndLogMessage:function(l,m,v,c){var s=m.join(' ');s=f(s,v);L[l](s,c||"");},getXSRFTokenFromControl:function(c){var m;if(!c){return"";}if(c&&typeof c.getModel==="function"){m=c.getModel();return b._getXSRFTokenFromModel(m);}return"";},_getXSRFTokenFromModel:function(m){var H;if(!m){return"";}if(typeof m.getHeaders==="function"){H=m.getHeaders();if(H){return H["x-csrf-token"];}}return"";},getComponentClassName:function(c){var A;if(c){A=this.getAppComponentForControl(c);if(A){var v=this._getComponentStartUpParameter(A,"sap-app-id");if(v){return v;}if(A.getManifestEntry("sap.ui5")&&A.getManifestEntry("sap.ui5").appVariantId){return A.getManifestEntry("sap.ui5").appVariantId;}}}return b.getComponentName(A);},isVariantByStartupParameter:function(c){if(c){var A=this.getAppComponentForControl(c);if(A){return!!this._getComponentStartUpParameter(A,"sap-app-id");}}return false;},getAppComponentClassNameForComponent:function(c){return b.getComponentClassName(c);},getAppDescriptor:function(c){var m=null;var o=null;var d=null;if(c){o=this.getAppComponentForControl(c);if(o&&o.getMetadata){d=o.getMetadata();if(d&&d.getManifest){m=d.getManifest();}}}return m;},getSiteId:function(c){var s=null;var A=null;if(c){A=this.getAppComponentForControl(c);if(A){s=this._getComponentStartUpParameter(A,"hcpApplicationId");}}return s;},getSiteIdByComponentData:function(c){return this._getStartUpParameter(c,"hcpApplicationId");},isBinding:function(p){var i=false;if(p&&typeof p==="string"&&p.substring(0,1)==="{"&&p.slice(-1)==="}"){i=true;}return i;},isApplicationVariant:function(c){var F=b.getComponentClassName(c);var A=b.getAppComponentForControl(c);var s=b.getComponentName(A);return F!==s;},isChangeRelatedToVariants:function(c){return c.getFileType()==="ctrl_variant_change"||c.getFileType()==="ctrl_variant_management_change"||c.getFileType()==="ctrl_variant"||c.getVariantReference();},_getComponentStartUpParameter:function(c,p){var s=null;if(p){if(c&&c.getComponentData){s=this._getStartUpParameter(c.getComponentData(),p);}}return s;},_getStartUpParameter:function(c,p){if(c&&c.startupParameters&&p){if(Array.isArray(c.startupParameters[p])){return c.startupParameters[p][0];}}},getComponentName:function(c){var s="";if(c){s=c.getMetadata().getName();}return a(s);},_getComponent:function(c){var o;if(c){o=C.get(c);}return o;},_getComponentIdForControl:function(c){var s=b._getOwnerIdForControl(c);if(!s){if(c&&typeof c.getParent==="function"){var p=c.getParent();if(p){return b._getComponentIdForControl(p);}}}return s||"";},getComponentForControl:function(c){return b._getComponentForControl(c);},getAppComponentForControl:function(c){var o=c instanceof C?c:this._getComponentForControl(c);return this._getAppComponentForComponent(o);},getAppDescriptorComponentObjectForControl:function(c){var A=this.getAppComponentForControl(c);var m=A.getManifest();return{name:this.getAppIdFromManifest(m),version:this.getAppVersionFromManifest(m)};},_getComponentForControl:function(c){var o=null;var s=null;if(c){s=b._getComponentIdForControl(c);if(s){o=b._getComponent(s);}}return o;},_getAppComponentForComponent:function(c){var s=null;if(c&&c.getAppComponent){return c.getAppComponent();}if(c&&c.oComponentData&&c.oComponentData.appComponent){return c.oComponentData.appComponent;}if(c&&c.getManifestEntry){s=c.getManifestEntry("sap.app");}else{return c;}if(s&&s.type&&s.type!=="application"){if(c instanceof C){c=this._getComponentForControl(c);}return this.getAppComponentForControl(c);}return c;},getViewForControl:function(c){return b.getFirstAncestorOfControlWithControlType(c,sap.ui.core.mvc.View);},getFirstAncestorOfControlWithControlType:function(c,d){if(c instanceof d){return c;}if(c&&typeof c.getParent==="function"){c=c.getParent();return b.getFirstAncestorOfControlWithControlType(c,d);}},hasControlAncestorWithId:function(c,A){var o;if(c===A){return true;}o=sap.ui.getCore().byId(c);while(o){if(o.getId()===A){return true;}if(typeof o.getParent==="function"){o=o.getParent();}else{return false;}}return false;},_isView:function(c){return c instanceof V;},_getOwnerIdForControl:function(c){return C.getOwnerIdFor(c);},getClient:function(){var o;var c;o=this._getUriParameters();c=o.get("sap-client");return c||undefined;},_getUriParameters:function(){return U.fromQuery(window.location.search);},isHotfixMode:function(){var o;var i;o=this._getUriParameters();i=o.get("hotfix");return(i==="true");},convertBrowserLanguageToISO639_1:function(s){if(!s||typeof s!=="string"){return"";}var n=s.indexOf("-");if((n<0)&&(s.length<=2)){return s.toUpperCase();}if(n>0&&n<=2){return s.substring(0,n).toUpperCase();}return"";},getLrepUrl:function(){var F=sap.ui.getCore().getConfiguration().getFlexibilityServices();var l=F.find(function(s){return s.connector==="LrepConnector";});return l?l.url:"";},getCurrentLanguage:function(){var l=sap.ui.getCore().getConfiguration().getLanguage();return b.convertBrowserLanguageToISO639_1(l);},getControlType:function(c){var m;if(c&&typeof c.getMetadata==="function"){m=c.getMetadata();if(m&&typeof m.getElementName==="function"){return m.getElementName();}}},asciiToString:function(c){var d=c.split(",");var p="";q.each(d,function(i,e){p+=String.fromCharCode(e);});return p;},stringToAscii:function(s){var c="";for(var i=0;i<s.length;i++){c+=s.charCodeAt(i)+",";}c=c.substring(0,c.length-1);return c;},checkControlId:function(c,A){if(!A){c=c instanceof M?c:sap.ui.getCore().byId(c);A=b.getAppComponentForControl(c);}return B.checkControlId(c,A);},hasLocalIdSuffix:B.hasLocalIdSuffix,_getAllUrlParameters:function(){return window.location.search.substring(1);},getTechnicalParametersForComponent:function(c){return c&&c.getComponentData&&c.getComponentData()&&c.getComponentData().technicalParameters;},getParsedURLHash:function(){var o=b.getUshellContainer();if(o){var c=o.getService("URLParsing");var p=c.parseShellHash(h.getHash());return p||{};}return{};},isDebugEnabled:function(){var o=this._getUriParameters();var d=o.get("sap-ui-debug")||"";if(sap.ui.getCore().getConfiguration().getDebug()||d==="true"){return true;}var D=d.split(",");return D.indexOf("sap/ui/fl")!==-1||D.indexOf("sap/ui/fl/")!==-1;},getUrlParameter:function(p){return U.fromQuery(window.location.search).get(p);},getUshellContainer:function(){return sap.ushell&&sap.ushell.Container;},createDefaultFileName:function(n){var F=u().replace(/-/g,"_");if(n){F+='_'+n;}return F;},createNamespace:function(p,s){var r=p.reference.replace('.Component','');var n='apps/'+r+"/"+s+"/";return n;},buildLrepRootNamespace:function(s,S,p){var r="apps/";var e=new Error("Error in sap.ui.fl.Utils#buildLrepRootNamespace: ");if(!s){e.message+="for every scenario you need a base ID";throw e;}switch(S){case sap.ui.fl.Scenario.VersionedAppVariant:if(!p){e.message+="in a versioned app variant scenario you additionally need a project ID";throw e;}r+=s+"/appVariants/"+p+"/";break;case sap.ui.fl.Scenario.AppVariant:if(!p){e.message+="in an app variant scenario you additionally need a project ID";throw e;}r+=s+"/appVariants/"+p+"/";break;case sap.ui.fl.Scenario.AdaptationProject:if(!p){e.message+="in a adaptation project scenario you additionally need a project ID";throw e;}r+=s+"/adapt/"+p+"/";break;case sap.ui.fl.Scenario.FioriElementsFromScratch:case sap.ui.fl.Scenario.UiAdaptation:default:r+=s+"/";}return r;},getValidAppVersions:function(p){var A=p.appVersion;var d=p.developerMode;var s=p.scenario;var v={creation:A,from:A};if(this._isValidAppVersionToRequired(A,d,s)){v.to=A;}return v;},_isValidAppVersionToRequired:function(A,d,s){return!!A&&!!d&&s!==sap.ui.fl.Scenario.AdaptationProject&&s!==sap.ui.fl.Scenario.AppVariant;},_getComponentTypeFromManifest:function(m){return m&&m.getEntry&&m.getEntry("sap.app")&&m.getEntry("sap.app").type;},isApplication:function(m){return b._getComponentTypeFromManifest(m)==="application";},isApplicationComponent:function(c){return c instanceof C&&b.isApplication(c.getManifestObject());},isEmbeddedComponent:function(c){return c instanceof C&&b._getComponentTypeFromManifest(c.getManifestObject())==="component";},getFlexReference:function(m){if(m){if(m.getEntry("sap.ui5")){if(m.getEntry("sap.ui5").appVariantId){return m.getEntry("sap.ui5").appVariantId;}if(m.getEntry("sap.ui5").componentName){return a(m.getEntry("sap.ui5").componentName);}}if(m.getEntry("sap.app")&&m.getEntry("sap.app").id){return a(b.getAppIdFromManifest(m));}}L.warning("No Manifest received.");return"";},getAppIdFromManifest:function(m){if(m){var s=(m.getEntry)?m.getEntry("sap.app"):m["sap.app"];var A=s&&s.id;if(A===b.APP_ID_AT_DESIGN_TIME&&m.getComponentName){A=m.getComponentName();}return A;}throw new Error("No Manifest received, descriptor changes are not possible");},getAppVersionFromManifest:function(m){var v="";if(m){var s=(m.getEntry)?m.getEntry("sap.app"):m["sap.app"];if(s&&s.applicationVersion&&s.applicationVersion.version){v=s.applicationVersion.version;}}else{L.warning("No Manifest received.");}return v;},getODataServiceUriFromManifest:function(m){var s="";if(m){var S=(m.getEntry)?m.getEntry("sap.app"):m["sap.app"];if(S&&S.dataSources&&S.dataSources.mainService&&S.dataSources.mainService.uri){s=S.dataSources.mainService.uri;}}else{L.warning("No Manifest received.");}return s;},isCorrectAppVersionFormat:function(v){v=v.replace(/\s/g,"");var r=/\b\d{1,5}(.\d{1,5}){0,2}/g;var R=/\b\d{1,5}(\.\d{1,5}){0,2}/g;var n=v.match(r)?v.match(r)[0].length:0;var c=v.match(R)?v.match(R)[0].length:0;if(c<1||c!==n){return false;}if(c&&v!==v.substr(0,c)){var d=v.substr(c,1);var o=/^[0-9.]$/;if(o.test(d)){return false;}}var e=v.substr(0,c).split(".");if(e.length>3){return false;}if(!e.every(function(p){return p.length<=5;})){return false;}return true;},indexOfObject:function(A,o){var O=-1;A.some(function(c,i){var k;var K;if(!c){k=[];}else{k=Object.keys(c);}if(!o){K=[];}else{K=Object.keys(o);}var s=k.length===K.length;var d=s&&!k.some(function(e){return c[e]!==o[e];});if(d){O=i;}return d;});return O;},execPromiseQueueSequentially:function(p,t,A){if(p.length===0){if(A){return Promise.resolve();}return new b.FakePromise();}var P=p.shift();if(typeof P==="function"){try{var r=P();}catch(e){r=Promise.reject(e);}return r.then(function(){if(!A&&r instanceof Promise){A=true;}}).catch(function(e){var E="Error during execPromiseQueueSequentially processing occured";E+=e?": "+e.message:"";L.error(E);if(t){throw new Error(E);}}).then(function(){return this.execPromiseQueueSequentially(p,t,A);}.bind(this));}L.error("Changes could not be applied, promise not wrapped inside function.");return this.execPromiseQueueSequentially(p,t,A);},FakePromise:function(i,e,I){b.FakePromise.fakePromiseIdentifier="sap.ui.fl.Utils.FakePromise";this.vValue=i;this.vError=e;this.bContinueWithFakePromise=arguments.length<3||(I===b.FakePromise.fakePromiseIdentifier);var r=function(p,c){try{var R=c(p,b.FakePromise.fakePromiseIdentifier);if(R instanceof Promise||R instanceof b.FakePromise){return R;}return new b.FakePromise(R);}catch(E){var v=E;return new b.FakePromise(undefined,v);}};b.FakePromise.prototype.then=function(c){if(!this.bContinueWithFakePromise){return Promise.resolve(c(this.vValue));}if(!this.vError){return r(this.vValue,c);}return this;};b.FakePromise.prototype.catch=function(c){if(!this.bContinueWithFakePromise){return Promise.reject(c(this.vError));}if(this.vError){return r(this.vError,c);}return this;};if(this.vValue instanceof Promise||this.vValue instanceof b.FakePromise){return this.vValue;}},getChangeFromChangesMap:function(c,s){var r;Object.keys(c).forEach(function(d){c[d].some(function(o){if(o.getId()===s){r=o;return true;}});});return r;},requireAsync:function(m){return new Promise(function(r,R){sap.ui.require([m],function(o){r(o);},function(e){R(e);});});}};return b;},true);
sap.ui.predefine('sap/ui/fl/Variant',["sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/registry/Settings","sap/base/util/merge","sap/base/Log"],function(q,M,U,L,S,m,a){"use strict";
var V=M.extend("sap.ui.fl.Variant",{
constructor:function(f){M.apply(this);if(!q.isPlainObject(f)){a.error("Constructor : sap.ui.fl.Variant : oFile is not defined");}this._oDefinition=f;this._oOriginDefinition=m({},f);this._sRequest='';this._bUserDependent=(f.content.layer==="USER");this._vRevertData=null;this.setState(V.states.NEW);},
metadata:{properties:{state:{type:"string"}}}
});
V.states={NEW:"NEW",PERSISTED:"NONE",DELETED:"DELETE",DIRTY:"UPDATE"};V.events={markForDeletion:"markForDeletion"};
V.prototype.setState=function(s){if(this._isValidState(s)){this.setProperty("state",s);}return this;};
V.prototype._isValidState=function(s){var b=false;Object.keys(V.states).some(function(k){if(V.states[k]===s){b=true;}return b;});if(!b){return false;}if((this.getState()===V.states.NEW)&&(s===V.states.DIRTY)){return false;}return true;};
V.prototype.isValid=function(){var i=true;if(typeof(this._oDefinition)!=="object"){i=false;}if(!this._oDefinition.content.fileType||this._oDefinition.content.fileType!=="ctrl_variant"){i=false;}if(!this._oDefinition.content.fileName){i=false;}if(!this._oDefinition.content.content.title){i=false;}if(!this._oDefinition.content.variantManagementReference){i=false;}if(!this._oDefinition.content.layer){i=false;}if(!this._oDefinition.content.originalLanguage){i=false;}return i;};
V.prototype.isVariant=function(){return true;};
V.prototype.getDefinitionWithChanges=function(){return this._oDefinition;};
V.prototype.getTitle=function(){if(this._oDefinition){return this._oDefinition.content.content.title;}};
V.prototype.getFileType=function(){if(this._oDefinition){return this._oDefinition.content.fileType;}};
V.prototype.getControlChanges=function(){return this._oDefinition.controlChanges;};
V.prototype.getOriginalLanguage=function(){if(this._oDefinition&&this._oDefinition.content.originalLanguage){return this._oDefinition.content.originalLanguage;}return"";};
V.prototype.getPackage=function(){return this._oDefinition.content.packageName;};
V.prototype.getNamespace=function(){return this._oDefinition.content.namespace;};
V.prototype.setNamespace=function(n){this._oDefinition.content.namespace=n;};
V.prototype.getId=function(){return this._oDefinition.content.fileName;};
V.prototype.getContent=function(){return this._oDefinition.content.content;};
V.prototype.setContent=function(c){this._oDefinition.content.content=c;this.setState(V.states.DIRTY);};
V.prototype.getVariantManagementReference=function(){return this._oDefinition.content.variantManagementReference;};
V.prototype.getVariantReference=function(){return this._oDefinition.content.variantReference;};
V.prototype.getOwnerId=function(){return this._oDefinition.content.support?this._oDefinition.content.support.user:"";};
V.prototype.getText=function(t){if(typeof(t)!=="string"){a.error("sap.ui.fl.Variant.getTexts : sTextId is not defined");}if(this._oDefinition.content.texts){if(this._oDefinition.content.texts[t]){return this._oDefinition.content.texts[t].value;}}return"";};
V.prototype.setText=function(t,n){if(typeof(t)!=="string"){a.error("sap.ui.fl.Variant.setTexts : sTextId is not defined");return;}if(this._oDefinition.content.texts){if(this._oDefinition.content.texts[t]){this._oDefinition.content.texts[t].value=n;this.setState(V.states.DIRTY);}}};
V.prototype.isReadOnly=function(){return this._isReadOnlyDueToLayer()||this._isReadOnlyWhenNotKeyUser();};
V.prototype._isReadOnlyWhenNotKeyUser=function(){if(this.isUserDependent()){return false;}var r=this.getDefinition().reference;if(!r){return true;}var s=S.getInstanceOrUndef();if(!s){return true;}return!s.isKeyUser();};
V.prototype._isReadOnlyDueToLayer=function(){var c;c=L.getCurrentLayer(this._bUserDependent);return(this._oDefinition.content.layer!==c);};
V.prototype._isReadOnlyDueToOriginalLanguage=function(){var c;var o;o=this.getOriginalLanguage();if(!o){return false;}c=U.getCurrentLanguage();return(c!==o);};
V.prototype.markForDeletion=function(){this.setState(V.states.DELETED);};
V.prototype.setRequest=function(r){if(typeof(r)!=="string"){a.error("sap.ui.fl.Variant.setRequest : sRequest is not defined");}this._sRequest=r;};
V.prototype.getRequest=function(){return this._sRequest;};
V.prototype.getLayer=function(){return this._oDefinition.content.layer;};
V.prototype.getComponent=function(){return this._oDefinition.content.reference;};
V.prototype.setComponent=function(c){this._oDefinition.content.reference=c;};
V.prototype.getCreation=function(){return this._oDefinition.content.creation;};
V.prototype.isUserDependent=function(){return(this._bUserDependent);};
V.prototype.getPendingAction=function(){return this.getState();};
V.prototype.getDefinition=function(){return this._oDefinition.content;};
V.prototype.setResponse=function(r){var R=JSON.stringify(r);if(R){this._oDefinition=JSON.parse(R);this._oOriginDefinition=JSON.parse(R);this.setState(V.states.PERSISTED);}};
V.prototype.getFullFileIdentifier=function(){var l=this.getLayer();var n=this.getNamespace();var f=this.getDefinition().content.fileName;var F=this.getDefinition().content.fileType;return l+"/"+n+"/"+f+"."+F;};
V.prototype.getRevertData=function(){return this._vRevertData;};
V.prototype.setRevertData=function(d){this._vRevertData=d;};
V.prototype.resetRevertData=function(){this.setRevertData(null);};
V.createInitialFileContent=function(p){if(!p){p={};}var f=p.content.fileName||U.createDefaultFileName();var n=p.content.namespace||U.createNamespace(p.content,"variants");var N={content:{fileName:f,fileType:"ctrl_variant",variantManagementReference:p.content.variantManagementReference,variantReference:p.content.variantReference||"",reference:p.content.reference||"",packageName:p.content.packageName||"",content:{title:p.content.content.title||""},self:n+f+"."+"ctrl_variant",layer:p.content.layer||L.getCurrentLayer(p.isUserDependent),texts:p.content.texts||{},namespace:n,creation:"",originalLanguage:U.getCurrentLanguage(),conditions:{},support:{generator:p.generator||"Change.createInitialFileContent",service:p.service||"",user:"",sapui5Version:sap.ui.version},validAppVersions:p.content.validAppVersions||{}},controlChanges:p.controlChanges||[],variantChanges:{}};return N;};
return V;},true);
sap.ui.predefine('sap/ui/fl/XmlPreprocessorImpl',["sap/ui/core/Component","sap/ui/fl/FlexControllerFactory","sap/ui/fl/Utils","sap/ui/fl/ChangePersistenceFactory","sap/base/Log"],function(C,F,U,a,L){"use strict";var X=function(){};
X.process=function(v,p){try{if(!p||p.sync){L.warning("Flexibility feature for applying changes on an XML view is only available for "+"asynchronous views; merge is be done later on the JS controls.");return(v);}p.viewId=p.id;var c=C.get(p.componentId);if(!c){L.warning("View is generated without a component. Flexibility features are not possible.");return Promise.resolve(v);}var A=U.getAppComponentForControl(c);if(!U.isApplication(A.getManifestObject())){return Promise.resolve(v);}var f=U.getComponentClassName(A);var s=U.getAppVersionFromManifest(A.getManifest());var o=F.create(f,s);return o.processXmlView(v,p).then(function(){L.debug("flex processing view "+p.id+" finished");return v;}).catch(function(){L.warning("Error happens when getting flex cache key! flexibility XML view preprocessing is skipped. "+"The processing will be done later on the JS controls.");return Promise.resolve(v);});}catch(e){var E="view "+p.id+": "+e;L.info(E);return Promise.resolve(v);}};
X.getCacheKey=function(p){var c=C.get(p.componentId);var A=U.getAppComponentForControl(c);if(U.isVariantByStartupParameter(A)){return Promise.resolve();}var f=U.getComponentClassName(A);var s=U.getAppVersionFromManifest(A.getManifest());var o=a.getChangePersistenceForComponent(f,s);return o.getCacheKey(A);};
return X;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/FlexCustomData',["sap/ui/core/CustomData"],function(){"use strict";var F={};F.appliedChangesCustomDataKey="sap.ui.fl.appliedChanges";F.failedChangesCustomDataKeyJs="sap.ui.fl.failedChanges.js";F.failedChangesCustomDataKeyXml="sap.ui.fl.failedChanges.xml";F.notApplicableChangesCustomDataKey="sap.ui.fl.notApplicableChanges";
F.getAppliedCustomDataValue=function(c,C,m){var a=this._getCustomData(c,m,this._getCustomDataKey(C,F.appliedChangesCustomDataKey));return a.customDataValue;};
F.getParsedRevertDataFromCustomData=function(c,C,m){var s=this.getAppliedCustomDataValue(c,C,m);return s&&JSON.parse(s);};
F.hasChangeApplyFinishedCustomData=function(c,C,m){var a=m.getAggregation(c,"customData")||[];var b=[this._getCustomDataKey(C,F.appliedChangesCustomDataKey),this._getCustomDataKey(C,F.failedChangesCustomDataKeyJs),this._getCustomDataKey(C,F.notApplicableChangesCustomDataKey)];return a.some(function(o){var k=m.getProperty(o,"key");if(b.indexOf(k)>-1){return!!m.getProperty(o,"value");}});};
F.addAppliedCustomData=function(c,C,p,s){var a;var b=this._getCustomDataKey(C,F.appliedChangesCustomDataKey);if(s){a=this._escapeCurlyBracketsInString(JSON.stringify(C.getRevertData()));}else{a="true";}this._writeCustomData(c,b,a,p);};
F.addFailedCustomData=function(c,C,p,i){var s=this._getCustomDataKey(C,i);this._writeCustomData(c,s,"true",p);};
F.destroyAppliedCustomData=function(c,C,m){var k=this._getCustomDataKey(C,F.appliedChangesCustomDataKey);var a=this._getCustomData(c,m,k);if(a.customData){m.destroy(a.customData);}};
F.getCustomDataIdentifier=function(s,e,x){if(s){return F.appliedChangesCustomDataKey;}if(!e){return F.notApplicableChangesCustomDataKey;}if(x){return F.failedChangesCustomDataKeyXml;}return F.failedChangesCustomDataKeyJs;};
F._escapeCurlyBracketsInString=function(t){return t.replace(/{/g,'\\\{').replace(/}/g,'\\\}');};
F._getCustomDataKey=function(c,i){return i+"."+c.getId();};
F._writeCustomData=function(c,k,v,p){var C=this._getCustomData(c,p.modifier,k);if(!C.customData){this._createAndAddCustomDataControl(c,p,k,v);}else{p.modifier.setProperty(C.customData,"value",v);}};
F._createAndAddCustomDataControl=function(c,p,C,v){var m=p.modifier;var V=p.view;var o=p.appComponent;var a=m.createControl("sap.ui.core.CustomData",o,V,undefined,undefined,false);m.setProperty(a,"key",C);m.setProperty(a,"value",v);m.insertAggregation(c,"customData",a,0,V);return a;};
F._getCustomData=function(c,m,C){var a=m.getAggregation(c,"customData")||[];var r={};a.some(function(o){var k=m.getProperty(o,"key");if(k===C){r.customData=o;r.customDataValue=m.getProperty(o,"value");return true;}});return r;};
return F;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/descriptor/Applier',["sap/ui/fl/apply/_internal/changes/descriptor/DescriptorChangeHandlerRegistration","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/performance/Measurement","sap/base/util/UriParameters"],function(D,F,M,a,U){"use strict";var A={preprocessManifest:function(m,c){a.start("flexProcessing","Complete flex processing",["sap.ui.fl"]);var u=new U(window.location.href);var C=u.get("sap-ui-xx-appdescriptor-merger");if(!C){return Promise.resolve(m);}a.start("flexStateInitialize","Initialization of flex state",["sap.ui.fl"]);var r=M.getFlexReference({manifest:m,componentData:c.componentData||{}});return F.initialize({componentData:c.componentData,asyncHints:c.asyncHints,rawManifest:m,componentId:c.id,reference:r}).then(function(){a.end("flexStateInitialize");a.start("flexAppDescriptorMerger","Client side app descriptor merger",["sap.ui.fl"]);var b=F.getAppDescriptorChanges(r);var o=Object.assign({},m);b.forEach(function(d){var s=d.getChangeType();var e=D[s];if(e){o=e.applyChange(o,d);}});a.end("flexAppDescriptorMerger");return o;});}};return A;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/descriptor/DescriptorChangeHandlerRegistration',["sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddLibrary"],function(A){"use strict";var D={appdescr_ui5_addLibraries:A};return D;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddLibrary',["sap/base/util/Version"],function(V){"use strict";
function _(m,c){var u={};if(c.minVersion){var M=new V(m.minVersion);u.minVersion=M.compareTo(c.minVersion)>=0?m.minVersion:c.minVersion;}if(c.lazy){u.lazy=m.lazy===c.lazy===true;}return u;}
var A={applyChange:function(m,c){if(!m["sap.ui5"]["dependencies"]["libs"]){m["sap.ui5"]["dependencies"]["libs"]={};}var M=m["sap.ui5"]["dependencies"]["libs"];var C=c.getContent().libraries;Object.keys(C).forEach(function(l){if(M[l]){m["sap.ui5"]["dependencies"]["libs"][l]=_(M[l],C[l]);}else{m["sap.ui5"]["dependencies"]["libs"][l]=C[l];}});return m;}};return A;},true);
sap.ui.predefine('sap/ui/fl/apply/_internal/flexState/ManifestUtils',["sap/ui/fl/Utils"],function(U){"use strict";
function a(c){if(c&&c.indexOf(".Component")<0){c+=".Component";}return c;}
var M={getFlexReference:function(p){var m=p.manifest;var c=p.componentData;if(c.startupParameters){if(Array.isArray(c.startupParameters["sap-app-id"])){return c.startupParameters["sap-app-id"][0];}}var s=m.getEntry?m.getEntry("sap.ui5"):m["sap.ui5"];if(s){if(s.appVariantId){return s.appVariantId;}if(s.componentName){return a(s.componentName);}}return a(U.getAppIdFromManifest(m));},getCacheKeyFromAsyncHints:function(A,r){if(A&&A.requests&&Array.isArray(A.requests)){var f;A.requests.some(function(o){if(o.name==="sap.ui.fl.changes"&&o.reference===r){f=o;}});if(f){return f.cachebusterToken||"<NO CHANGES>";}}},getBaseComponentNameFromManifest:function(m){var s=m.getEntry?m.getEntry("sap.ui5"):m["sap.ui5"];return s&&s.componentName||U.getAppIdFromManifest(m);}};return M;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/AddIFrame',["sap/ui/fl/changeHandler/common/revertAddedControls","sap/ui/fl/changeHandler/common/getTargetAggregationIndex","sap/ui/fl/changeHandler/common/createIFrame"],function(r,g,c){"use strict";var A={};
A.applyChange=function(C,o,p){var m=p.modifier;var a=C.getDefinition();var v=p.view;var s=a.content.targetAggregation;var b=m.findAggregation(o,s);if(!b){throw new Error("The given Aggregation is not available in the given control: "+m.getId(o));}var i="iframe_"+a.content.baseId;var I=g(C,o,p);var d=c(C,p,i);m.insertAggregation(o,s,d,I,v);C.setRevertData([m.getId(d)]);};
A.revertChange=r;
A.completeChangeContent=function(C,s){var o=C.getDefinition();["targetAggregation","baseId","url"].forEach(function(R){if(!Object.prototype.hasOwnProperty.call(s.content,R)){throw new Error("Attribute missing from the change specific content '"+R+"'");}});o.content=Object.assign(o.content||{},s.content);};
return A;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/AddXML',["sap/ui/fl/Utils","sap/ui/fl/changeHandler/Base","sap/base/util/LoaderExtensions","sap/ui/fl/changeHandler/common/revertAddedControls"],function(U,B,L,r){"use strict";var A={};var d=function(c){c.forEach(function(C){if(C.destroy){C.destroy();}});};
A.applyChange=function(c,C,p){var m=p.modifier;var o=c.getDefinition();var a=o.content.targetAggregation;var n=B.instantiateFragment(c,p);var i=o.content.index;var v=p.view;var b=m.findAggregation(C,a);if(!b){d(n);throw new Error("The given Aggregation is not available in the given control: "+m.getId(C));}var M=c.getModuleName();var f=L.loadResource(M,{dataType:"text"});n.forEach(function(N,I){if(!m.validateType(N,b,C,f,I)){d(n);throw new Error("The content of the xml fragment does not match the type of the targetAggregation: "+b.type);}});n.forEach(function(N,I){m.insertAggregation(C,a,N,i+I,v);});c.setRevertData(n.map(function(e){return m.getId(e);}));return true;};
A.revertChange=r;
A.completeChangeContent=function(c,s){var C=c.getDefinition();var _=function(a){throw new Error("Attribute missing from the change specific content'"+a+"'");};if(!C.content){C.content={};}if(s.fragmentPath){C.content.fragmentPath=s.fragmentPath;}else{_("fragmentPath");}if(s.targetAggregation){C.content.targetAggregation=s.targetAggregation;}else{_("targetAggregation");}if(s.index!==undefined){C.content.index=s.index;}else{_("index");}var g=function(C){var m=C.reference.replace(/\./g,"/");m+="/changes/";m+=C.content.fragmentPath.replace(/\.fragment\.xml/g,"");return m;};var m=g(C);c.setModuleName(m);};
return A;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/Base',["sap/base/util/LoaderExtensions"],function(L){"use strict";var B={setTextInChange:function(c,k,t,T){if(!c.texts){c.texts={};}if(!c.texts[k]){c.texts[k]={};}c.texts[k].value=t;c.texts[k].type=T;},instantiateFragment:function(c,p){var m=c.getModuleName();if(!m){throw new Error("The module name of the fragment is not set. This should happen in the backend");}var M=p.modifier;var v=p.view;var f=L.loadResource(m,{dataType:"text"});var n=c.getProjectId();try{return M.instantiateFragment(f,n,v);}catch(e){throw new Error("The following XML Fragment could not be instantiated: "+f+" Reason: "+e.message);}},markAsNotApplicable:function(n,a){var r={message:n};if(!a){throw r;}return Promise.reject(r);}};return B;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/BaseRename',["sap/ui/fl/changeHandler/Base","sap/base/Log"],function(B,L){"use strict";var a={createRenameChangeHandler:function(r){r.changePropertyName=r.changePropertyName||"newText";return{applyChange:function(c,C,p){var m=p.modifier;var P=r.propertyName;var o=c.getDefinition();var t=o.texts[r.changePropertyName];var v=t.value;if(o.texts&&t&&typeof(v)==="string"){c.setRevertData(m.getPropertyBindingOrProperty(C,P));m.setPropertyBindingOrProperty(C,P,v);return true;}L.error("Change does not contain sufficient information to be applied: ["+o.layer+"]"+o.namespace+"/"+o.fileName+"."+o.fileType);},revertChange:function(c,C,p){var m=p.modifier;var P=r.propertyName;var o=c.getRevertData();if(o||o===""){m.setPropertyBindingOrProperty(C,P,o);c.resetRevertData();return true;}L.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.");},completeChangeContent:function(c,s,p){var C=c.getDefinition();var b=r.changePropertyName;var t=r.translationTextType;var o=p.modifier.bySelector(c.getSelector(),p.appComponent);C.content.originalControlType=p.modifier.getControlType(o);if(typeof(s.value)==="string"){B.setTextInChange(C,b,s.value,t);}else{throw new Error("oSpecificChangeInfo.value attribute required");}}};}};return a;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/BaseTreeModifier',["sap/ui/core/util/reflection/BaseTreeModifier"],function(B){"use strict";return B;});
sap.ui.predefine('sap/ui/fl/changeHandler/ChangeHandlerMediator',["sap/base/Log","sap/base/strings/capitalize","sap/ui/fl/registry/ChangeHandlerRegistration"],function(L,c,C){"use strict";var a={};a._aChangeHandlerSettings=[];["addODataField","addODataFieldWithLabel"].forEach(function(s){["2.0","1.0"].forEach(function(v){a._aChangeHandlerSettings.push({key:{scenario:s,oDataServiceVersion:v},content:{requiredLibraries:{"sap.ui.comp":{minVersion:"1.48",lazy:false}}},scenarioInitialized:false});});});
a.addChangeHandlerSettings=function(k,s){var n;if(!(k&&s)){throw new Error('New entry in ChangeHandlerMediator requires a key and settings');}n={key:k,content:s,scenarioInitialized:false};return this.getChangeHandlerSettings(k,true).then(function(e){var i=this._aChangeHandlerSettings.indexOf(e);if(i>-1){Object.assign(this._aChangeHandlerSettings[i].content,n.content);this._aChangeHandlerSettings[i].scenarioInitialized=false;}else{this._aChangeHandlerSettings.push(n);return this._createChangeHandlerSettingsGetter(n);}}.bind(this));};
a.getChangeHandlerSettings=function(k,s){var K=Object.keys(k);var f;if(K.length>0){f=this._aChangeHandlerSettings.filter(function(e){var E=Object.keys(e.key);if(E.length===K.length){var m=K.filter(function(b){if(e.key[b]===k[b]){return true;}});if(m.length===K.length){return true;}}})[0];if(!s&&f&&!f.scenarioInitialized){return this._initializeScenario(f).then(function(){return f;}).catch(function(){return undefined;});}}return Promise.resolve(f);};
a._initializeScenario=function(f){var l=[];if(f.content.requiredLibraries){var b=Object.keys(f.content.requiredLibraries);b.forEach(function(s){var d=s;var o=sap.ui.getCore().loadLibrary(s,{async:true}).catch(function(){L.warning("Required library not available: "+d+" - "+f.key.scenario+" could not be initialized");return Promise.reject();}).then(function(){return C.waitForChangeHandlerRegistration(d);});l.push(o);});return Promise.all(l).then(function(){f.scenarioInitialized=true;});}return Promise.resolve();};
a._createChangeHandlerSettingsGetter=function(m){var g='get'+c(m.key.scenario)+'Settings';if(!a[g]){a[g]=function(o){var O;try{O=o.getModel().getMetaModel().getProperty("/dataServices/dataServiceVersion");}catch(e){L.warning("Data service version could not be retrieved");}return this.getChangeHandlerSettings({scenario:m.key.scenario,oDataServiceVersion:O}).then(function(f){if(f&&f.content&&f.content.createFunction){return f;}});};}};
a._aChangeHandlerSettings.forEach(function(m){a._createChangeHandlerSettingsGetter(m);});return a;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/HideControl',["sap/base/Log"],function(L){"use strict";var H={};
H.applyChange=function(c,C,p){c.setRevertData({originalValue:p.modifier.getVisible(C)});p.modifier.setVisible(C,false);return true;};
H.revertChange=function(c,C,p){var r=c.getRevertData();if(r){p.modifier.setVisible(C,r.originalValue);c.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");return false;}return true;};
H.completeChangeContent=function(){};
return H;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/JsControlTreeModifier',["sap/ui/core/util/reflection/JsControlTreeModifier"],function(J){"use strict";return J;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/MoveControls',["sap/base/Log"],function(L){"use strict";var M={};M.SOURCE_ALIAS="source";M.TARGET_ALIAS="target";M.MOVED_ELEMENTS_ALIAS="movedElements";
M._checkConditions=function(c,m,v,a){if(!c){throw new Error("No change instance");}var C=c.getContent();if(!C||!C.movedElements||C.movedElements.length===0){throw new Error("Change format invalid");}if(!C.source||!C.source.selector){throw new Error("No source supplied for move");}if(!C.target||!C.target.selector){throw new Error("No target supplied for move");}if(!m.bySelector(C.source.selector,a,v)){throw new Error("Move source parent not found");}if(!m.bySelector(C.target.selector,a,v)){throw new Error("Move target parent not found");}if(!C.source.selector.aggregation){throw new Error("No source aggregation supplied for move");}if(!C.target.selector.aggregation){throw new Error("No target aggregation supplied for move");}};
M._getElementControlOrThrowError=function(m,o,a,v){if(!m.selector&&!m.id){throw new Error("Change format invalid - moveElements element has no id attribute");}if(typeof m.targetIndex!=="number"){throw new Error("Missing targetIndex for element with id '"+m.selector.id+"' in movedElements supplied");}var c=o.bySelector(m.selector||m.id,a,v);if(!c){throw new Error("Control to move was not found. Id: '"+m.selector.id+"'");}return c;};
M._checkCompleteChangeContentConditions=function(s){if(!s.movedElements){throw new Error("mSpecificChangeInfo.movedElements attribute required");}if(s.movedElements.length===0){throw new Error("MovedElements array is empty");}s.movedElements.forEach(function(e){if(!e.id){throw new Error("MovedControls element has no id attribute");}if(typeof(e.sourceIndex)!=="number"){throw new Error("SourceIndex attribute at MovedElements element is no number");}if(typeof(e.targetIndex)!=="number"){throw new Error("TargetIndex attribute at MovedElements element is no number");}});};
M._getSpecificChangeInfo=function(m,s,a){delete s.source.publicAggregation;delete s.target.publicAggregation;var S=s.source.parent||m.bySelector(s.source.id,a);var t=s.target.parent||m.bySelector(s.target.id,a);var b=s.source.aggregation;var T=s.target.aggregation;var A={aggregation:s.source.aggregation,type:m.getControlType(S)};var c={aggregation:s.target.aggregation,type:m.getControlType(t)};var d={source:{id:S.getId(),aggregation:b,type:A.type,selector:m.getSelector(s.source.id,a,A)},target:{id:t.getId(),aggregation:T,type:c.type,selector:m.getSelector(s.target.id,a,c)},movedElements:s.movedElements};return d;};
M.applyChange=function(c,r,p){var m=p.modifier;var v=p.view;var a=p.appComponent;this._checkConditions(c,m,v,a);var C=c.getContent();var s=p.sourceAggregation||C.source.selector.aggregation;var t=p.targetAggregation||C.target.selector.aggregation;var S=m.bySelector(C.source.selector,a,v);var T=m.bySelector(C.target.selector,a,v);var R=[];C.movedElements.forEach(function(b){var o=this._getElementControlOrThrowError(b,m,a,v);var i=m.findIndexInParentAggregation(o);var I=b.targetIndex;if(i>-1){if(i===I){i=b.sourceIndex;}else{s=p.sourceAggregation||m.getParentAggregationName(o,S);S=m.getParent(o);}R.unshift({index:i,aggregation:s,sourceParent:m.getSelector(S,a)});}m.removeAggregation(S,s,o);m.insertAggregation(T,t,o,I,v);},this);c.setRevertData(R);return true;};
M.revertChange=function(c,r,p){var m=p.modifier;var v=p.view;var a=p.appComponent;this._checkConditions(c,m,v,a);var C=c.getContent();var s=m.bySelector(C.source.selector,a,v);var S=C.source.selector.aggregation;var t=m.bySelector(C.target.selector,a,v);var T=C.target.selector.aggregation;var R=c.getRevertData();c.getContent().movedElements.reverse();C.movedElements.forEach(function(b,e){var o=this._getElementControlOrThrowError(b,m,a,v);if(!o){L.warning("Element to move not found");return;}var i=b.sourceIndex;if(R){var d=R[e];S=d.aggregation;i=d.index;s=m.bySelector(d.sourceParent,a,v);}m.removeAggregation(t,T,o);m.insertAggregation(s,S,o,i,v);},this);c.resetRevertData();return true;};
M.completeChangeContent=function(c,s,p){this._checkCompleteChangeContentConditions(s);var m=p.modifier;var a=p.appComponent;var C=c.getDefinition();s=this._getSpecificChangeInfo(m,s,a);C.content={movedElements:[],source:{selector:s.source.selector},target:{selector:s.target.selector}};s.movedElements.forEach(function(e){var E=e.element||m.bySelector(e.id,a);C.content.movedElements.push({selector:m.getSelector(E,a),sourceIndex:e.sourceIndex,targetIndex:e.targetIndex});});c.addDependentControl(s.source.id,M.SOURCE_ALIAS,p);c.addDependentControl(s.target.id,M.TARGET_ALIAS,p);c.addDependentControl(s.movedElements.map(function(e){return e.id;}),M.MOVED_ELEMENTS_ALIAS,p);};
return M;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/MoveElements',["sap/base/Log"],function(L){"use strict";var M={};M.CHANGE_TYPE="moveElements";
M.applyChange=function(c,s,p){function a(c,m,v,A){if(!c){throw new Error("No change instance");}var C=c.getContent();if(!C||!C.movedElements||C.movedElements.length===0){throw new Error("Change format invalid");}if(!c.getSelector().aggregation){throw new Error("No source aggregation supplied via selector for move");}if(!C.target||!C.target.selector){throw new Error("No target supplied for move");}if(!m.bySelector(C.target.selector,A,v)){throw new Error("Move target parent not found");}if(!C.target.selector.aggregation){throw new Error("No target aggregation supplied for move");}}function g(b,m,A,v){if(!b.selector&&!b.id){throw new Error("Change format invalid - moveElements element has no id attribute");}if(typeof b.targetIndex!=="number"){throw new Error("Missing targetIndex for element with id '"+b.selector.id+"' in movedElements supplied");}return m.bySelector(b.selector||b.id,A,v);}var m=p.modifier;var v=p.view;var A=p.appComponent;a(c,m,v,A);var C=c.getContent();var t=m.bySelector(C.target.selector,A,v);var S=c.getSelector().aggregation;var T=C.target.selector.aggregation;C.movedElements.forEach(function(b){var o=g(b,m,A,v);if(!o){L.warning("Element to move not found");return;}m.removeAggregation(s,S,o);m.insertAggregation(t,T,o,b.targetIndex,v);});return true;};
M.completeChangeContent=function(){throw new Error('Using deprecated change handler. Please consider of using \'MoveControls\' instead');};
M.getSpecificChangeInfo=function(m,s){var S=s.source.parent||m.bySelector(s.source.id);var t=s.target.parent||m.bySelector(s.target.id);var a=s.source.aggregation;var T=s.target.aggregation;var b={source:{id:S.getId(),aggregation:a,type:m.getControlType(S)},target:{id:t.getId(),aggregation:T,type:m.getControlType(t)},movedElements:s.movedElements};return b;};
return M;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/PropertyBindingChange',["sap/base/Log"],function(L){"use strict";var P={};
P.applyChange=function(c,C,p){var d=c.getDefinition();var s=d.content.property;var v=d.content.newBinding;var m=p.modifier;var o=m.getPropertyBindingOrProperty(C,s);c.setRevertData({originalValue:o});m.setPropertyBinding(C,s,v);};
P.revertChange=function(c,C,p){var r=c.getRevertData();if(r){var d=c.getDefinition();var s=d.content.property;var v=r.originalValue;var m=p.modifier;m.setPropertyBindingOrProperty(C,s,v);c.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");return false;}return true;};
P.completeChangeContent=function(c,s){var C=c.getDefinition();if(!s.content){throw new Error("oSpecificChangeInfo attribute required");}C.content=s.content;};
return P;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/PropertyChange',["sap/ui/thirdparty/jquery","sap/ui/fl/Utils","sap/base/Log"],function(q,F,L){"use strict";var P={};
function i(p){return F.isBinding(p)||q.isPlainObject(p);}
function c(C,p,v,m){try{if(i(v)){m.setPropertyBinding(C,p,v);}else{m.setProperty(C,p,v);}}catch(e){throw new Error("Applying property changes failed: "+e);}}
P.applyChange=function(C,o,p){var d=C.getDefinition();var s=d.content.property;var v=d.content.newValue;var m=p.modifier;C.setRevertData({originalValue:m.getPropertyBindingOrProperty(o,s)});c(o,s,v,m);};
P.revertChange=function(C,o,p){var r=C.getRevertData();if(r){var d=C.getDefinition();var s=d.content.property;var v=r.originalValue;var m=p.modifier;c(o,s,v,m);C.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");return false;}return true;};
P.completeChangeContent=function(C,s){var o=C.getDefinition();if(!s.content){throw new Error("oSpecificChangeInfo attribute required");}o.content=s.content;};
return P;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/StashControl',["sap/base/Log"],function(L){"use strict";var S={};
S.applyChange=function(c,C,p){var s=p.modifier.getStashed(C);var o=p.modifier.findIndexInParentAggregation(C);this.setChangeRevertData(c,s,o);p.modifier.setStashed(C,true);return true;};
S.revertChange=function(c,C,p){var r=c.getRevertData();if(r){var u=p.modifier.setStashed(C,r.originalValue,p.appComponent);if(u){var U=p.modifier.findIndexInParentAggregation((u));if(U!==r.originalIndex){var P=p.modifier.getParent(u);var a=p.modifier.getParentAggregationName(u);p.modifier.removeAggregation(P,a,u);p.modifier.insertAggregation(P,a,u,r.originalIndex);}}c.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");return false;}return true;};
S.completeChangeContent=function(){};
S.setChangeRevertData=function(c,v,o){c.setRevertData({originalValue:v,originalIndex:o});};
return S;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/UnhideControl',["sap/base/Log"],function(L){"use strict";var U={};
U.applyChange=function(c,C,p){c.setRevertData({originalValue:p.modifier.getProperty(C,'visible')});p.modifier.setVisible(C,true);return true;};
U.revertChange=function(c,C,p){var r=c.getRevertData();if(r){p.modifier.setVisible(C,r.originalValue);c.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");return false;}return true;};
U.completeChangeContent=function(){};
return U;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/UnstashControl',["sap/base/Log"],function(L){"use strict";var U={};
U.applyChange=function(c,C,p){var m=c.getContent();var M=p.modifier;var s=false;c.setRevertData({originalValue:p.modifier.getStashed(C)});var u=M.setStashed(C,s,p.appComponent)||C;if(m.parentAggregationName){var t=m.parentAggregationName;var T=M.getParent(u);M.removeAggregation(T,t,u);M.insertAggregation(T,t,u,m.index,p.view);}return u;};
U.revertChange=function(c,C,p){var r=c.getRevertData();if(r){p.modifier.setStashed(C,r.originalValue);c.resetRevertData();}else{L.error("Attempt to revert an unapplied change.");return false;}return true;};
U.completeChangeContent=function(c,s){var C=c.getDefinition();if(s.content){C.content=s.content;}};
return U;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/UpdateIFrame',[],function(){"use strict";var U={};var u=["width","height","url"];
function g(m,i){var s={};u.forEach(function(p){var v=m.getProperty(i,p);if(v!==undefined){s[p]=v;}});return s;}
U.applyChange=function(c,C,p){var m=p.modifier;var o=c.getDefinition();var a=m.getControlMetadata(C);if(a.getName()!=="sap.ui.fl.util.IFrame"){throw new Error("UpdateIFrame only for sap.ui.fl.util.IFrame");}c.setRevertData({originalSettings:g(m,C)});m.applySettings(C,o.settings);};
U.revertChange=function(c,C,p){var r=c.getRevertData();if(r){p.modifier.applySettings(C,r.originalSettings);c.resetRevertData();}else{throw new Error("Attempt to revert an unapplied change.");}};
U.completeChangeContent=function(c,s){var C=c.getDefinition();if(!s.content||!Object.keys(s.content).some(function(p){return u.indexOf(p)!==-1;})){throw new Error("oSpecificChangeInfo attribute required");}C.settings=s.content;};
return U;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/XmlTreeModifier',["sap/ui/core/util/reflection/XmlTreeModifier"],function(X){"use strict";return X;},true);
sap.ui.predefine('sap/ui/fl/changeHandler/common/createIFrame',["sap/ui/fl/util/IFrame"],function(){"use strict";return function(c,p,i){var m=p.modifier;var C=c.getDefinition();var v=p.view;var o=p.appComponent;var I={};["url","width","height"].forEach(function(s){I[s]=C.content[s];});var a=m.createControl("sap.ui.fl.util.IFrame",o,v,i,I,false);return a;};});
sap.ui.predefine('sap/ui/fl/changeHandler/common/getTargetAggregationIndex',[],function(){"use strict";return function(c,C,p){var m=p.modifier;var o=c.getDefinition();var a=o.content.targetAggregation;var i=o.content.index;if(i===undefined){var A=m.getAggregation(C,a);i=A.length;}return i;};});
sap.ui.predefine('sap/ui/fl/changeHandler/common/revertAddedControls',["sap/ui/fl/Utils"],function(U){"use strict";return function(c,C,p){var m=p.modifier;var o=c.getDefinition();var a=o.content.targetAggregation;var v=p.view||U.getViewForControl(C);var A=p.appComponent;var r=c.getRevertData()||[];var b=r.map(function(i){return m.bySelector(i,A,v)||v&&v.createId&&m.bySelector(v.createId(i));});b.forEach(function(d){m.removeAggregation(C,a,d);if(d.destroy){d.destroy();}});c.resetRevertData();return true;};});
sap.ui.predefine('sap/ui/fl/codeExt/CodeExtManager',["sap/ui/fl/LrepConnector","sap/ui/fl/write/_internal/CompatibilityConnector","sap/ui/fl/Change"],function(L,C,a){"use strict";var b;b={_oLrepConnector:L.createConnector(),createOrUpdateCodeExtChange:function(p,o){if(!p.content||!p.content.codeRef){throw new Error("no code reference passed for the code extension change");}if(!p.selector||!p.selector.id){throw new Error("no controller name passed for the code extension change");}if(!p.reference){throw new Error("no reference passed for the code extension change");}p.changeType=p.changeType||"codeExt";var c=a.createInitialFileContent(p);var u="/sap/bc/lrep/content/"+c.namespace+c.fileName+".change";u+="?layer="+c.layer;if(o){if(o.transportId){u+="&changelist="+o.transportId;}if(o.packageName){u+="&package="+o.packageName;}}var m="PUT";return this._oLrepConnector.send(u,m,c,{});},createCodeExtChanges:function(c,o){c=c||[];if(c.length===0){return Promise.resolve();}var p=[];c.forEach(function(d){d.changeType=d.changeType||"codeExt";d.packageName=o.packageName;d.content={codeRef:o.codeRef};p.push(a.createInitialFileContent(d));});return C.create(p,o.transportId);},deleteCodeExtChange:function(c,o){if(c.changeType!=="codeExt"||c.fileType!=="change"){throw new Error("the change is not of type 'code extension'");}if(!c.fileName){throw new Error("the extension does not contains a file name");}if(c.namespace===undefined){throw new Error("the extension does not contains a namespace");}var u="/sap/bc/lrep/content/"+c.namespace+c.fileName+".change";if(c.layer){u+="&layer="+c.layer;}if(o){if(o.transportId){u+="&changelist="+o.transportId;}if(o.packageName){u+="&package="+o.packageName;}}u=u.replace("&","?");var m="DELETE";return this._oLrepConnector.send(u,m,c,{});}};return b;},true);
sap.ui.predefine('sap/ui/fl/context/BaseContextProvider',["sap/ui/base/ManagedObject"],function(M){"use strict";
var B=M.extend("sap.ui.fl.context.BaseContextProvider",{metadata:{properties:{text:{type:"String"},description:{type:"String"}}}});
B.prototype.loadData=function(){return Promise.resolve({});};
B.prototype.getValue=function(r){return this.loadData().then(function(d){var R=r&&r.split(".")||[];var m=R.reduce(function(c,C){if(c&&c.hasOwnProperty(C)){return c[C];}return undefined;},d);return m;});};
B.prototype.getValueHelp=function(){return Promise.resolve({});};
B.prototype.validate=function(){return Promise.resolve(true);};
return B;});
sap.ui.predefine('sap/ui/fl/context/Context',['sap/ui/base/ManagedObject',"sap/base/Log"],function(M,L){"use strict";
var C=M.extend("sap.ui.fl.context.Context",{metadata:{library:"sap.ui.fl",properties:{configuration:{type:"object"},content:{type:"object"}},aggregations:{contextProviders:{type:"object",multiple:true}},events:{}}});
C.prototype.getValue=function(R){return this._getProviderContent(R,"getValue");};
C.prototype.getValueHelp=function(R){return this._getProviderContent(R,"getValueHelp");};
var r=function(d,R){if(d.indexOf(R)!==-1){return undefined;}if(R.indexOf(d+".")!==-1){return R.substring(d.length+1);}throw new Error("Invalid request for sap.ui.fl.context - domain:"+d+"request:"+R);};
C.prototype._getProviderContent=function(R,p){var t=this;var P=[];var a=[];var h=function(s){var A=t._assureDomain(s);if(A){var o=t._loadProvider(A);P.push(o);a.push({domain:A,request:r(A,s)});}else{a.push({domain:undefined,request:s});}};var m=function(D){var c=t.getConfiguration();var b=false;for(var i=0;i<D.length;i++){var o=D[i];if(o){c[o.domain]=o.provider;b=true;}}if(b){t.setConfiguration(c);}};if(R instanceof Array){R.forEach(function(s){h(s);});}else if(R===undefined){for(var d in this.getConfiguration()){P.push(this._loadProvider(d));}a=Object.keys(this.getConfiguration()).map(function(d){return{domain:d,request:undefined};});}return Promise.all(P).then(m).then(function(){return t._mergeProviderContent(a,p);});};
C.prototype._assureDomain=function(d){var c=this.getConfiguration();if(c.hasOwnProperty(d)){return d;}var k=Object.keys(c);for(var i=0;i<k.length;i++){var K=k[i];if(d.indexOf(K)===0||K.indexOf(d)===0){return K;}}return null;};
C.prototype._loadProvider=function(d){var a=this.getConfiguration()[d];if(typeof(a)==="string"){return new Promise(function(b){try{sap.ui.require([a],function(P){var p=new P();b({domain:d,provider:p});},function(e){L.error(e);b();return;});}catch(e){L.error(e);b();return;}});}return Promise.resolve();};
C.prototype._mergeProviderContent=function(R,p){var P=[];var c=this.getConfiguration();R.forEach(function(o){if(c.hasOwnProperty(o.domain)){var a=c[o.domain];if(a instanceof sap.ui.fl.context.BaseContextProvider){P.push(a[p](o.request).then(function(v){var s={};var b=o.domain;if(o.request){b=b+"."+o.request;}s[b]=v;return s;}));}}else{var s={};s[o.request]=undefined;P.push(Promise.resolve(s));}});return Promise.all(P).then(function(a){return a.reduce(function(m,b){var k=Object.keys(b)[0];m[k]=b[k];return m;},{});});};
return C;});
sap.ui.predefine('sap/ui/fl/context/ContextManager',["sap/ui/fl/LrepConnector","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/context/Context","sap/base/Log"],function(L,U,a,C,b){"use strict";var c;c={_oContext:new C({configuration:{device:"sap/ui/fl/context/DeviceContextProvider",switches:"sap/ui/fl/context/SwitchContextProvider"}}),_oLrepConnector:L.createConnector(),doesContextMatch:function(o,A){var s=o.context||"";if(!s){return true;}return A&&A.indexOf(s)!==-1;},getActiveContexts:function(d){var D=this._getContextIdsFromUrl();if(D.length===0){return this._getContextParametersFromAPI(d).then(this._getActiveContextsByAPIParameters.bind(this,d));}return Promise.resolve(this._getActiveContextsByUrlParameters(d,D));},_getContextParametersFromAPI:function(d){var r=[];d.forEach(function(o){o.parameters.forEach(function(e){var s=e.selector;if(r.indexOf(s)===-1){r.push(s);}});});return this._oContext.getValue(r);},_getActiveContextsByAPIParameters:function(d,r){var t=this;var A=[];d.forEach(function(o){if(t._isContextObjectActive(o,r)){A.push(o.id);}});return A;},_getActiveContextsByUrlParameters:function(d,D){var A=[];d.forEach(function(o){var e=((D?Array.prototype.indexOf.call(D,o.id):-1))!==-1;if(e){A.push(o.id);}});return A;},_isContextObjectActive:function(o,r){var t=this;var d=true;var p=o.parameters;p.every(function(P){d=d&&t._checkContextParameter(P,r);return d;});return d;},_getContextIdsFromUrl:function(){var s=U.getUrlParameter("sap-ui-flexDesignTimeContext");if(!s){return[];}return s.split(",");},_checkContextParameter:function(p,r){var s=p.selector;var o=p.operator;var v=p.value;switch(o){case"EQ":return this._checkEquals(s,v,r);case"NE":return!this._checkEquals(s,v,r);default:b.info("A context within a flexibility change with the operator '"+o+"' could not be verified");return false;}},_checkEquals:function(s,v,r){return r[s]===v;},createOrUpdateContextObject:function(p){if(!p.reference){throw new Error("no reference passed for the context object");}if(!p.namespace){throw new Error("no namespace passed for the context object");}var i=p.id||U.createDefaultFileName();p={id:i,fileName:i,title:p.title||"",description:p.description||"",parameters:p.parameters||[],fileType:"context",reference:p.reference||"",packageName:p.packageName||"",layer:p.layer||a.getCurrentLayer(false),namespace:p.namespace,creation:p.creation||"",originalLanguage:p.originalLanguage||U.getCurrentLanguage(),support:p.support||{generator:p.generator||"",service:"",user:""},validAppVersions:p.validAppVersions||{}};var u="/sap/bc/lrep/content/"+p.namespace+p.fileName+".context";u+="?layer="+p.layer;var m="PUT";return this._oLrepConnector.send(u,m,p,{});}};return c;},true);
sap.ui.predefine('sap/ui/fl/context/DeviceContextProvider',["sap/ui/fl/context/BaseContextProvider","sap/ui/Device"],function(B,D){"use strict";
var a=B.extend("sap.ui.fl.context.DeviceContextProvider",{metadata:{properties:{text:{type:"String",defaultValue:"Device"},description:{type:"String",defaultValue:"Returns the values of sap.ui.Device"}}}});
a.prototype.loadData=function(){return Promise.resolve(D);};
a.prototype.getValueHelp=function(){return Promise.resolve({});};
a.prototype.validate=function(){return Promise.resolve(true);};
return a;});
sap.ui.predefine('sap/ui/fl/context/SwitchContextProvider',["sap/ui/fl/context/BaseContextProvider"],function(B){"use strict";
var S=B.extend("sap.ui.fl.context.SwitchContextProvider",{metadata:{properties:{text:{type:"String",defaultValue:"Switch"},description:{type:"String",defaultValue:"Returns the values of switches received in the flexibility response from the back end"}}}});
S.prototype.loadData=function(){return Promise.resolve({});};
S.prototype.getValueHelp=function(){return Promise.resolve({});};
S.prototype.validate=function(){return Promise.resolve(true);};
return S;});
sap.ui.predefine('sap/ui/fl/descriptorRelated/api/DescriptorChangeFactory',["sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/Change","sap/ui/fl/descriptorRelated/internal/Utils","sap/ui/fl/registry/Settings","sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/base/util/merge"],function(C,a,U,S,F,L,b){"use strict";var D=function(m,i,s){this._mChangeFile=m;this._mChangeFile.packageName='$TMP';this._oInlineChange=i;this._sTransportRequest=null;this._oSettings=s;};
D.prototype.setTransportRequest=function(t){try{U.checkTransportRequest(t);}catch(e){return Promise.reject(e);}this._sTransportRequest=t;return Promise.resolve();};
D.prototype.setPackage=function(p){try{U.checkPackage(p);}catch(e){return Promise.reject(e);}this._mChangeFile.packageName=p;return Promise.resolve();};
D.prototype.submit=function(){this.store();var o=this._getChangePersistence(this._mChangeFile.reference);return o.saveDirtyChanges();};
D.prototype.store=function(){var s=this._mChangeFile.reference;var A=this._mChangeFile.validAppVersions.creation;var o=this._getChangePersistence(s,A);var d=this._getChangeToSubmit();o.addChange(d);return d;};
D.prototype._getChangePersistence=function(s,A){return C.getChangePersistenceForComponent(s,A);};
D.prototype._getChangeToSubmit=function(){var o=new a(this._getMap());if(this._sTransportRequest){o.setRequest(this._sTransportRequest);}else if(this._oSettings.isAtoEnabled()&&L.isCustomerDependentLayer(this._mChangeFile.layer)){o.setRequest('ATO_NOTIFICATION');}return o;};
D.prototype._getMap=function(){var i=this._oInlineChange.getMap();this._mChangeFile.content=i.content;this._mChangeFile.texts=i.texts;return this._mChangeFile;};
D.prototype.getJson=function(){return b({},this._getMap());};
var c=function(){};
c.prototype.createNew=function(r,i,l,A,t){var s=function(_,I){if(_["setHostingIdForTextKey"]){_.setHostingIdForTextKey(I);}};s(i,r);var d;if(A){d=A.appVersion;if(!A.appId&&!d){var m=A.getManifest();d=F.getAppVersionFromManifest(m);}}var p={};p.changeType=i._getChangeType();p.componentName=r;p.reference=r;p.validAppVersions=d?{creation:d,from:d}:{};p.generator=t;p.layer=l||'CUSTOMER';var e=a.createInitialFileContent(p);return S.getInstance().then(function(o){return Promise.resolve(new D(e,i,o));});};
return c;},true);
sap.ui.predefine('sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory',["sap/ui/fl/descriptorRelated/internal/Utils"],function(U){"use strict";var D=function(c,p,t){U.checkTexts(t);this._mParameters={};this._mParameters.changeType=c;this._mParameters.content=p;this._mParameters.texts=t;};
D.prototype._getChangeType=function(){return this._mParameters.changeType;};
D.prototype.getMap=function(){return this._mParameters;};
D.prototype.getContent=function(){return this._mParameters.content;};
D.prototype.getTexts=function(){return this._mParameters.texts;};
D.prototype.replaceHostingIdForTextKey=function(n,o,c,t){var C=JSON.stringify(c);if(t){Object.keys(t).forEach(function(s){var b;if(s.indexOf(o)===0){b=n+s.substring(o.length);this._mParameters.texts[b]=this._mParameters.texts[s];delete this._mParameters.texts[s];C=C.split("{{"+s+"}}").join("{{"+b+"}}");}},this);this._mParameters.content=JSON.parse(C);}};
var a={};
a.getDescriptorChangeTypes=function(){return["appdescr_ovp_addNewCard","appdescr_ovp_removeCard","appdescr_ovp_changeCard","appdescr_app_addNewInbound","appdescr_app_changeInbound","appdescr_app_removeInbound","appdescr_app_removeAllInboundsExceptOne","appdescr_app_addNewOutbound","appdescr_app_changeOutbound","appdescr_app_removeOutbound","appdescr_app_addNewDataSource","appdescr_app_changeDataSource","appdescr_app_removeDataSource","appdescr_app_addAnnotationsToOData","appdescr_app_addTechnicalAttributes","appdescr_app_removeTechnicalAttributes","appdescr_app_setTitle","appdescr_app_setSubTitle","appdescr_app_setShortTitle","appdescr_app_setDescription","appdescr_app_setInfo","appdescr_app_setDestination","appdescr_app_setKeywords","appdescr_app_setAch","appdescr_app_addCdsViews","appdescr_app_removeCdsViews","appdescr_flp_setConfig","appdescr_ui5_addNewModel","appdescr_ui5_addNewModelEnhanceWith","appdescr_ui5_removeModel","appdescr_ui5_replaceComponentUsage","appdescr_ui5_setMinUI5Version","appdescr_smb_addNamespace","appdescr_smb_changeNamespace","appdescr_ui_generic_app_setMainPage","appdescr_ui_setIcon","appdescr_ui_setDeviceTypes","appdescr_ui5_addLibraries","appdescr_url_setUri","appdescr_fiori_setRegistrationIds"];};
a.getCondensableDescriptorChangeTypes=function(){return["appdescr_app_setTitle","appdescr_app_setInfo","appdescr_app_setShortTitle","appdescr_app_setSubTitle","appdescr_app_setDescription","appdescr_app_setDestination","appdescr_app_setKeywords","appdescr_app_setAch","appdescr_ui_setIcon","appdescr_ui_setDeviceTypes","appdescr_ui_setIcon","appdescr_ui_setDeviceTypes","appdescr_fiori_setRegistrationIds","appdescr_smb_changeNamespace"];};
a.createNew=function(c,p,t){var d=new D(c,p,t);return new Promise(function(r,b){if(d){r(d);}else{var e={};b(e);}});};
a._createDescriptorInlineChange=function(d,p,t){var o=new D(d,p,t);return new Promise(function(r,b){if(o){r(o);}else{var e={};b(e);}});};
a.createDescriptorInlineChange=function(d,p,t){var f=d.replace("appdescr","create");return this[f](p,t);};
a.create_ovp_addNewCard=function(p,t){U.checkParameterAndType(p,"card","object");return this._createDescriptorInlineChange('appdescr_ovp_addNewCard',p,t);};
a.create_ovp_removeCard=function(p){U.checkParameterAndType(p,"cardId","string");return this._createDescriptorInlineChange('appdescr_ovp_removeCard',p);};
a.create_ovp_changeCard=function(p,t){U.checkParameterAndType(p,"cardId","string");U.checkEntityPropertyChange(p);return this._createDescriptorInlineChange('appdescr_ovp_changeCard',p,t);};
a.create_app_addNewInbound=function(p,t){U.checkParameterAndType(p,"inbound","object");return this._createDescriptorInlineChange('appdescr_app_addNewInbound',p,t);};
a.create_app_removeInbound=function(p){U.checkParameterAndType(p,"inboundId","string");return this._createDescriptorInlineChange('appdescr_app_removeInbound',p);};
a.create_app_removeAllInboundsExceptOne=function(p){U.checkParameterAndType(p,"inboundId","string");return this._createDescriptorInlineChange('appdescr_app_removeAllInboundsExceptOne',p);};
a.create_app_changeInbound=function(p,t){U.checkParameterAndType(p,"inboundId","string");U.checkEntityPropertyChange(p);return this._createDescriptorInlineChange('appdescr_app_changeInbound',p,t);};
a.create_app_addNewOutbound=function(p){U.checkParameterAndType(p,"outbound","object");return this._createDescriptorInlineChange('appdescr_app_addNewOutbound',p);};
a.create_app_removeOutbound=function(p){U.checkParameterAndType(p,"outboundId","string");return this._createDescriptorInlineChange('appdescr_app_removeOutbound',p);};
a.create_app_changeOutbound=function(p){U.checkParameterAndType(p,"outboundId","string");U.checkEntityPropertyChange(p);return this._createDescriptorInlineChange('appdescr_app_changeOutbound',p);};
a.create_app_addNewDataSource=function(p){U.checkParameterAndType(p,"dataSource","object");return this._createDescriptorInlineChange('appdescr_app_addNewDataSource',p);};
a.create_app_removeDataSource=function(p){U.checkParameterAndType(p,"dataSourceId","string");return this._createDescriptorInlineChange('appdescr_app_removeDataSource',p);};
a.create_app_changeDataSource=function(p){U.checkParameterAndType(p,"dataSourceId","string");U.checkEntityPropertyChange(p);return this._createDescriptorInlineChange('appdescr_app_changeDataSource',p);};
var T={BEGINNING:"BEGINNING",END:"END"};
a.create_app_addAnnotationsToOData=function(p){U.checkParameterAndType(p,"dataSourceId","string");U.checkParameterAndType(p,"annotations","array");U.checkParameterAndType(p,"dataSource","object");return this._createDescriptorInlineChange('appdescr_app_addAnnotationsToOData',p);};
a.create_app_setTitle=function(p,t){if(!t){t={"":p};}return this._createDescriptorInlineChange('appdescr_app_setTitle',{},t).then(function(d){return new Promise(function(r){d["setHostingIdForTextKey"]=function(h){var b=d;var s=h+"_sap.app.title";b._mParameters.texts[s]=b._mParameters.texts[""];delete b._mParameters.texts[""];};r(d);});});};
a.create_app_setSubTitle=function(p,t){if(!t){t={"":p};}return this._createDescriptorInlineChange('appdescr_app_setSubTitle',{},t).then(function(d){return new Promise(function(r){d["setHostingIdForTextKey"]=function(h){var b=d;var s=h+"_sap.app.subTitle";b._mParameters.texts[s]=b._mParameters.texts[""];delete b._mParameters.texts[""];};r(d);});});};
a.create_app_setShortTitle=function(p,t){if(!t){t={"":p};}return this._createDescriptorInlineChange('appdescr_app_setShortTitle',{},t).then(function(d){return new Promise(function(r){d["setHostingIdForTextKey"]=function(h){var b=d;var s=h+"_sap.app.shortTitle";b._mParameters.texts[s]=b._mParameters.texts[""];delete b._mParameters.texts[""];};r(d);});});};
a.create_app_setDescription=function(p,t){if(!t){t={"":p};}return this._createDescriptorInlineChange('appdescr_app_setDescription',{},t).then(function(d){return new Promise(function(r){d["setHostingIdForTextKey"]=function(h){var b=d;var s=h+"_sap.app.description";b._mParameters.texts[s]=b._mParameters.texts[""];delete b._mParameters.texts[""];};r(d);});});};
a.create_app_setInfo=function(p){var t={"":p};return this._createDescriptorInlineChange('appdescr_app_setInfo',{},t).then(function(d){return new Promise(function(r){d["setHostingIdForTextKey"]=function(h){var b=d;var s=h+"_sap.app.info";b._mParameters.texts[s]=b._mParameters.texts[""];delete b._mParameters.texts[""];};r(d);});});};
a.create_app_setAch=function(p){U.checkParameterAndType(p,"ach","string");return this._createDescriptorInlineChange('appdescr_app_setAch',p);};
a.create_app_setDestination=function(p){U.checkParameterAndType(p,"destination","object");return this._createDescriptorInlineChange('appdescr_app_setDestination',p);};
a.create_app_setKeywords=function(p,t){U.checkParameterAndType(p,"keywords","array");return this._createDescriptorInlineChange('appdescr_app_setKeywords',p,t);};
a.create_app_addTechnicalAttributes=function(p){U.checkParameterAndType(p,"technicalAttributes","array");return this._createDescriptorInlineChange('appdescr_app_addTechnicalAttributes',p);};
a.create_app_removeTechnicalAttributes=function(p){U.checkParameterAndType(p,"technicalAttributes","array");return this._createDescriptorInlineChange('appdescr_app_removeTechnicalAttributes',p);};
a.create_app_addCdsViews=function(p){U.checkParameterAndType(p,"cdsViews","array");return this._createDescriptorInlineChange('appdescr_app_addCdsViews',p);};
a.create_app_removeCdsViews=function(p){U.checkParameterAndType(p,"cdsViews","array");return this._createDescriptorInlineChange('appdescr_app_removeCdsViews',p);};
a.create_flp_setConfig=function(p){U.checkParameterAndType(p,"config","object");return this._createDescriptorInlineChange('appdescr_flp_setConfig',p);};
a.create_ui5_addNewModel=function(p){U.checkParameterAndType(p,"model","object");return this._createDescriptorInlineChange('appdescr_ui5_addNewModel',p);};
a.create_ui5_removeModel=function(p){U.checkParameterAndType(p,"modelId","string");return this._createDescriptorInlineChange('appdescr_ui5_removeModel',p);};
a.create_ui5_addNewModelEnhanceWith=function(p,t){U.checkParameterAndType(p,"modelId","string");return this._createDescriptorInlineChange('appdescr_ui5_addNewModelEnhanceWith',p,t);};
a.create_ui5_replaceComponentUsage=function(p){U.checkParameterAndType(p,"componentUsageId","string");U.checkParameterAndType(p,"componentUsage","object");return this._createDescriptorInlineChange('appdescr_ui5_replaceComponentUsage',p);};
a.create_ui5_addLibraries=function(p){U.checkParameterAndType(p,"libraries","object");return this._createDescriptorInlineChange('appdescr_ui5_addLibraries',p);};
a.create_ui5_setMinUI5Version=function(p){U.checkParameterAndType(p,"minUI5Version","string");return this._createDescriptorInlineChange('appdescr_ui5_setMinUI5Version',p);};
a.create_smb_addNamespace=function(p){U.checkParameterAndType(p,"smartBusinessApp","object");return this._createDescriptorInlineChange('appdescr_smb_addNamespace',p);};
a.create_smb_changeNamespace=function(p){U.checkParameterAndType(p,"smartBusinessApp","object");return this._createDescriptorInlineChange('appdescr_smb_changeNamespace',p);};
a.create_ui_generic_app_setMainPage=function(p,t){U.checkParameterAndType(p,"page","object");return this._createDescriptorInlineChange('appdescr_ui_generic_app_setMainPage',p,t);};
a.create_ui_setIcon=function(p){U.checkParameterAndType(p,"icon","string");return this._createDescriptorInlineChange('appdescr_ui_setIcon',p);};
a.create_ui_setDeviceTypes=function(p){U.checkParameterAndType(p,"deviceTypes","object");return this._createDescriptorInlineChange('appdescr_ui_setDeviceTypes',p);};
a.create_url_setUri=function(p){U.checkParameterAndType(p,"uri","string");return this._createDescriptorInlineChange('appdescr_url_setUri',p);};
a.create_fiori_setRegistrationIds=function(p){U.checkParameterAndType(p,"registrationIds","array");return this._createDescriptorInlineChange('appdescr_fiori_setRegistrationIds',p);};
return a;},true);
sap.ui.predefine('sap/ui/fl/descriptorRelated/api/DescriptorVariantFactory',["sap/ui/fl/LayerUtils","sap/ui/fl/descriptorRelated/internal/Utils","sap/ui/fl/registry/Settings","sap/ui/thirdparty/jquery","sap/base/util/merge","sap/ui/fl/write/_internal/connectors/LrepConnector"],function(L,U,S,q,b,a){"use strict";var D=function(p,f,d,s){if(p&&d){this._id=p.id;this._mode='DELETION';this._mMap=f;}else if(p){this._id=p.id;this._reference=p.reference;this._layer=p.layer;if(typeof p.referenceVersion!=="undefined"){this._referenceVersion=p.referenceVersion;}this._mode='NEW';this._skipIam=p.skipIam;this._version=p.version;}else if(f){this._mMap=f;this._mode='FROM_EXISTING';}this._oSettings=s;this._sTransportRequest=null;this._content=[];};
D.prototype.addDescriptorInlineChange=function(d){var t=this;return new Promise(function(r){var s=function(_,i){if(_["setHostingIdForTextKey"]){_.setHostingIdForTextKey(i);}};switch(t._mode){case'NEW':s(d,t._id);t._content.push(d.getMap());break;case'FROM_EXISTING':s(d,t._mMap.id);t._mMap.content.push(d.getMap());break;default:}r(null);});};
D.prototype.setTransportRequest=function(t){try{U.checkTransportRequest(t);}catch(e){return Promise.reject(e);}this._sTransportRequest=t;return Promise.resolve();};
D.prototype.setPackage=function(p){try{U.checkPackage(p);}catch(e){return Promise.reject(e);}this._package=p;return Promise.resolve();};
D.prototype.submit=function(){var m=this._getMap();var p={flexObject:{},settings:this._oSettings,appVariant:this};if(this._sTransportRequest){p.transport=this._sTransportRequest;}if(this._skipIam){p.skipIam=this._skipIam;}if(m.layer){p.layer=m.layer;}if(!p.url){p.url="/sap/bc/lrep";}var B;switch(this._mode){case'NEW':Object.assign(p.flexObject,m);B=a.appVariant.create(p);break;case'FROM_EXISTING':p.reference=m.id;Object.assign(p.flexObject,m);B=a.appVariant.update(p);break;case'DELETION':p.reference=m.id;B=a.appVariant.remove(p);break;default:return Promise.reject("Please provide a valid operation.");}return B.then(function(r){return r;});};
D.prototype.getId=function(){return this._getMap().id;};
D.prototype.setReference=function(r){if(r===undefined||typeof r!=="string"){throw new Error("No parameter sReference of type string provided");}this._reference=r;};
D.prototype.getReference=function(){return this._reference;};
D.prototype.getVersion=function(){return this._version;};
D.prototype.getNamespace=function(){return this._getMap().namespace;};
D.prototype.getPackage=function(){return this._getMap().packageName;};
D.prototype.getDefinition=function(){return this._getMap();};
D.prototype.getSettings=function(){return this._oSettings;};
D.prototype.getJson=function(){return b({},this._getMap());};
D.prototype._getMap=function(){switch(this._mode){case'NEW':var r={fileName:this._getNameAndNameSpace().fileName,fileType:"appdescr_variant",namespace:this._getNameAndNameSpace().namespace,layer:this._layer,packageName:this._package?this._package:"",reference:this._reference,id:this._id,content:this._content};if(typeof this._referenceVersion!=="undefined"){r.referenceVersion=this._referenceVersion;}if(this._version){r.version=this._version;}return r;case'FROM_EXISTING':case'DELETION':{return this._mMap;}default:}};
D.prototype._getNameAndNameSpace=function(){return U.getNameAndNameSpace(this._id,this._reference);};
var c={};
c._getDescriptorVariant=function(p){if(!p.url){p.url="/sap/bc/lrep";}return a.appVariant.load(p);};
c.createNew=function(p){return c.createAppVariant(p);};
c.createAppVariant=function(p){U.checkParameterAndType(p,"reference","string");U.checkParameterAndType(p,"id","string");if(p.version){U.checkParameterAndType(p,"version","string");}if(!p.layer){p.layer='CUSTOMER';}else{U.checkParameterAndType(p,"layer","string");}if(p.skipIam){U.checkParameterAndType(p,"skipIam","boolean");}return S.getInstance().then(function(s){return Promise.resolve(new D(p,null,false,s));});};
c.createForExisting=function(i){return c.loadAppVariant(i,false);};
c.createFromJson=function(p){if(!q.isPlainObject(p)){throw new Error("Parameter \"mParameters\" must be provided of type object");}return S.getInstance().then(function(s){return Promise.resolve(new D(null,p,false,s));});};
c.createDeletion=function(i){return c.loadAppVariant(i,true);};
c.loadAppVariant=function(i,d,l,I){if(i===undefined||typeof i!=="string"){throw new Error("Parameter \"sId\" must be provided of type string");}var _;return c._getDescriptorVariant({reference:i,layer:l,isForSAPDelivery:I}).then(function(r){_=r;return S.getInstance();}).then(function(s){var m=_.response;if(!q.isPlainObject(m)){m=JSON.parse(m);}return d?Promise.resolve(new D({id:i},m,d,s)):Promise.resolve(new D(null,m,d,s));});};
return c;},true);
sap.ui.predefine('sap/ui/fl/descriptorRelated/internal/Utils',[],function(){"use strict";var U=function(){};
U.prototype.getNameAndNameSpace=function(i,r){return{fileName:"manifest",namespace:"apps/"+r+"/appVariants/"+i+"/"};};
U.prototype.checkEntityPropertyChange=function(p){this.checkParameterAndType(p,"entityPropertyChange","object");if(p.entityPropertyChange instanceof Array){for(var i=0;i<p.entityPropertyChange.length;i++){var c=p.entityPropertyChange[i];this.checkEntityPropertyChangeContent(c);}}else if(p.entityPropertyChange instanceof Object){this.checkEntityPropertyChangeContent(p.entityPropertyChange);}};
U.prototype.checkEntityPropertyChangeContent=function(c){this.checkParameterAndType(c,"propertyPath","string");this.checkParameterAndType(c,"operation","string");if(['INSERT','UPDATE','UPSERT','DELETE'].indexOf(c.operation)===-1){throw new Error("Parameter \"entityPropertyChange.operation\" needs to be one of 'INSERT', 'UPDATE', 'UPSERT', 'DELETE'");}if(c.propertyValue===undefined&&c.operation!=='DELETE'){throw new Error("No parameter \"entityPropertyChange.propertyValue\" provided");}};
U.prototype.checkParameterAndType=function(p,P,t){if(t==="array"){if(p===undefined||p[P]===undefined||!Array.isArray(p[P])){throw new Error("No parameter \""+P+"\" of type "+t+" provided");}}else if(p===undefined||p[P]===undefined||typeof p[P]!==t){throw new Error("No parameter \""+P+"\" of type "+t+" provided");}};
U.prototype.checkTexts=function(t){if(t!==undefined&&typeof t!=="object"){throw new Error("Wrong format for provided \"texts\" parameter");}};
U.prototype.checkTransportRequest=function(t){if(!/^[A-Z0-9]{1,20}$/.test(t)&&t!=='ATO_NOTIFICATION'){throw new Error("Wrong format for provided \"sTransportRequest\" parameter");}};
U.prototype.checkPackage=function(p){if(!/^[A-Z0-9/_]{1,30}$/.test(p)){throw new Error("Wrong format for provided \"sPackage\" parameter");}};
return new U();},true);
sap.ui.predefine('sap/ui/fl/fieldExt/Access',["sap/ui/util/Storage","sap/ui/fl/Utils","sap/base/security/encodeURLParameters","sap/ui/thirdparty/jquery"],function(S,U,a,q){"use strict";var A={};A._mServiceType={v2:"v2",v4:"v4"};A._sODataV4ResourcePathPrefix="sap/opu/odata4/";A._sStorageKey="sap.ui.fl.fieldExt.Access";A._iValidityPeriod=1*7*24*60*60*1000;
A.getBusinessContexts=function(s,e,E){var m=this._getEntityInfo(e,E);var b=this._parseServiceUri(s);var B=this._buildBusinessContextRetrievalUri(b,m);var p=this._executeAjaxCall(B,b,m);return p;};
A.isServiceOutdated=function(s){if(!this._isSystemInfoAvailable()){return false;}var m=this._getServiceItem(this._createServiceItem(s));if(m){if(this._isServiceExpired(m)){this.setServiceValid(s);return false;}return true;}return false;};
A.setServiceValid=function(s){if(this._isSystemInfoAvailable()){var d=this._getDataFromLocalStorage();delete d[this._createServiceItem(s).serviceKey];this._setDataToLocalStorage(d);}};
A.setServiceInvalid=function(s){if(this._isSystemInfoAvailable()){var d=this._getDataFromLocalStorage();var i=this._createServiceItem(s);d[i.serviceKey]=i;this._setDataToLocalStorage(d);}};
A._getEntityInfo=function(e,E){var o={entityTypeName:e||"",entitySetName:E||""};if(((o.entitySetName.length===0)&&(o.entityTypeName.length===0))||(!(o.entitySetName.length===0)&&!(o.entityTypeName.length===0))){throw new Error("sap.ui.fl.fieldExt.Access._getEntityInfo()"+"Inconsistent input parameters EntityType: "+o.entityTypeName+" EntitySet: "+o.entitySetName);}return o;};
A._parseServiceUri=function(s){if(s.toLowerCase().indexOf(this._sODataV4ResourcePathPrefix)!==-1){return this._parseV4ServiceUri(s);}return this._parseV2ServiceUri(s);};
A._parseV2ServiceUri=function(s){var r=/.*sap\/opu\/odata\/([^\/]+)\/([^\/]+)/i;var R=/([^;]+);v=(\d{1,4})/i;var o="sap/opu/odata";var b;if(s.toLowerCase().indexOf(o)!==-1){var c=s.match(r);if(!c||c.length!==3){throw new Error("sap.ui.fl.fieldExt.Access._parseV2ServiceUri: Malformed service URI (Invalid service name)");}if(c[1].toLowerCase()!=="sap"){b="/"+c[1]+"/"+c[2];}else{b=c[2];}}else{if(s.length>0&&s.lastIndexOf("/")+1===s.length){s=s.substring(0,s.length-1);}b=s.substring(s.lastIndexOf("/")+1);}if(b.indexOf(";v=")!==-1){var v=b.match(R);if(!v||v.length!==3){throw new Error("sap.ui.fl.fieldExt.Access._parseV2ServiceUri: Malformed service URI (Invalid version)");}return{serviceName:v[1],serviceVersion:v[2],serviceType:this._mServiceType.v2};}return{serviceName:b,serviceVersion:"0001",serviceType:this._mServiceType.v2};};
A._parseV4ServiceUri=function(s){var r=/^\/?sap\/opu\/odata4((?:\/[^/]+){5})(\/[^/]+){1}(\/.*)?/i;var b=s.match(r);if(!b||b.length!==4){throw new Error("sap.ui.fl.fieldExt.Access._parseV4ServiceUri: Malformed service URI");}var n=b[1].split("/");n.splice(0,3);var R=/(\d{1,4})/i;var v=b[2].match(R);return{serviceName:n.join("/"),serviceVersion:v[1],serviceType:this._mServiceType.v4};};
A._buildBusinessContextRetrievalUri=function(s,e){var b="/sap/opu/odata/SAP/APS_CUSTOM_FIELD_MAINTENANCE_SRV/";if(s.serviceType===this._mServiceType.v4){var r=this._sODataV4ResourcePathPrefix+s.serviceName+"/"+s.serviceVersion;b+="GetBusinessContextsByResourcePath?"+a({ResourcePath:"'"+r+"'"});}else{b+="GetBusinessContextsByEntityType?"+"ServiceName=\'"+s.serviceName+"\'"+"&ServiceVersion=\'"+s.serviceVersion+"\'";}b+="&EntitySetName=\'"+e.entitySetName+"\'"+"&EntityTypeName=\'"+e.entityTypeName+"\'"+"&$format=json";return b;};
A._executeAjaxCall=function(b,s,e){var t=this;var m=this._getAjaxSettings();var d=q.Deferred();var r={BusinessContexts:[],ServiceName:s.serviceName,ServiceVersion:s.serviceVersion};q.ajax(b,m).done(function(c){r.BusinessContexts=t._extractBusinessContexts(c);d.resolve(r);}).fail(function(j){if(j.status===404&&s.serviceType===t._mServiceType.v4){d.resolve(r);}else{var E=t._getMessagesFromXHR(j);var o={errorOccured:true,errorMessages:E,serviceName:s.serviceName,serviceVersion:s.serviceVersion,entityType:e.entityTypeName,entitySet:e.entitySetName};d.reject(o);}});return d.promise();};
A._getAjaxSettings=function(){var s={type:"GET",async:true,dataType:"json"};return s;};
A._extractBusinessContexts=function(d){var r=null;var b=[];if(d&&d.d){r=d.d.results;}if(r!==null&&r.length>0){for(var i=0;i<r.length;i++){if(r[i].BusinessContext!==null){b.push({BusinessContext:r[i].BusinessContext,BusinessContextDescription:r[i].BusinessContextDescription});}}}return b;};
A._getMessagesFromXHR=function(x){var m=[];try{var E=JSON.parse(x.responseText);if(E&&E.error&&E.error.message&&E.error.message.value&&E.error.message.value!==''){m.push({severity:"error",text:E.error.message.value});}else{m.push({severity:"error",text:x.responseText});}}catch(e){}return m;};
A._getCurrentTime=function(){return Date.now();};
A._isServiceExpired=function(s){return s.expirationDate<=this._getCurrentTime();};
A._getLocalStorage=function(){return new S(S.Type.local);};
A.isLocalStorageAvailable=function(){return this._getLocalStorage()&&this._getLocalStorage().isSupported();};
A._getServiceItem=function(s){return this._getDataFromLocalStorage()[s.serviceKey]||null;};
A._createServiceItem=function(s){var e=this._getCurrentTime()+this._iValidityPeriod;var m=this._getSystemInfo();var p=this._extractServiceInfo(s);return{serviceKey:m.getName()+m.getClient()+p.serviceName+p.serviceVersion,expirationDate:e};};
A._extractServiceInfo=function(s){if(typeof s==="string"){return this._parseServiceUri(s);}return s;};
A._isSystemInfoAvailable=function(){var u=U.getUshellContainer();return u&&u.getLogonSystem;};
A._getSystemInfo=function(){var u=U.getUshellContainer();return u&&u.getLogonSystem();};
A._setDataToLocalStorage=function(d){if(this.isLocalStorageAvailable()){this._getLocalStorage().put(A._sStorageKey,JSON.stringify(d));}};
A._getDataFromLocalStorage=function(){if(!this.isLocalStorageAvailable()){return{};}var s=this._getLocalStorage().get(A._sStorageKey);if(!s){return{};}return JSON.parse(s);};
return A;},true);
sap.ui.predefine('sap/ui/fl/library',["sap/ui/fl/RegistrationDelegator","sap/ui/fl/Utils","sap/ui/core/library","sap/m/library"],function(R,U){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.fl",version:"1.74.0",controls:["sap.ui.fl.variants.VariantManagement","sap.ui.fl.util.IFrame"],dependencies:["sap.ui.core","sap.m"],designtime:"sap/ui/fl/designtime/library.designtime",extensions:{flChangeHandlers:{"sap.ui.fl.util.IFrame":"sap/ui/fl/util/IFrame"},"sap.ui.support":{diagnosticPlugins:["sap/ui/fl/support/Flexibility"],publicRules:true}}});sap.ui.fl.Scenario={AppVariant:"APP_VARIANT",VersionedAppVariant:"VERSIONED_APP_VARIANT",AdaptationProject:"ADAPTATION_PROJECT",FioriElementsFromScratch:"FE_FROM_SCRATCH",UiAdaptation:"UI_ADAPTATION"};R.registerAll();
function _(){var u=U.getUshellContainer();if(u){return u.getLogonSystem().isTrial();}return false;}
if(_()){sap.ui.getCore().getConfiguration().setFlexibilityServices([{connector:"LrepConnector",url:"/sap/bc/lrep",layers:[]},{connector:"LocalStorageConnector",layers:["CUSTOMER","USER"]}]);}return sap.ui.fl;});
sap.ui.predefine('sap/ui/fl/registry/ChangeHandlerRegistration',["sap/ui/fl/registry/ChangeRegistry","sap/ui/thirdparty/jquery"],function(C,q){"use strict";var a={_mRegistrationPromises:{},_addRegistrationPromise:function(k,p){this._mRegistrationPromises[k]=p;p.then(function(){delete this._mRegistrationPromises[k];}.bind(this));p.catch(function(e){delete this._mRegistrationPromises[k];return Promise.reject(e);}.bind(this));},waitForChangeHandlerRegistration:function(k){return this._mRegistrationPromises[k]||Promise.resolve();},isChangeHandlerRegistrationInProgress:function(k){return!!this._mRegistrationPromises[k];},getChangeHandlersOfLoadedLibsAndRegisterOnNewLoadedLibs:function(){var c=sap.ui.getCore();var A=c.getLoadedLibraries();var p=[];q.each(A,function(l,L){if(L.extensions&&L.extensions.flChangeHandlers){p.push(this._registerFlexChangeHandlers(L.extensions.flChangeHandlers));}}.bind(this));c.attachLibraryChanged(this._handleLibraryRegistrationAfterFlexLibraryIsLoaded.bind(this));return Promise.all(p);},_registerFlexChangeHandlers:function(f){if(f){var c=C.getInstance();return c.registerControlsForChanges(f);}return Promise.resolve();},_handleLibraryRegistrationAfterFlexLibraryIsLoaded:function(l){if(l.getParameter("operation")==="add"){var L=l.getParameter("metadata");var o=L.sName;if(L&&L.extensions&&L.extensions.flChangeHandlers){var f=L.extensions.flChangeHandlers;var r=this._registerFlexChangeHandlers(f);this._addRegistrationPromise(o,r);return r;}}return Promise.resolve();}};return a;},true);
sap.ui.predefine('sap/ui/fl/registry/ChangeRegistry',["sap/ui/fl/Utils","sap/ui/thirdparty/jquery","sap/ui/fl/registry/ChangeRegistryItem","sap/ui/fl/registry/ChangeTypeMetadata","sap/ui/fl/registry/Settings","sap/ui/fl/changeHandler/HideControl","sap/ui/fl/changeHandler/MoveElements","sap/ui/fl/changeHandler/MoveControls","sap/ui/fl/changeHandler/PropertyChange","sap/ui/fl/changeHandler/PropertyBindingChange","sap/ui/fl/changeHandler/UnhideControl","sap/ui/fl/changeHandler/StashControl","sap/ui/fl/changeHandler/UnstashControl","sap/ui/fl/changeHandler/AddXML","sap/base/Log"],function(U,q,C,a,S,H,M,b,P,c,d,e,f,A,L){"use strict";var g=function(){this._registeredItems={};this.initSettings();this.initDeveloperModeChangeHandlers();};g._instance=undefined;g.prototype._oDefaultActiveChangeHandlers={};g.prototype._oDefaultChangeHandlers={hideControl:H,moveElements:M,moveControls:b,unhideControl:d,stashControl:e,unstashControl:f};g.prototype._mDeveloperModeChangeHandlers={propertyChange:{changeHandler:P},propertyBindingChange:{changeHandler:c},addXML:{changeHandler:A}};
g.prototype.initDeveloperModeChangeHandlers=function(){Object.keys(this._mDeveloperModeChangeHandlers).forEach(function(s){var o=this._mDeveloperModeChangeHandlers[s].changeHandler;var l=this._oSettings.getDeveloperModeLayerPermissions();var h={changeType:s,changeHandler:o,layers:l};var i=this._createChangeRegistryItemForSimpleChange("defaultActiveForAllControls",h);this._oDefaultActiveChangeHandlers[s]=i;}.bind(this));};
g.getInstance=function(){if(!g._instance){g._instance=new g();}return g._instance;};
g.prototype.hasRegisteredChangeHandlersForControl=function(s){var h=Object.keys(this._registeredItems);return h.indexOf(s)!==-1;};
g.prototype.hasChangeHandlerForControlAndChange=function(s,h){if(!this.hasRegisteredChangeHandlersForControl(s)){return false;}var r=this._registeredItems[s];var i=Object.keys(r);return i.indexOf(h)!==-1;};
g.prototype.registerControlsForChanges=function(m){var p=[];q.each(m,function(s,v){var h={};if(Array.isArray(v)){v.forEach(function(o){h[o.changeType]=o.changeHandler;});}else{h=v;}p.push(this._registerChangeHandlersForControl(s,h));}.bind(this));return Promise.all(p);};
g.prototype._registerChangeHandlersForControl=function(s,o){var p=Promise.resolve(o);var h="ChangeRegistry._registerChangeHandlersForControl.skip_next_then";if(typeof o==="string"){p=U.requireAsync(o+".flexibility").catch(function(E){L.error("Flexibility change handler registration failed.\nControlType: "+s+"\n"+E.message);return Promise.resolve(h);});}return p.then(function(r){if(r!==h){q.each(r,function(i,j){var k=this._getChangeHandlerEntry(i,j);var l={changeType:i,changeHandler:k.changeHandler,layers:k.layers};this.registerControlForSimpleChange(s,l);}.bind(this));}}.bind(this));};
g.prototype._getInstanceSpecificChangeRegistryItem=function(s,o,m){var h=m.getChangeHandlerModulePath(o);if(typeof h!=="string"){return new U.FakePromise(undefined);}return U.requireAsync(h).then(function(i){var v=i[s];if(!v){return undefined;}var j=this._getChangeHandlerEntry(s,v);var k={changeType:s,changeHandler:j.changeHandler,layers:j.layers};var l=m.getControlType(o);var n=this._createChangeRegistryItemForSimpleChange(l,k);return n;}.bind(this)).catch(function(E){L.error("Flexibility registration for control "+m.getId(o)+" failed to load module "+h+"\n"+E.message);return undefined;});};
g.prototype._getChangeHandlerEntry=function(s,v){var r={};var D=Object.keys(this._mDeveloperModeChangeHandlers);if(!v||!v.changeHandler){r.changeHandler=v;}else{r=v;}if(r.changeHandler==="default"){r.changeHandler=this._oDefaultChangeHandlers[s];}else if(D.indexOf(s)>-1){throw new Error("You can't use a custom change handler for the following Developer Mode change types: "+D.toString()+". Please use 'default' instead.");}return r;};
g.prototype._getChangeRegistryItem=function(s,h,l){if(!s||!h){return undefined;}var m=this.getRegistryItems({changeTypeName:s,controlType:h,layer:l});if(m&&m[h]&&m[h][s]){return m[h][s];}else if(m&&m[h]){return m[h];}return m;};
g.prototype._extractChangeHandlerFromRegistryItem=function(r){if(r&&r.getChangeTypeMetadata){return r.getChangeTypeMetadata().getChangeHandler();}throw Error("No Change handler registered for the Control and Change type");};
g.prototype.getChangeHandler=function(s,h,o,m,l){return this._getInstanceSpecificChangeRegistryItem(s,o,m).then(function(i){var j=i||this._getChangeRegistryItem(s,h,l);return this._extractChangeHandlerFromRegistryItem(j);}.bind(this));};
g.prototype.registerControlForSimpleChange=function(s,o){var h;if(!s){return;}if(!o||!o.changeType||!o.changeHandler){return;}h=this._createChangeRegistryItemForSimpleChange(s,o);if(h){this.addRegistryItem(h);}};
g.prototype._createChangeRegistryItemForSimpleChange=function(s,o){var p;var h;var i;var l;l=Object.assign({},this._oSettings.getDefaultLayerPermissions());var j=o.layers;if(j){Object.keys(j).forEach(function(k){if(l[k]===undefined){throw new Error("The Layer '"+k+"' is not supported. Please only use supported layers");}l[k]=j[k];});}p={name:o.changeType,changeHandler:o.changeHandler,layers:l};h=new a(p);p={changeTypeMetadata:h,controlType:s};i=new C(p);return i;};
g.prototype.addRegistryItem=function(r){var s;var h;if(!r){return;}s=r.getChangeTypeName();h=r.getControlType();this._registeredItems[h]=this._registeredItems[h]||{};this._registeredItems[h][s]=r;};
g.prototype.removeRegistryItem=function(p){if(!p.changeTypeName&&!p.controlType){L.error("sap.ui.fl.registry.ChangeRegistry: ChangeType and/or ControlType required");return;}if(p.controlType&&p.changeTypeName){if(this._registeredItems[p.controlType]){if(Object.keys(this._registeredItems[p.controlType]).length===1){delete this._registeredItems[p.controlType];}else{delete this._registeredItems[p.controlType][p.changeTypeName];}}}else if(p.controlType){if(this._registeredItems[p.controlType]){delete this._registeredItems[p.controlType];}}else if(p.changeTypeName){for(var h in this._registeredItems){var i=this._registeredItems[h];delete i[p.changeTypeName];}}};
g.prototype._getSingleRegistryItem=function(s,h){var o=this._registeredItems[s];if(o){var i=o[h];if(i){return i;}}var D=this._oDefaultActiveChangeHandlers[h];if(D){return D;}};
g.prototype._getRegistryItemsByChangeAndControlType=function(s,h){var r;var R=this._getSingleRegistryItem(s,h);if(R){r={};r[s]={};r[s][h]=R;}return r;};
g.prototype._getRegistryItemsByControlType=function(s){var r={};r[s]={};if(this._registeredItems[s]){var h=Object.keys(this._registeredItems[s]);h.forEach(function(i){r[s][i]=this._getSingleRegistryItem(s,i);}.bind(this));}for(var k in this._oDefaultActiveChangeHandlers){r[s][k]=this._oDefaultActiveChangeHandlers[k];}return r;};
g.prototype._getRegistryItemsByChangeType=function(s){var r={};for(var h in this._registeredItems){if(this._registeredItems[h][s]){r[h]={};r[h][s]=this._getSingleRegistryItem(h,s);}}r["defaultActiveForAllControls"]={};for(var k in this._oDefaultActiveChangeHandlers){r["defaultActiveForAllControls"][k]=this._oDefaultActiveChangeHandlers[k];}return r;};
g.prototype.getRegistryItems=function(p){var r;if(!p){L.error("sap.ui.fl.registry.ChangeRegistry: no parameters passed for getRegistryItems");}var s=p.changeTypeName;var h=p.controlType;if(!s&&!h){L.error("sap.ui.fl.registry.ChangeRegistry: Change Type Name and/or Control Type required");}if(h&&s){r=this._getRegistryItemsByChangeAndControlType(h,s);}else if(h){r=this._getRegistryItemsByControlType(h);}else if(s){r=this._getRegistryItemsByChangeType(s);}this._filterChangeTypes(r,p.layer);return r;};
g.prototype.initSettings=function(){this._oSettings=S.getInstanceOrUndef();if(!this._oSettings){this._oSettings=new S({});}};
g.prototype._filterChangeTypes=function(r,l){if(this._oSettings&&l&&r){var i=false;q.each(r,function(s,o){q.each(o,function(h,R){var j=R.getChangeTypeMetadata().getLayers();i=j[l];if(!i){L.warning("Change type "+h+" not enabled for layer "+l);delete o[h];}});});}};
g.prototype.getDragInfo=function(s){var h=this._registeredItems[s];if(h){return h.getDragInfo();}return null;};
return g;},true);
sap.ui.predefine('sap/ui/fl/registry/ChangeRegistryItem',["sap/base/Log"],function(L){"use strict";var C=function(p){if(!p.changeTypeMetadata){L.error("sap.ui.fl.registry.ChangeRegistryItem: ChangeTypeMetadata required");}if(!p.controlType){L.error("sap.ui.fl.registry.ChangeRegistryItem: ControlType required");}this._changeTypeMetadata=p.changeTypeMetadata;this._controlType=p.controlType;if(p.permittedRoles){this._permittedRoles=p.permittedRoles;}if(p.dragTargets){this._dragTargets=p.dragTargets;}};C.prototype._changeTypeMetadata=undefined;C.prototype._controlType=undefined;C.prototype._permittedRoles={};C.prototype._dragTargets=[];
C.prototype.getChangeTypeMetadata=function(){return this._changeTypeMetadata;};
C.prototype.getChangeTypeName=function(){return this._changeTypeMetadata.getName();};
C.prototype.getControlType=function(){return this._controlType;};
C.prototype.getPermittedRoles=function(){return this._permittedRoles;};
C.prototype.getDragTargets=function(){return this._dragTargets;};
return C;},true);
sap.ui.predefine('sap/ui/fl/registry/ChangeTypeMetadata',["sap/base/Log","sap/ui/fl/Utils"],function(L,U){"use strict";var C=function(p){if(!p.name){L.error("sap.ui.fl.registry.ChangeType: Name required");}if(!p.changeHandler){L.error("sap.ui.fl.registry.ChangeType: ChangeHandler required");}this._name=p.name;this._changeHandler=p.changeHandler;this._layers=p.layers;if(p.labelKey){this._labelKey=p.labelKey;}if(p.tooltipKey){this._tooltipKey=p.tooltipKey;}if(p.iconKey){this._iconKey=p.iconKey;}if(p.sortIndex){this._sortIndex=p.sortIndex;}};C.prototype._name="";C.prototype._changeHandler="";C.prototype._layers=[];C.prototype._sortIndex=0;C.prototype._labelKey="";C.prototype._tooltipKey="";C.prototype._iconKey="";
C.prototype.getName=function(){return this._name;};
C.prototype.getChangeHandler=function(){var p=new U.FakePromise();if(typeof this._changeHandler==="string"){p=U.requireAsync(this._changeHandler.replace(/\./g,"/")).then(function(c){this._changeHandler=c;}.bind(this));}return p.then(function(){if(!this._changeHandler||typeof this._changeHandler.completeChangeContent!=="function"||typeof this._changeHandler.applyChange!=="function"||typeof this._changeHandler.revertChange!=="function"){return Promise.reject(new Error("The ChangeHandler is either not available or does not fulfill all needed requirements"));}return this._changeHandler;}.bind(this));};
C.prototype.getLayers=function(){return this._layers;};
C.prototype.getLabel=function(){return this._labelKey;};
C.prototype.getTooltip=function(){return this._tooltipKey;};
C.prototype.getIcon=function(){return this._iconKey;};
C.prototype.getSortIndex=function(){return this._sortIndex;};
return C;},true);
sap.ui.predefine('sap/ui/fl/registry/Settings',["sap/ui/fl/write/_internal/CompatibilityConnector","sap/ui/fl/Utils","sap/base/util/UriParameters","sap/base/Log"],function(C,U,a,L){"use strict";var S=function(s){if(!s){throw new Error("no flex settings provided");}if(!s.defaultLayerPermissions){s.defaultLayerPermissions={VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:true,USER:false};}if(!s.developerModeLayerPermissions){s.developerModeLayerPermissions={VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:false,USER:false};}if(!(S._IS_VARIANT_SHARING_ENABLED in s)){s.isVariantSharingEnabled=true;}this._oSettings=s;};S._IS_VARIANT_SHARING_ENABLED="isVariantSharingEnabled";
S.attachEvent=function(e,c){S._oEventProvider.attachEvent(e,c);};
S.detachEvent=function(e,c){S._oEventProvider.detachEvent(e,c);};
S.getInstance=function(){if(S._instance){return Promise.resolve(S._instance);}if(S._oLoadSettingsPromise){return S._oLoadSettingsPromise;}return S._loadSettings();};
S._loadSettings=function(){var l=C.loadSettings().then(function(s){if(!s){L.error("The request for flexibility settings failed; A default response is generated and returned to consuming APIs");s={isKeyUser:false,isVariantSharingEnabled:false,isAtoAvailable:false,isAtoEnabled:false,isProductiveSystem:true,versioning:{},_bFlexChangeMode:false,_bFlexibilityAdaptationButtonAllowed:false};}return S._storeInstance(s);});S._oLoadSettingsPromise=l;return l;};
S._storeInstance=function(s){if(!S._instance){S._instance=new S(s);}return S._instance;};
S.getInstanceOrUndef=function(){var s;if(S._instance){s=S._instance;}return s;};
S.prototype._getBooleanProperty=function(p){var v=false;if(this._oSettings[p]){v=this._oSettings[p];}return v;};
S.prototype.isKeyUser=function(){return this._getBooleanProperty("isKeyUser");};
S.prototype.isVersioningEnabled=function(l){return!!(this._oSettings.versioning[l]||this._oSettings.versioning["ALL"]);};
S.prototype.isModelS=function(){return this._getBooleanProperty("isAtoAvailable");};
S.prototype.isAtoEnabled=function(){return this._getBooleanProperty("isAtoEnabled");};
S.prototype.isAtoAvailable=function(){return this._getBooleanProperty("isAtoAvailable");};
S.prototype.isProductiveSystem=function(){return this._getBooleanProperty("isProductiveSystem");};
S.prototype.isVariantSharingEnabled=function(){return(this._oSettings.isVariantSharingEnabled===true);};
S.prototype.getSystem=function(){return this._oSettings.system;};
S.prototype.getClient=function(){return this._oSettings.client;};
S.prototype.getDefaultLayerPermissions=function(){return this._oSettings.defaultLayerPermissions;};
S.prototype.getDeveloperModeLayerPermissions=function(){return this._oSettings.developerModeLayerPermissions;};
return S;},true);
sap.ui.predefine('sap/ui/fl/registry/SimpleChanges',["sap/ui/fl/changeHandler/HideControl","sap/ui/fl/changeHandler/UnhideControl","sap/ui/fl/changeHandler/StashControl","sap/ui/fl/changeHandler/UnstashControl","sap/ui/fl/changeHandler/MoveElements","sap/ui/fl/changeHandler/MoveControls","sap/ui/fl/changeHandler/PropertyChange","sap/ui/fl/changeHandler/PropertyBindingChange"],function(H,U,S,a,M,b,P,c){"use strict";var d={hideControl:{changeType:"hideControl",changeHandler:H},unhideControl:{changeType:"unhideControl",changeHandler:U},stashControl:{changeType:"stashControl",changeHandler:S},unstashControl:{changeType:"unstashControl",changeHandler:a},moveElements:{changeType:"moveElements",changeHandler:M},moveControls:{changeType:"moveControls",changeHandler:b},propertyChange:{changeType:"propertyChange",changeHandler:P},propertyBindingChange:{changeType:"propertyBindingChange",changeHandler:c}};return d;},true);
sap.ui.predefine('sap/ui/fl/transport/TransportDialog',["sap/ui/fl/write/_internal/transport/TransportDialog"],function(I){"use strict";
var T=I.extend("sap.ui.fl.transport.TransportDialog");
return T;});
sap.ui.predefine('sap/ui/fl/transport/TransportSelection',["sap/ui/fl/write/_internal/transport/TransportSelection"],function(T){"use strict";return T;},true);
sap.ui.predefine('sap/ui/fl/util/IFrame.flexibility',["sap/ui/fl/changeHandler/UpdateIFrame"],function(U){"use strict";return{updateIFrame:U,hideControl:"default"};});
sap.ui.predefine('sap/ui/fl/util/IFrame',["../library","sap/ui/core/Control","sap/ui/fl/Utils","sap/ui/model/json/JSONModel","sap/ui/core/library","./IFrameRenderer"],function(l,C,U,J){"use strict";
function g(){var s=U.getUshellContainer();if(s){var u=s.getService("UserInfo");if(!u){return;}var o=u.getUser();if(!o){return;}var e=o.getEmail();var d=/@(.*)/.exec(e)[1];return{fullName:o.getFullName(),firstName:o.getFirstName(),lastName:o.getLastName(),email:e,domain:d};}}
var I=C.extend("sap.ui.fl.util.IFrame",{
metadata:{library:"sap.ui.fl",properties:{url:{type:"sap.ui.core.URI",group:"Misc",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"}},designtime:"sap/ui/fl/designtime/util/IFrame.designtime"},
init:function(){if(C.prototype.init){C.prototype.init.apply(this,arguments);}var u=g()||{};this._oUserModel=new J(u);this.setModel(this._oUserModel,"$user");},
exit:function(){if(this._oUserModel){this._oUserModel.destroy();delete this._oUserModel;}}
});
return I;});
sap.ui.predefine('sap/ui/fl/util/IFrameRenderer',[],function(){"use strict";
function _(r,d,v){if(v!==""||v.toLowerCase()==="auto"){r.style(d,v);}}
var I={apiVersion:2};
I.render=function(r,i){r.openStart("iframe",i);_(r,"width",i.getWidth());_(r,"height",i.getHeight());r.style("display","block");r.style("border","none");r.attr("src",i.getUrl());r.openEnd();r.close("iframe");};
return I;},true);
sap.ui.predefine('sap/ui/fl/util/ManagedObjectModel',["sap/ui/core/Element","sap/ui/model/base/ManagedObjectModel"],function(E,M){"use strict";
function c(n){return n.charAt(0).toUpperCase()+n.slice(1);}
var a=E.extend("sap.ui.fl.util.ManagedObjectModel",{
metadata:{library:"sap.ui.fl",properties:{data:{type:"object"},name:{type:"string",defaultValue:"$sap.ui.fl.ManagedObjectModel"}},associations:{object:{type:"sap.ui.core.Element"}}},
constructor:function(){E.apply(this,arguments);this._oManagedObjectModel=new M(sap.ui.getCore().byId(this.getObject()),this.getData());["data","name","object"].forEach(function(n){this["set"+c(n)]=function(){throw new Error("sap.ui.fl.util.ManagedObjectModel: Can't change the value of `"+n+"` after the object is initialized. Please recreate the object with correct values in the constructor.");};},this);}
});
a.prototype.setParent=function(n){var o=this.getParent();if(o){o.setModel(null,this.getName());}if(n){n.setModel(this._oManagedObjectModel,this.getName());}E.prototype.setParent.apply(this,arguments);};
a.prototype.exit=function(){this._oManagedObjectModel.destroy();};
return a;},true);
sap.ui.predefine('sap/ui/fl/variants/VariantController',["sap/ui/fl/Utils","sap/ui/fl/LayerUtils","sap/ui/fl/Change","sap/ui/fl/Variant","sap/base/util/ObjectPath","sap/base/util/includes","sap/base/Log","sap/ui/fl/apply/_internal/controlVariants/URLHandler"],function(U,L,C,V,O,i,a,b){"use strict";var _=function(){};var c=function(s,A,o){this._sComponentName=s||"";this._sAppVersion=A||U.DEFAULT_APP_VERSION;this._mVariantManagement={};this.setChangeFileContent(o,{});this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");this.DEFAULT_AUTHOR="SAP";};
c.prototype.getComponentName=function(){return this._sComponentName;};
c.prototype.getAppVersion=function(){return this._sAppVersion;};
c.prototype.setChangeFileContent=function(o,t){if(Object.keys(this._mVariantManagement).length===0){this._mVariantManagement={};}if(o&&o.changes&&o.changes.variantSection){Object.keys(o.changes.variantSection).forEach(function(v){if(this._mVariantManagement[v]){return;}this._mVariantManagement[v]={};var d=o.changes.variantSection[v];var e=d.variants.concat();var s;var I=-1;e.forEach(function(f,g){if(f.content.fileName===v){I=g;if(!O.get("content.support.user",f)){var h={support:{user:this.DEFAULT_AUTHOR}};Object.assign(f.content,h);}}if(!f.content.content.favorite){f.content.content.favorite=true;}if(!f.content.content.visible){f.content.content.visible=true;}var T=f.content.content.title.match(/.i18n>(\w+)./);if(T){f.content.content.title=this._oResourceBundle.getText(T[1]);}this._applyChangesOnVariant(f);if(!s){s=i(t&&t[b.variantTechnicalParameterName],f.content.fileName)&&f.content.fileName;}}.bind(this));if(I>-1){var S=e.splice(I,1)[0];e.sort(this.compareVariants);e.splice(0,0,S);}this._mVariantManagement[v].variants=e;this._mVariantManagement[v].defaultVariant=v;if(s){this._mVariantManagement[v].currentVariant=s;}this._mVariantManagement[v].variantManagementChanges=o.changes.variantSection[v].variantManagementChanges;this._applyChangesOnVariantManagement(this._mVariantManagement[v]);}.bind(this));}};
c.prototype.getChangeFileContent=function(){return this._mVariantManagement;};
c.prototype.compareVariants=function(v,o){if(v.content.content.title.toLowerCase()<o.content.content.title.toLowerCase()){return-1;}else if(v.content.content.title.toLowerCase()>o.content.content.title.toLowerCase()){return 1;}return 0;};
c.prototype.getVariants=function(v){var d=this._mVariantManagement[v]&&this._mVariantManagement[v].variants;return d||[];};
c.prototype.getVariant=function(v,s){var o;var d=this.getVariants(v);d.some(function(e){if(e.content.fileName===s){o=e;return true;}});return o;};
c.prototype.getVariantChanges=function(v,s,d){s=s||this._mVariantManagement[v].defaultVariant;var r=[];if(s&&typeof s==="string"){var o=this.getVariant(v,s);r=o.controlChanges;if(d){r=r.map(function(e,f){var g;if(!e.getDefinition){g=new C(e);o.controlChanges.splice(f,1,g);}else{g=e;}return g;});}}return r;};
c.prototype._getReferencedChanges=function(v,o){var r=[];if(o.content.variantReference){r=this.getVariantChanges(v,o.content.variantReference,true);return r.filter(function(R){return L.compareAgainstCurrentLayer(R.getDefinition().layer,o.content.layer)===-1;});}return r;};
c.prototype.setVariantChanges=function(v,s,d){if(!v||!s||!Array.isArray(d)){a.error("Cannot set variant changes without Variant reference");return undefined;}return this._mVariantManagement[v].variants.some(function(o){if(o.content.fileName===s){o.controlChanges=d;return true;}});};
c.prototype._setVariantData=function(m,v,p){var d=this._mVariantManagement[v].variants;var o=d[p];Object.keys(m).forEach(function(P){if(o.content.content[P]){o.content.content[P]=m[P];}});if(o.content.fileName!==v){d.splice(p,1);var s=this._getIndexToSortVariant(d.slice(1),o);d.splice(s+1,0,o);return s+1;}d.splice(p,1,o);return p;};
c.prototype._updateChangesForVariantManagementInMap=function(o,v,A){var d=this._mVariantManagement[v];var s=o.changeType;if(o.fileType==="ctrl_variant_change"){d.variants.some(function(e){if(e.content.fileName===o.selector.id){if(!e.variantChanges[s]){e.variantChanges[s]=[];}if(A){e.variantChanges[s].push(o);}else{e.variantChanges[s].some(function(E,I){if(E.fileName===o.fileName){e.variantChanges[s].splice(I,1);return true;}});}return true;}});}else if(o.fileType==="ctrl_variant_management_change"){if(!d.variantManagementChanges){d.variantManagementChanges={};}if(!d.variantManagementChanges[s]){d.variantManagementChanges[s]=[];}if(A){d.variantManagementChanges[s].push(o);}else{d.variantManagementChanges[s].some(function(e,I){if(e.fileName===o.fileName){d.variantManagementChanges[s].splice(I,1);return true;}});}}};
c.prototype.loadInitialChanges=function(){return Object.keys(this._mVariantManagement).reduce(function(I,v){var s=this._mVariantManagement[v].currentVariant?"currentVariant":"defaultVariant";var o=this.getVariant(v,this._mVariantManagement[v][s]);if(!o||!o.content.content.visible){this._mVariantManagement[v][s]=v;}return I.concat(this.getVariantChanges(v,this._mVariantManagement[v][s],false));}.bind(this),[]);};
c.prototype.getChangesForVariantSwitch=function(p){var d=this.getVariantChanges(p.variantManagementReference,p.currentVariantReference,true);var m=[];var e=[];Object.keys(p.changesMap).forEach(function(f){p.changesMap[f].forEach(function(M){m=m.concat(M);e=e.concat(M.getId());});});d=d.reduce(function(f,o){var M=e.indexOf(o.getDefinition().fileName);if(M>-1){f=f.concat(m[M]);}return f;},[]);var n=this.getVariantChanges(p.variantManagementReference,p.newVariantReference,true);var r=[];if(n.length>0){r=d.slice();d.some(function(o){if(n[0]&&o.getId()===n[0].getId()){n.shift();r.shift();}else{return true;}});}else{r=d;}var s={changesToBeReverted:r.reverse(),changesToBeApplied:n};return s;};
c.prototype._applyChangesOnVariant=function(v){var m=v.variantChanges;var A;Object.keys(m).forEach(function(s){switch(s){case"setTitle":A=this._getActiveChange(s,m);if(A){v.content.content.title=A.getText("title");}break;case"setFavorite":A=this._getActiveChange(s,m);if(A){v.content.content.favorite=A.getContent().favorite;}break;case"setVisible":A=this._getActiveChange(s,m);if(A){v.content.content.visible=A.getContent().visible;}break;default:a.error("No valid changes on variant "+v.content.content.title+" available");}}.bind(this));};
c.prototype._applyChangesOnVariantManagement=function(v){var m=v.variantManagementChanges;var A;if(Object.keys(m).length>0){A=this._getActiveChange("setDefault",m);if(A){v.defaultVariant=A.getContent().defaultVariant;}}};
c.prototype._getActiveChange=function(s,m){var l=m[s].length-1;if(l>-1){return new C(m[s][l]);}return false;};
c.prototype.fillVariantModel=function(){var v={};Object.keys(this._mVariantManagement).forEach(function(k){v[k]={defaultVariant:this._mVariantManagement[k].defaultVariant,variants:[]};if(this._mVariantManagement[k].currentVariant){v[k].currentVariant=this._mVariantManagement[k].currentVariant;}this.getVariants(k).forEach(function(o,d){v[k].variants[d]=JSON.parse(JSON.stringify({key:o.content.fileName,title:o.content.content.title,layer:o.content.layer,favorite:o.content.content.favorite,visible:o.content.content.visible,author:O.get("content.support.user",o)}));});}.bind(this));return v;};
c.prototype.updateCurrentVariantInMap=function(v,n){this._mVariantManagement[v].currentVariant=n;};
c.prototype.addChangeToVariant=function(o,v,s){var n=this.getVariantChanges(v,s,true);var d=n.map(function(o){return o.getDefinition().fileName;});var I=d.indexOf(o.getDefinition().fileName);if(I===-1){n.push(o);return this.setVariantChanges(v,s,n);}return false;};
c.prototype.removeChangeFromVariant=function(o,v,s){var d=this.getVariantChanges(v,s,true);d=d.filter(function(e){return e.getId()!==o.getId();});return this.setVariantChanges(v,s,d);};
c.prototype.addVariantToVariantManagement=function(v,s){var d=this._mVariantManagement[s].variants.slice().splice(1);var I=this._getIndexToSortVariant(d,v);if(v.content.variantReference){var r=this._getReferencedChanges(s,v);v.controlChanges=r.concat(v.controlChanges);}this._mVariantManagement[s].variants.splice(I+1,0,v);return I+1;};
c.prototype._getIndexToSortVariant=function(v,o){var I=0;v.some(function(e,d){if(this.compareVariants(o,e)<0){I=d;return true;}I=d+1;}.bind(this));return I;};
c.prototype.removeVariantFromVariantManagement=function(v,s){var I;var f=this._mVariantManagement[s].variants.some(function(o,d){var e=new V(o);if(e.getId()===v.getId()){I=d;return true;}});if(f){this._mVariantManagement[s].variants.splice(I,1);}return I;};
c.prototype.assignResetMapListener=function(l){_=l;};
c.prototype.resetMap=function(r){if(r){return Promise.resolve(_());}this._mVariantManagement={};return Promise.resolve();};
c.prototype.checkAndSetVariantContent=function(o,t){var v=this.getChangeFileContent();var s=Object.keys(v).length===0||Object.keys(v).every(function(d){var e=v[d].variants;return e.length===1&&!e[0].content.layer&&e[0].controlChanges.length===0&&Object.keys(e[0].variantChanges).length===0;});if(s){this.setChangeFileContent(o,t);}};
return c;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/transport/TransportDialog',["sap/m/List","sap/m/InputListItem","sap/m/Button","sap/m/ComboBox","sap/m/Dialog","sap/m/DialogRenderer","sap/m/Input","sap/m/MessageToast","sap/ui/core/ListItem"],function(L,I,B,C,D,a,b,M,c){"use strict";
var T=D.extend("sap.ui.fl.write._internal.transport.TransportDialog",{
metadata:{library:"sap.ui.fl",properties:{pkg:{type:"string",group:"Misc",defaultValue:null},transports:{type:"any",group:"Misc",defaultValue:null},lrepObject:{type:"any",group:"Misc",defaultValue:null},hidePackage:{type:"boolean",group:"Misc",defaultValue:null}},events:{ok:{},cancel:{}}},
renderer:a.render
});
T.prototype.init=function(){D.prototype.init.apply(this);this._oResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");this.setTitle(this._oResources.getText("TRANSPORT_DIALOG_TITLE"));this._oPackageLabel=null;this._oPackage=this._createPackageField();this._oTransport=this._createTransportCombo();this.addContent(this._createContentList());this._createButtons();this.setEscapeHandler(function(p){this.fireCancel();p.resolve();}.bind(this));};
T.prototype._createContentList=function(){this._oPackageListItem=new I({label:this._oResources.getText("TRANSPORT_DIALOG_PACKAGE"),content:[this._oPackage]});this._oTransportListItem=new I({label:this._oResources.getText("TRANSPORT_DIALOG_TRANSPORT"),content:[this._oTransport]});return new L({items:[this._oPackageListItem,this._oTransportListItem]});};
T.prototype._createButtons=function(){var t=this;this.addButton(new B({text:this._oResources.getText("TRANSPORT_DIALOG_LOCAL_OBJECT"),tooltip:this._oResources.getText("TRANSPORT_DIALOG_LOCAL_OBJECT"),press:function(){t._onLocal();}}));this.addButton(new B({text:this._oResources.getText("TRANSPORT_DIALOG_OK"),tooltip:this._oResources.getText("TRANSPORT_DIALOG_OK"),enabled:false,press:function(){t._onOkay();}}));this.addButton(new B({text:this._oResources.getText("TRANSPORT_DIALOG_CANCEL"),tooltip:this._oResources.getText("TRANSPORT_DIALOG_CANCEL"),press:function(){t.fireCancel();t.close();t.destroy();}}));};
T.prototype._onLocal=function(){this.fireOk({selectedTransport:"",selectedPackage:this.getPkg()||"$TMP",dialog:true});this.close();this.destroy();};
T.prototype._onOkay=function(){var t=this._oTransport.getSelectedKey();if(this._checkOkay(t)){this.fireOk({selectedTransport:t,selectedPackage:this.getPkg()||this._oPackage.getValue(),dialog:true});this.close();this.destroy();}else{this.getButtons()[1].setEnabled(false);this._oTransport.setValueState(sap.ui.core.ValueState.Error);this._oTransport.setValueStateText(this.getTitle());}};
T.prototype._checkOkay=function(t){if(t){return true;}return false;};
T.prototype._createTransportCombo=function(){var t=this;return new C({showSecondaryValues:true,enabled:false,tooltip:this._oResources.getText("TRANSPORT_DIALOG_TRANSPORT_TT"),width:"100%",selectionChange:function(){if(t._oPackageListItem.getVisible()&&!t._oPackage.getValue()){return;}t.getButtons()[1].setEnabled(true);t._oTransport.setValueState(sap.ui.core.ValueState.None);},change:function(e){var f=function(i){if((i&&e.mParameters.newValue!==i.getText())||!i){return true;}return false;};if(e&&e.mParameters&&e.mParameters.newValue){if(f(t._oTransport.getSelectedItem())){t.getButtons()[1].setEnabled(false);t._oTransport.setValueState(sap.ui.core.ValueState.Error);t._oTransport.setValueStateText(t._oResources.getText("TRANSPORT_DIALOG_TRANSPORT_TT"));}}}});};
T.prototype._createPackageField=function(){var t=this;return new b({tooltip:this._oResources.getText("TRANSPORT_DIALOG_PACKAGE_TT"),width:"100%",change:function(){var o;var p;var O;O=t._createObjectInfo();o=new sap.ui.fl.write._internal.transport.Transports();p=o.getTransports(O);p.then(function(r){t._onPackageChangeSuccess(r);},function(r){t._onPackageChangeError(r);});},liveChange:function(e){if(e.mParameters.liveValue&&e.mParameters.liveValue.length>3){t._oTransport.setEnabled(true);}}});};
T.prototype._createObjectInfo=function(){var o;var r={"package":this._oPackage.getValue()||""};o=this.getProperty("lrepObject");if(o){if(o.name){r.name=o.name;}if(o.type){r.type=o.type;}if(o.namespace){r.namespace=o.namespace;}}return r;};
T.prototype._onPackageChangeSuccess=function(t){if(t){if(t.localonly){this._oTransport.setEnabled(false);this.getButtons()[1].setEnabled(true);}else if(t.transports&&t.transports.length>0){this._oTransport.setEnabled(true);this._setTransports(t);}else if(t.errorCode){this.getButtons()[1].setEnabled(false);this._oPackage.setValueState(sap.ui.core.ValueState.Error);this._oPackage.setValueStateText(this._oResources.getText("TRANSPORT_DIALOG_"+t.errorCode));this._setTransports(t);}else{M.show(this._oResources.getText("TRANSPORT_DIALOG_NO_TRANSPORTS"));}}};
T.prototype._setTransports=function(t){var l;var d;l=this._hasLock(t.transports);if(l){d=[l];}else{d=t.transports;}this.setTransports(d);if(d&&d.length===1){this._oTransport.setValue(d[0].description,true);this.getButtons()[1].setEnabled(true);}if(!d||d.length===0){this._oTransport.setSelectedKey(null);this._oTransport.setValueState(sap.ui.core.ValueState.None);this.getButtons()[1].setEnabled(false);}};
T.prototype._onPackageChangeError=function(r){M.show(r);this.setTransports([]);};
T.prototype._hasLock=function(t){var o;var l=t.length;while(l--){o=t[l];if(o.locked){return o;}}return null;};
T.prototype.setPkg=function(p){if(p&&!this.getProperty("pkg")){this.setProperty("pkg",p);this._oPackage.setValue(p);this._oPackage.setEnabled(false);this._oTransport.setEnabled(true);this.setTitle(this._oResources.getText("TRANSPORT_DIALOG_TITLE_SIMPLE"));this.getButtons()[0].setVisible(false);}return this;};
T.prototype.setTransports=function(s){var i;var l=0;var o;if(s){this.setProperty("transports",s);this._oTransport.removeAllItems();l=s.length;for(i=0;i<l;i++){o=s[i];this._oTransport.addItem(new c({key:o.transportId,text:o.transportId,additionalText:o.description}));}if(l===1){this._oTransport.setSelectedKey(s[0].transportId);this.getButtons()[1].setEnabled(true);}if(l>0){this._oTransport.setEnabled(true);}}return this;};
T.prototype.setLrepObject=function(o){if(o&&!this.getProperty("lrepObject")){this.setProperty("lrepObject",o);}return this;};
T.prototype.setHidePackage=function(h){this.setProperty("hidePackage",h);this._oPackageListItem.setVisible(!h);if(h){this.getButtons()[0].setEnabled(h);this.setTitle(this._oResources.getText("TRANSPORT_DIALOG_TITLE_SIMPLE"));}return this;};
return T;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/transport/TransportSelection',["sap/ui/fl/LayerUtils","sap/ui/fl/Layer","sap/ui/fl/write/_internal/transport/Transports","sap/ui/fl/write/_internal/transport/TransportDialog","sap/ui/fl/registry/Settings","sap/ui/core/BusyIndicator"],function(L,a,T,b,F,B){"use strict";var c=function(){this.oTransports=new sap.ui.fl.write._internal.transport.Transports();};
c.prototype.selectTransport=function(o,O,e,C,d,s){var r=function(o,O,e,C,s,A){this.oTransports.getTransports(o).then(function(g){if(this._checkDialog(g,A)){this._openDialog({hidePackage:!L.doesCurrentLayerRequirePackage(),pkg:o.package,transports:g.transports,lrepObject:this._toLREPObject(o)},O,e,C,s);}else{var t=(!g.localonly&&A)?{transportId:"ATO_NOTIFICATION"}:this._getTransport(g);O(this._createEventObject(o,t));}}.bind(this),function(R){e(R);});};var l=L.getCurrentLayer(false);if(l&&((l===a.CUSTOMER)||(l===a.CUSTOMER_BASE))){F.getInstance().then(function(S){if(S.isAtoEnabled()){if(!(o&&o.name&&o.namespace&&o.type)){var t={transportId:"ATO_NOTIFICATION"};O(this._createEventObject(o,t));}else{r.apply(this,[o,O,e,C,s,true]);}}else{r.apply(this,[o,O,e,C,s,false]);}}.bind(this));}else{r.apply(this,[o,O,e,C,s,false]);}};
c.prototype._createEventObject=function(o,t){return{mParameters:{selectedTransport:t.transportId,selectedPackage:o["package"],dialog:false},getParameters:function(){return this.mParameters;},getParameter:function(n){return this.mParameters[n];}};};
c.prototype._toLREPObject=function(o){var O={};if(o.namespace){O.namespace=o.namespace;}if(o.name){O.name=o.name;}if(o.type){O.type=o.type;}return O;};
c.prototype._openDialog=function(C,o,e,d,s){var D=new b(C);D.attachOk(o);D.attachCancel(e);D.addStyleClass(s);if(d){D.addStyleClass("sapUiSizeCompact");}else{D.removeStyleClass("sapUiSizeCompact");}D.open();B.hide();return D;};
c.prototype._getTransport=function(t){var o;if(!t.localonly){o=this._hasLock(t.transports);}else{o={transportId:""};}return o;};
c.prototype._checkDialog=function(t,A){if(t){if(t.localonly||this._hasLock(t.transports)||(!t.localonly&&A)){return false;}}return true;};
c.prototype._hasLock=function(t){var l=t.length;while(l--){var o=t[l];if(o.locked){return o;}}return false;};
c.prototype.setTransports=function(C,o){var i=C.length-1;var t=this;var s=function(C,i,o,d,f){if(i>=0){var e=C[i];if(f===true){if(e.getDefinition().packageName!=="$TMP"){e.setRequest(d);}i--;return s(C,i,o,d,f);}if(e.getDefinition().packageName!=="$TMP"){return t.openTransportSelection(e,o).then(function(g){if(g==="cancel"){return Promise.reject("cancel");}e.setRequest(g.transport);if(g.fromDialog===true){d=g.transport;f=true;}i--;return s(C,i,o,d,f);},function(){return null;});}i--;return s(C,i,o,d,f);}return Promise.resolve();};return s(C,i,o);};
c.prototype.openTransportSelection=function(C,o,s){var t=this;return new Promise(function(r,d){var O=function(R){if(R&&R.getParameters){var g=R.getParameters().selectedTransport;var p=R.getParameters().selectedPackage;var h=R.getParameters().dialog;var i={transport:g,packageName:p,fromDialog:h};r(i);}else{r({});}};var e=function(E){if(E.sId==='cancel'){r(E.sId);}else{d(E);}};var f={};if(C){f["package"]=C.getPackage();f.namespace=C.getNamespace();f.name=C.getId();f.type=C.getDefinition().fileType;}t.selectTransport(f,O,e,false,o,s);});};
c.prototype.checkTransportInfo=function(t){return t&&t.transport&&t.packageName!=="$TMP";};
c.prototype._prepareChangesForTransport=function(t,A,d,C){var o=new T();var e=o._convertToChangeTransportData(A,d);var f={};f.package=t.packageName;f.transportId=t.transport;f.changeIds=e;f.reference=C.reference;f.appVersion=C.appVersion;f.layer=C.layer;return o.makeChangesTransportable(f).then(function(){A.forEach(function(g){if(g.getPackage()==='$TMP'){var D=g.getDefinition();D.packageName=t.packageName;g.setResponse(D);}});});};
return c;},true);
sap.ui.predefine('sap/ui/fl/write/_internal/transport/Transports',["sap/ui/fl/LrepConnector","sap/ui/fl/Utils"],function(L,F){"use strict";var T=function(){};
T.prototype.getTransports=function(p){var u;var c;var l;var P;u='/sap/bc/lrep/actions/gettransports/';if(p['package']){u+='&package='+p['package'];}if(p.name){u+='&name='+p.name;}if(p.namespace){u+='&namespace='+p.namespace;}if(p.type){u+='&type='+p.type;}c=F.getClient();if(c){u+='&sap-client='+c;}u=u.replace('&','?');l=L.createConnector();P=l.send(u);return P.then(function(r){if(r.response){if(!r.response.localonly){r.response.localonly=false;}if(!r.response.errorCode){r.response.errorCode="";}return Promise.resolve(r.response);}return Promise.reject('response is empty');});};
T.prototype.makeChangesTransportable=function(p){var u;var c;var l;u='/sap/bc/lrep/actions/make_changes_transportable/';c=F.getClient();if(c){u+='?sap-client='+c;}if(!p.transportId){return Promise.reject(new Error("no transportId provided as attribute of mParameters"));}if(!p.changeIds){return Promise.reject(new Error("no changeIds provided as attribute of mParameters"));}l=L.createConnector();return l.send(u,'POST',p);};
T.prototype._convertToChangeTransportData=function(l,a){var t=[];var i;if(a&&a.length){for(i=0;i<a.length;i++){var A=a[i];var p={};p.namespace=A.getNamespace();p.fileName=A.getDefinition().fileName;p.fileType=A.getDefinition().fileType;t.push(p);}}var b=l.length;for(i=0;i<b;i++){var c=l[i];var d={};d.namespace=c.getNamespace();d.fileName=c.getId();d.fileType=c.getDefinition().fileType;t.push(d);}return t;};
return T;},true);
sap.ui.require.preload({
	"sap/ui/fl/manifest.json":'{"_version":"1.9.0","sap.app":{"id":"sap.ui.fl","type":"library","embeds":["support/apps/contentbrowser","support/apps/uiFlexibilityDiagnostics"],"applicationVersion":{"version":"1.74.0"},"title":"SAPUI5 library with sap.ui.fl controls.","description":"SAPUI5 library with sap.ui.fl controls.","ach":"CA-UI5-FL","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.74","libs":{"sap.ui.core":{"minVersion":"1.74.0"},"sap.m":{"minVersion":"1.74.0"}}},"library":{"i18n":"messagebundle.properties","content":{"controls":["sap.ui.fl.variants.VariantManagement","sap.ui.fl.util.IFrame"]}}}}'
},"sap/ui/fl/library-preload"
);
//# sourceMappingURL=library-preload.js.map