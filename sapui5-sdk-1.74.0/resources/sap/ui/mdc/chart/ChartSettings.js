/*
 * ! SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/mdc/p13n/Util","sap/ui/mdc/library","sap/base/util/merge"],function(U,M,m){"use strict";var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");var C={showPanel:function(c,p,s,P){this.aProperties=P;return new Promise(function(r,b){C["_getP13nStateOf"+p](c).then(function(o){U["showP13n"+p](c,s,o,r);});});},_getP13nStateOfChart:function(c){return new Promise(function(r,b){var d=a.getText('chart.PERSONALIZATION_DIALOG_TYPE_DIMENSION');var s=a.getText('chart.PERSONALIZATION_DIALOG_TYPE_MEASURE');var p={};p.items=[];var e=C.getCurrentState(c).visibleItems;var P=this.aProperties;var E=e.reduce(function(f,o,i){f[o.name]=o;f[o.name].position=i;return f;},{});P.forEach(function(o){var f=E[o.name]?true:false;p.items.push({id:f?E[o.name].id:undefined,name:o.name,label:f?E[o.name].label||o.label:o.label||o.name,sortOrder:f?E[o.name].sortOrder:"",selected:f,position:f?E[o.name].position:-1,kind:o.kind==M.ChartItemType.Dimension?d:s,role:f?E[o.name].role:o.role,propertyPath:o.propertyPath,availableRoles:C._getChartItemTextByKey(o.kind)});});r(p);}.bind(this));},_getP13nStateOfSort:function(c){return new Promise(function(r,b){var p={};p.items=[];var e=C.getCurrentState(c).visibleItems;var E=e.reduce(function(d,P){d[P.name]=P;return d;},{});var s={};for(var i=0;i<this.aProperties.length;i++){if(this.aProperties[i].sortable&&c._aInResultProperties.indexOf(this.aProperties[i].name)!=-1){s[this.aProperties[i].name]=this.aProperties[i];s[this.aProperties[i].name].label=E[this.aProperties[i].name].label||this.aProperties[i].label;}}c._aInResultProperties.forEach(function(P){var S=-1;var d;var f=m({},C.getCurrentState(c).sorters);Object.keys(f).forEach(function(n,g){if(s[n]&&n===P){S=g;d=f[n].descending;}});p.items.push({name:P,label:s[P].label||P,descending:d||s[P].descending,position:S,selected:S>-1});});r(p);}.bind(this));},getCurrentState:function(c){return{visibleItems:this._getVisibleProperties(c),sorters:this._getSortedProperties(c)};},_getVisibleProperties:function(c){var p=[];if(c){c.getItems().forEach(function(o){p.push({name:o.getKey(),id:o.getId(),label:o.getLabel(),role:o.getRole()});});}return p;},_getSortedProperties:function(c){return c.getSortConditions()||{};},_getChartItemTextByKey:function(k){var A={Dimension:[{key:M.ChartItemRoleType.category,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_CATEGORY')},{key:M.ChartItemRoleType.category2,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_CATEGORY2')},{key:M.ChartItemRoleType.series,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_SERIES')}],Measure:[{key:M.ChartItemRoleType.axis1,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_AXIS1')},{key:M.ChartItemRoleType.axis2,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_AXIS2')},{key:M.ChartItemRoleType.axis3,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_AXIS3')}]};return A[k];}};return C;});
