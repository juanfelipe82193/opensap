/*
 * ! SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/mdc/p13n/Util','sap/ui/core/Control','sap/base/util/merge','sap/base/util/deepEqual','sap/ui/model/PropertyBinding','sap/ui/model/Context','sap/ui/model/base/ManagedObjectModel','sap/ui/base/ManagedObjectObserver','sap/base/Log','sap/ui/mdc/library','sap/ui/mdc/filterbar/FilterItemLayout','sap/ui/mdc/condition/ConditionModel','sap/ui/mdc/condition/Condition','sap/ui/mdc/FilterField','sap/ui/mdc/field/FieldValueHelp','sap/ui/mdc/util/IdentifierUtil','sap/ui/mdc/util/ConditionUtil','sap/ui/layout/AlignedFlowLayout','sap/m/library','sap/m/Button','sap/ui/model/json/JSONModel',"sap/ui/fl/write/api/ControlPersonalizationWriteAPI","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/base/util/UriParameters"],function(p,C,m,d,P,a,M,b,L,c,F,e,f,g,h,I,k,A,l,B,J,n,o,U){"use strict";var q=l.ButtonType;var r=C.extend("sap.ui.mdc.FilterBar",{metadata:{library:"sap.ui.mdc",designtime:"sap/ui/mdc/designtime/FilterBar.designtime",defaultAggregation:"filterItems",interfaces:["sap.ui.mdc.IFilter"],properties:{delegate:{type:"object",defaultValue:{name:"sap/ui/mdc/FilterBarDelegate",payload:{modelName:undefined,collectionName:""}}},liveMode:{type:"boolean",defaultValue:false},showGoButton:{type:"boolean",defaultValue:true},showAdaptFiltersButton:{type:"boolean",defaultValue:true},p13nMode:{type:"sap.ui.mdc.FilterBarP13nMode[]"},filterConditions:{type:"object",defaultValue:{}},_filterCount:{type:"string",visibility:"hidden"},_p13nModeItem:{type:"boolean",visibility:"hidden",defaultValue:false},_p13nModeValue:{type:"boolean",visibility:"hidden",defaultValue:false}},aggregations:{filterItems:{type:"sap.ui.mdc.FilterField",multiple:true},basicSearchField:{type:"sap.ui.mdc.FilterField",multiple:false}},events:{search:{conditions:{type:"object"}},reset:{},filtersChanged:{filtersText:{type:"string"}}}},renderer:function(R,i){R.write("<div ");R.writeControlData(i);R.writeClasses();R.write(">");R.renderControl(i._getContent());R.write("</div>");}});r.INNER_MODEL_NAME="$sap.ui.mdc.FilterBar";r.CONDITION_MODEL_NAME="$filters";r.prototype.init=function(){this.addStyleClass("sapUiMdcBaseFilterBar");this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");this._createInnerModel();this._oObserver=new b(this._observeChanges.bind(this));this._oObserver.observe(this,{aggregations:["filterItems"]});this._oFilterBarLayout=new A();this._addButtons();this._clearChanges();this._aProperties=null;var u=new U(window.location.href);this._bAdvancedDialog=u.get("AdvancedFB")==="true";this._fResolveMetadataApplied=undefined;this._oMetadataAppliedPromise=new Promise(function(i){this._fResolveMetadataApplied=i;}.bind(this));this._fResolveInitialFiltersApplied=undefined;this._oInitialFiltersAppliedPromise=new Promise(function(i){this._fResolveInitialFiltersApplied=i;}.bind(this));this._bIgnoreChanges=false;};r.prototype._getConditionModel=function(){return this._oConditionModel;};r.prototype.getConditionModelName=function(){return this._getConditionModelName();};r.prototype._getConditionModelName=function(){return r.CONDITION_MODEL_NAME;};r.prototype._createConditionModel=function(){this._oConditionModel=new e();this.setModel(this._oConditionModel,this._getConditionModelName());};r.prototype._getMetaModelName=function(){var D=this.getDelegate();if(D&&D.payload&&D.payload.hasOwnProperty("modelName")){return this.getDelegate().payload.modelName===null?undefined:this.getDelegate().payload.modelName;}return null;};r.prototype._getEntitySetName=function(){var D=this.getDelegate();if(D&&D.payload&&D.payload.collectionName){return this.getDelegate().payload.collectionName;}return null;};r.prototype.applySettings=function(s,S){var i;C.prototype.applySettings.apply(this,arguments);this._createConditionModel();this._oConditionChangeBinding=this._oConditionModel.bindProperty("/conditions",this._oConditionModel.getContext("/conditions"));this._oConditionChangeBinding.attachChange(this._handleConditionModelChange,this);i=this.getFilterConditions();if(i&&Object.keys(i).length>0){if(!this._oMetadataPromise){this._oMetadataPromise=this._retrieveMetadata();}Promise.all([this._oMetadataAppliedPromise]).then(function(){this._applyInitialFilterConditions();}.bind(this));}else{this._fResolveInitialFiltersApplied();}};r.prototype.setP13nMode=function(i){var O=this.getP13nMode();this.setProperty("p13nMode",i||[],false);i&&i.forEach(function(s){if(!O||O.indexOf(s)<0){this._setP13nMode(s,true);}}.bind(this));O&&O.forEach(function(s){if(!i||i.indexOf(s)<0){this._setP13nMode(s,false);}}.bind(this));return this;};r.prototype._setP13nMode=function(s,v){switch(s){case"Item":this._setP13nModeItem(v);break;case"Value":this._setP13nModeValue(v);break;}};r.prototype._getP13nModeItem=function(){return this._oModel.getProperty("/_p13nModeItem");};r.prototype._setP13nModeItem=function(v){this._oModel.setProperty("/_p13nModeItem",v,true);};r.prototype._getP13nModeValue=function(){return this._oModel.getProperty("/_p13nModeValue");};r.prototype._setP13nModeValue=function(v){this._oModel.setProperty("/_p13nModeValue",v,false);};r.prototype._createInnerModel=function(){this._oModel=new M(this);this.setModel(this._oModel,r.INNER_MODEL_NAME);return this;};r.prototype._addButtons=function(){if(this._oFilterBarLayout){this.setProperty("_filterCount",this._oRb.getText("filterbar.ADAPT"),false);this._btnAdapt=new B(this.getId()+"-btnAdapt",{text:"{"+r.INNER_MODEL_NAME+">/_filterCount}",press:this.onAdaptFilters.bind(this)});this._btnAdapt.setModel(this._oModel,r.INNER_MODEL_NAME);this._btnAdapt.bindProperty("visible",{parts:[{path:'/showAdaptFiltersButton',model:r.INNER_MODEL_NAME},{path:"/_p13nModeItem",model:r.INNER_MODEL_NAME}],formatter:function(v,V){return v&&V;}});this._btnAdapt.addStyleClass("sapUiMdcBaseFilterBarButtonPaddingRight");this._oFilterBarLayout.addEndContent(this._btnAdapt);this._btnSearch=new B(this.getId()+"-btnSearch",{text:this._oRb.getText("filterbar.GO"),press:this.onSearch.bind(this),type:q.Emphasized});this._btnSearch.setModel(this._oModel,r.INNER_MODEL_NAME);this._btnSearch.bindProperty("visible",{parts:[{path:'/showGoButton',model:r.INNER_MODEL_NAME},{path:"/liveMode",model:r.INNER_MODEL_NAME}],formatter:function(v,V){return v&&!V;}});this._oFilterBarLayout.addEndContent(this._btnSearch);}};r.prototype._initializeProvider=function(){var D=this.getDelegate();if(D){var s=D.name;if(!s){return Promise.resolve(null);}return this._loadProvider(s);}else{L.error("not able to obtain the delegate.");return Promise.resolve(null);}};r.prototype._loadProvider=function(D){return new Promise(function(R){sap.ui.require([D],function(i){R(i);});});};r.prototype.onAdaptFilters=function(E){this.prepareAndShowDialog();};r.prototype._afterSettingsDone=function(){delete this._settingsTriggered;};r.prototype._getAssignedFilterNames=function(){var i,N,j=null,s=this._getConditionModel(),t;if(s){i=s.getAllConditions();j=[];for(N in i){if(j.indexOf(N)<0){var u=s.getConditions(N);if(u&&u.length>0){if(N==="$search"){j.push(this._oRb.getText("filterbar.ADAPT_SEARCHTERM"));}else{t=this._getFilterField(N);if(t){if(t.getVisible()){j.push(N);}}else{j.push(N);}}}}}}return j;};r.prototype._getAssignedFiltersText=function(j){var s,t;j=j||[];if(j.length>5){t=j.slice(0,5);t.push("...");}else{t=j;}s=Object.keys(t).map(function(i){return t[i];}).join(", ");if(j.length){return this._oRb.getText("filterbar.ADAPT_FILTERED",[j.length,s]);}return this._oRb.getText("filterbar.ADAPT_NOTFILTERED");};r.prototype.getAssignedFiltersText=function(){return this._getAssignedFiltersText(this._getAssignedFilterNames());};r.prototype._handleConditionModelChange=function(E){if(!this._bIgnoreChanges){this._handleAssignedFilterNames(E);this._handleCalculateDifferences();}};r.prototype._handleCalculateDifferences=function(s,i){var j=m({},this.getProperty("filterConditions"));this._calculateConditionsDiffsToPrevStateAndSave(j,this._getConditionModel());};r.prototype._calculateConditionsDiffsToPrevState=function(j,s){var i,t,u,v,w=[],D=[];if(s){v=this._getConditions(s);if(!d(v,j)){for(t in v){if(!j[t]){for(i=0;i<v[t].length;i++){u=this._createAddRemoveConditionChangeWithFieldPath("addCondition",t,v[t][i]);if(u){w.push(u);}}}else{w=w.concat(this._calculateConditionsDifference(t,v,j));D.push(t);}}for(i=0;i<D.length;i++){delete v[D[i]];delete j[D[i]];}for(t in j){if(!v[t]){for(i=0;i<j[t].length;i++){u=this._createAddRemoveConditionChangeWithFieldPath("removeCondition",t,j[t][i]);if(u){w.push(u);}}}}}}return w;};r.prototype._calculateConditionsDiffsToPrevStateAndSave=function(i,j){if(!this._getP13nModeValue()){return;}var s=this._calculateConditionsDiffsToPrevState(i,j);if(s.length>0){this._aChanges=this._aChanges.concat(s);this._storeChanges();}};r.prototype._determineType=function(s){var i,j=this._getFilterField(s);if(j){return j;}i=this._getPropertyByName(s);if(i){return i;}L.error("not able to resolve metadata for "+s);return null;};r.prototype._calculateConditionsDifference=function(s,O,i){var t,j,u,v,w=[];var x=O[s]?m([],O[s]):[];var S=i[s]?m([],i[s]):[];if(d(x,S)){return w;}this._removeSameConditions(x,S);if((x.length>0)||(S.length>0)){v=this._determineType(s);if(v){if(v.isA&&v.isA("sap.ui.mdc.FilterField")){t=v.getDataType();j=v.getDataTypeFormatOptions();u=v.getDataTypeConstraints();}else{t=v.type;j=v.formatOptions;u=v.constraints;}}x.forEach(function(y){y=k.toExternal(y,t,j,u);});S.forEach(function(y){w.push(this._createAddRemoveConditionChange("removeCondition",s,t,j,u,y));}.bind(this));x.forEach(function(y){w.push(this._createAddRemoveConditionChange("addCondition",s,t,j,u,y));}.bind(this));}return w;};r.prototype._cleanupConditions=function(i){if(i){i.forEach(function(j){if(j.hasOwnProperty("isEmpty")){delete j.isEmpty;}});}};r.prototype._strigifyConditions=function(s,i){var j=this._getPropertyByName(s);var R=i;if(j&&i){R=[];i.forEach(function(t){if(t&&t.values&&t.values.length>0){var u=k.toExternal(t,j.type,j.formatOptions,j.constraints);R.push(u);}});}return R;};r.prototype._removeSameConditions=function(s,S){var R;do{R=false;for(var i=0;i<s.length;i++){for(var j=0;j<S.length;j++){if(d(s[i],S[j])){s.splice(i,1);S.splice(j,1);R=true;break;}}if(R){break;}}}while(R);};r.prototype._handleAssignedFilterNames=function(E){var O={},i=this._getAssignedFilterNames();if(i){if(this._btnAdapt){this.setProperty("_filterCount",this._oRb.getText(i.length?"filterbar.ADAPT_NONZERO":"filterbar.ADAPT",i.length),false);this._oFilterBarLayout.reflow();}O.filtersText=this._getAssignedFiltersText(i);this.fireFiltersChanged(O);if(this.getLiveMode()){this.fireSearch();}}};r.prototype.onReset=function(E){this.fireReset();};r.prototype.onSearch=function(E){this.fireSearch();};r.prototype.fireSearch=function(E){var i=this.getConditions(true);this.fireEvent("search",{conditions:i});};r.prototype.getConditions=function(D){return this._getConditions(this._getConditionModel(),D);};r.prototype._getConditions=function(i,D){var j={};if(i){var s=i.getAllConditions();for(var t in s){if(s[t]&&(s[t].length>0)){j[t]=m([],s[t]);if(!D){this._cleanupConditions(j[t]);var u=this._strigifyConditions(t,j[t]);j[t]=u;}}}}return j;};r.prototype.setConditions=function(i){var j=this._getConditionModel();if(j){for(var s in i){j.removeAllConditions(s);var t=i[s];t.forEach(function(u){j.addCondition(s,u);});}}};r.prototype.prepareAndShowDialog=function(){if(!this._oMetadataPromise){this._oMetadataPromise=this._retrieveMetadata();}return this._oMetadataAppliedPromise.then(function(){var i=[],j=[],s=this._setItemsForAdaptFiltersDialog();if(s&&s.length>0){s.forEach(function(t){if(t.control instanceof Promise){i.push(t.control);j.push(t);}});if(i.length>0){return Promise.all(i).then(function(R){i.forEach(function(t,u){var v=j[u];var w=R[u];v.control=w.clone();R[u].destroy();v.control.setVisible(true);v.control.bindProperty("conditions",{path:"$cmodel>/conditions/"+v.name});v.visible=false;});return this._showFiltersDialog(s);}.bind(this));}else{return Promise.resolve().then(function(){return this._showFiltersDialog(s);}.bind(this));}}}.bind(this));};r.prototype._showFiltersDialog=function(i){this._clearChanges();var j=new J({showResetEnabled:false,items:i});if(!this._settingsTriggered){this._settingsTriggered=true;return p.showAdaptFilters(this,this._btnAdapt,j.getData(),this._afterSettingsDone.bind(this),this._bAdvancedDialog).then(function(s){this._oAdaptFiltersPanel=s;this._oAdaptFiltersPanel.setAdaptFilterPanelColumns(this._bAdvancedDialog);if(this._bAdvancedDialog){var t=this._getConditionModel().clone();s.setAdvancedMode(true);s.setModel(t,"$cmodel");s.insertFilterItems(false);s.attachChange(function(E){var u=s.getModel("$cmodel");this._calculateConditionsDiffsToPrevStateAndSave(this._getConditionModel().getAllConditions(),u);}.bind(this));}return s;}.bind(this));}};r.prototype._createFilterVisibilityChangeContent=function(i,N){return{id:i,name:N};};r.prototype._createAddRemoveConditionChangeWithFieldPath=function(s,i,j){var O=this._determineType(i);if(!O){return null;}if(O.isA&&O.isA("sap.ui.mdc.FilterField")){return this._createAddRemoveConditionChangeWithField(s,O,j);}else{return this._createAddRemoveConditionChange(s,i,O.type,O.formatOptions,O.constraints,j);}};r.prototype._createAddRemoveConditionChange=function(s,i,t,j,u,v,O,w){var x=v;if(v&&v.values&&v.values.length>0){x=k.toExternal(v,t,j,u);}var y={selectorElement:this,changeSpecificData:{changeType:s,content:{name:i,condition:x,outConditions:O?O:null}}};return y;};r.prototype._createAddRemoveConditionChangeWithField=function(s,i,j,O,t){return this._createAddRemoveConditionChange(s,i.getFieldPath(),i.getDataType(),i.getDataTypeFormatOptions(),i.getDataTypeConstraints(),j,O,t);};r.prototype._clearChanges=function(){this._aChanges=[];};r.prototype._storeChanges=function(){if(!this._getP13nModeItem()&&!this._getP13nModeValue()){this._clearChanges();return;}if(this._aChanges&&this._aChanges.length){var H=o.hasVariantManagement({element:this});try{n.add({changes:this._aChanges,ignoreVariantManagement:!H});}catch(i){L.error("error while saving changes - "+i.message);}this._clearChanges();}};r.prototype._setItemsForAdaptFiltersDialog=function(){var i=this.getFilterItems();if(this._getNonHiddenPropertyInfoSet().length>0){return this._getNonHiddenPropertyInfoSet().map(function(j,s){var K=I.getPropertyKey(j);var t=this._getFilterField(K);var u=i.indexOf(t);var v=null,V=false;if(this._bAdvancedDialog){if(t){v=t.clone();}else{v=this._oDelegate.beforeAddFilterFlex(K,this);}if(!v){L.error("_setItemsForAdaptFiltersDialog: not able to dermine/create a filter item for property: '"+K+"'");}}else{v=t||undefined;}if(v&&v.isA&&v.isA("sap.ui.mdc.FilterField")){v.setVisible(true);if(this._bAdvancedDialog){v.bindProperty("conditions",{path:"$cmodel>/conditions/"+K});}V=(u>-1)&&t.getVisible();}return{id:V?v.getId():undefined,name:K,label:j.label,isFiltered:this.getConditions()[K]&&!this._bAdvancedDialog?true:false,tooltip:j.tooltip,groupLabel:j.groupLabel,required:j.required,position:u,selected:V,control:v};}.bind(this));}};r.prototype._getContent=function(){return this._oFilterBarLayout;};r.prototype._insertFilterFieldtoContent=function(i,j){if(!F){return;}var s=new F();s.setFilterField(i);this._oFilterBarLayout.insertContent(s,j);};r.prototype._filterItemInserted=function(i){if(!i.getVisible()){return;}if(i.setWidth){i.setWidth("");}if(this._isChangeApplying()){this._suspendBinding(i);}this._applyFilterItemInserted(i);};r.prototype._applyFilterItemInserted=function(j){var s,t;t=this.indexOfAggregation("filterItems",j);if(this.getAggregation("basicSearchField")){t++;}s=t;var u=this.getFilterItems();for(var i=0;i<s;i++){if(!u[i].getVisible()){t--;}}this._insertFilterFieldtoContent(j,t);if(!this._oObserver.isObserved(j,{properties:["visible"]})){this._oObserver.observe(j,{properties:["visible"]});}};r.prototype._filterItemRemoved=function(i){this._applyFilterItemRemoved(i.getFieldPath());};r.prototype._applyFilterItemRemoved=function(s){this._removeFilterFieldFromContentByName(s);};r.prototype._removeFilterFieldFromContent=function(i){this._removeFilterFieldFromContentByName(i.getFieldPath());};r.prototype._removeFilterFieldFromContentByName=function(s){var i=this._getFilterItemLayoutByName(s);if(i){this._oFilterBarLayout.removeContent(i);i.destroy();}};r.prototype._observeChanges=function(i){if(i.type==="aggregation"&&i.name==="filterItems"){switch(i.mutation){case"insert":this._filterItemInserted(i.child);break;case"remove":this._filterItemRemoved(i.child);break;default:L.error("operation "+i.mutation+" not yet implemented");}}else if(i.type==="property"){var j;if(i.object.isA&&i.object.isA("sap.ui.mdc.FilterField")){j=i.object;if(j){if(i.current){this._filterItemInserted(j);}else{this._filterItemRemoved(j);}this._oFilterBarLayout.rerender();}}}};r.prototype._getFilterItemLayout=function(i){return this._getFilterItemLayoutByName(i.getFieldPath());};r.prototype._getFilterItemLayoutByName=function(s){var i=null;this._oFilterBarLayout.getContent().some(function(j){if(j._getFieldPath()===s){i=j;}return i!==null;});return i;};r.prototype._getFilterField=function(N){var i=null;this.getFilterItems().some(function(j){if(j&&j.getFieldPath&&(j.getFieldPath()===N)){i=j;}return i!==null;});return i;};r.prototype._retrieveMetadata=function(){return new Promise(function(i){Promise.all([this._initializeProvider()]).then(function(j){if(!this._bIsBeingDestroyed){this._oDelegate=j[0];this._aProperties=[];if(this._oDelegate&&this._oDelegate.fetchProperties){try{this._oDelegate.fetchProperties(this).then(function(t){this._aProperties=t;this._fResolveMetadataApplied();}.bind(this),function(t){L.error(t);this._fResolveMetadataApplied();}.bind(this));}catch(s){L.error("Exception during fetchProperties occured: "+s.message);this._fResolveMetadataApplied();}}else{L.error("Provided delegate '"+this.getDelegate().path+"' not valid.");this._fResolveMetadataApplied();}}i();}.bind(this));}.bind(this));};r.prototype.setBasicSearchField=function(i){var O=this.getAggregation("basicSearchField");if(O){this._removeFilterFieldFromContent(O);}this.setAggregation("basicSearchField",i);if(i){if(!this._oObserver.isObserved(i,{properties:["visible"]})){this._oObserver.observe(i,{properties:["visible"]});}this._insertFilterFieldtoContent(i,0);}return this;};r.prototype.getPropertyInfoSet=function(){return this._aProperties||[];};r.prototype._getNonHiddenPropertyInfoSet=function(){var v=[];this.getPropertyInfoSet().every(function(i){if(!i.hiddenFilter){if(I.getPropertyKey(i)!=="$search"){v.push(i);}}return true;});return v;};r.prototype._getNonHiddenPropertyByName=function(N){var i=null;this._getNonHiddenPropertyInfoSet().some(function(j){if(I.getPropertyKey(j)===N){i=j;}return i!=null;});return i;};r.prototype._getPropertyByName=function(N){var i=null;this.getPropertyInfoSet().some(function(j){if(I.getPropertyKey(j)===N){i=j;}return i!=null;});return i;};r.prototype.applyConditionsAfterChangesApplied=function(){if(this._isChangeApplying()){return;}this._bIgnoreChanges=true;var i=this.getFilterItems();i.forEach(function(j){this._suspendBinding(j);}.bind(this));this._oFlexPromise=o.waitForChanges({element:this});Promise.all([this._oFlexPromise,this._oInitialFiltersAppliedPromise]).then(function(v){this._applyFilterConditionsChanges();this._resumeBindings();this._oFlexPromise=null;if(!this._iShadowModelResolveTimer&&!this._iShadowModelTimer){this._iShadowModelTimer=setTimeout(function(){delete this._iShadowModelTimer;this._createShadowModel();}.bind(this),0);}}.bind(this));};r.prototype.waitForInitialFiltersApplied=function(){return this._oInitialFiltersAppliedPromise;};r.prototype._suspendBinding=function(i){if(i){var j=i.getBinding("conditions");if(j){if(!this._aBindings){this._aBindings=[];}j.suspend();this._aBindings.push(i);}}};r.prototype._resumeBindings=function(){if(this._aBindings){this._aBindings.forEach(function(i){if(!i.bIsDestroy){var j=i.getBinding("conditions");if(j){j.resume();}}});this._aBindings=null;}};r.prototype._isChangeApplying=function(){return!!this._oFlexPromise;};r.prototype._applyInitialFilterConditions=function(){this._bIgnoreChanges=true;this._applyFilterConditionsChanges();if(!this._iShadowModelResolveTimer){if(this._iShadowModelTimer){clearTimeout(this._iShadowModelTimer);delete this._iShadowModelTimer;}this._iShadowModelResolveTimer=setTimeout(function(){delete this._iShadowModelResolveTimer;this._createShadowModel();this._fResolveInitialFiltersApplied();}.bind(this),0);}};r.prototype._applyFilterConditionsChanges=function(){var i,j,s,O,t,u,v;var S=this.getProperty("filterConditions");if(Object.keys(S).length>0){j=m([],S);s=this._getConditionModel();s.removeAllConditions();if(j){for(var w in j){i=j[w];O=this._determineType(w);if(O){if(O.isA&&O.isA("sap.ui.mdc.FilterField")){t=O.getDataType();u=O.getDataTypeFormatOptions();v=O.getDataTypeConstraints();}else{t=O.type;u=O.formatOptions;v=O.constraints;}i.forEach(function(x){x=k.toInternal(x,t,u,v);var N=f.createCondition(x.operator,x.values);s.addCondition(w,N);});}}}}};r.prototype._createShadowModel=function(){var i,s={};var j=this._getConditionModel();var t=this._getConditions(j);for(var u in t){i=t[u];i.forEach(function(v){if(!s[u]){s[u]=[];}s[u].push(v);});this._cleanupConditions(s[u]);}this.setProperty("filterConditions",s);this._bIgnoreChanges=false;this._handleConditionModelChange();};r.prototype._getView=function(){return I.getView(this);};r.prototype.getFilters=function(){return this._getConditionModel()?this._getConditionModel().getFilters():[];};r.prototype.getSearch=function(){var s=this._getConditionModel()?this._getConditionModel().getConditions("$search"):[];return s[0]?s[0].values[0]:"";};r.prototype.exit=function(){C.prototype.exit.apply(this,arguments);if(this._oFilterBarLayout){this._oFilterBarLayout.destroy();this._oFilterBarLayout=null;}this._btnAdapt=undefined;this._btnSearch=undefined;this._oRb=null;if(this._oModel){this._oModel.destroy();this._oModel=null;}if(this._oConditionChangeBinding){this._oConditionChangeBinding.detachChange(this._handleConditionModelChange,this);this._oConditionChangeBinding=null;}if(this._oConditionModel){this._oConditionModel.destroy();this._oConditionModel=null;}this._oObserver.disconnect();this._oObserver=undefined;this._oDelegate=null;this._aProperties=null;this._oFlexPromise=null;this._oMetadataPromise=null;this._fResolveMetadataApplied=undefined;this._oMetadataAppliedPromise=null;this._fResolveInitialFiltersApplied=undefined;this._oInitialFiltersAppliedPromise=null;if(this._iShadowModelTimer){clearTimeout(this._iShadowModelTimer);delete this._iShadowModelTimer;}if(this._iShadowModelResolveTimer){clearTimeout(this._iShadowModelResolveTimer);delete this._iShadowModelResolveTimer;}this._aChanges=null;this._oView=null;this._aBindings=null;};return r;});
