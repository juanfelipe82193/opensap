/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/ui/Device','sap/ui/mdc/library','sap/ui/mdc/field/FieldBaseRenderer','sap/ui/mdc/condition/FilterOperatorUtil','sap/ui/mdc/condition/Condition','sap/ui/mdc/field/ConditionType','sap/ui/mdc/field/ConditionsType','sap/ui/mdc/util/BaseType','sap/ui/mdc/util/DateUtil','sap/ui/core/library','sap/ui/core/Control','sap/ui/core/message/MessageMixin','sap/base/util/ObjectPath','sap/base/util/deepEqual','sap/base/util/merge','sap/base/Log','sap/base/util/isEmptyObject','sap/ui/dom/containsOrEquals','sap/ui/model/Filter','sap/ui/model/base/ManagedObjectModel','sap/ui/base/ManagedObjectObserver',"sap/ui/base/SyncPromise",'sap/ui/events/KeyCodes'],function(q,D,l,F,a,C,b,c,B,d,e,f,M,O,g,m,L,h,k,n,o,p,S,K){"use strict";var E=l.EditMode;var r=l.FieldDisplay;var V=e.ValueState;var s=e.CalendarType;var t=f.extend("sap.ui.mdc.field.FieldBase",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.mdc",properties:{dataType:{type:"string",group:"Data",defaultValue:'sap.ui.model.type.String'},dataTypeConstraints:{type:"object",group:"Data",defaultValue:null},dataTypeFormatOptions:{type:"object",group:"Data",defaultValue:null},editMode:{type:"sap.ui.mdc.EditMode",group:"Data",defaultValue:E.Editable},required:{type:"boolean",group:"Data",defaultValue:false},display:{type:"sap.ui.mdc.FieldDisplay",defaultValue:r.Value},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:sap.ui.core.TextAlign.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:sap.ui.core.TextDirection.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:""},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:sap.ui.core.ValueState.None},valueStateText:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},multipleLines:{type:"boolean",group:"Appearance",defaultValue:false},maxConditions:{type:"int",group:"Behavior",defaultValue:-1},conditions:{type:"object[]",group:"Data",defaultValue:[],byValue:true},label:{type:"string",group:"Misc",defaultValue:""},delegate:{type:"object",defaultValue:{name:"sap/ui/mdc/odata/v4/FieldBaseDelegate",payload:{}}},_fieldHelpEnabled:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false},contentEdit:{type:"sap.ui.core.Control",multiple:false},contentDisplay:{type:"sap.ui.core.Control",multiple:false},_content:{type:"sap.ui.core.Control",multiple:true,visibility:"hidden"},fieldInfo:{type:"sap.ui.mdc.field.FieldInfoBase",multiple:false}},associations:{fieldHelp:{type:"sap.ui.mdc.field.FieldHelpBase",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{liveChange:{parameters:{value:{type:"string"},escPressed:{type:"boolean"},previousValue:{type:"string"}}},press:{}},publicMethods:[],defaultAggregation:"content"},_oManagedObjectModel:null});M.call(t.prototype);var u={Default:{edit:"sap/m/Input",editMulti:["sap/m/MultiInput","sap/m/Token"],editMultiLine:"sap/m/TextArea",display:"sap/m/Text",createEdit:h1,createEditMulti:j1,createEditMultiLine:k1,createDisplay:l1},Search:{edit:"sap/m/SearchField",display:"sap/m/Text",createEdit:i1,createDisplay:l1},Date:{edit:"sap/m/DatePicker",editMulti:["sap/m/MultiInput","sap/m/Token"],display:"sap/m/Text",createEdit:m1,createEditMulti:j1,createDisplay:l1},Time:{edit:"sap/m/TimePicker",editMulti:["sap/m/MultiInput","sap/m/Token"],display:"sap/m/Text",createEdit:m1,createEditMulti:j1,createDisplay:l1},DateTime:{edit:"sap/m/DateTimePicker",editMulti:["sap/m/MultiInput","sap/m/Token"],display:"sap/m/Text",createEdit:m1,createEditMulti:j1,createDisplay:l1},Link:{edit:"sap/m/Input",editMulti:["sap/m/MultiInput","sap/m/Token"],editMultiLine:"sap/m/TextArea",display:"sap/m/Link",createEdit:h1,createEditMulti:j1,createEditMultiLine:k1,createDisplay:n1},Boolean:{edit:"sap/m/Input",display:"sap/m/Text",createEdit:o1,createDisplay:l1},Unit:{edit:"sap/m/Input",editMulti:["sap/m/MultiInput","sap/m/Input","sap/m/Token"],display:"sap/m/Text",createEdit:p1,createEditMulti:q1,createDisplay:l1}};var v;var w;t._init=function(){v={};w={bool:{name:"sap/ui/mdc/field/BoolFieldHelp",id:"BoolDefaultHelp",control:undefined}};};t._init();t.prototype.init=function(){this._oManagedObjectModel=new o(this);this._oObserver=new p(this._observeChanges.bind(this));this._oObserver.observe(this,{properties:["display","editMode","dataType","dataTypeFormatOptions","dataTypeConstraints","multipleLines","maxConditions","conditions","delegate"],aggregations:["fieldInfo","content","contentEdit","contentDisplay"],associations:["fieldHelp","ariaLabelledBy"]});this._oDatePickerRequested={};this.attachEvent("modelContextChange",this._handleModelContextChange,this);this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");this._aAsyncChanges=[];this._oDelegate=undefined;this._oDelegatePromise=new Promise(function(i,j){this._oDelegateResolve=i;this._oDelegateReject=j;}.bind(this));};t.prototype.exit=function(){var i=this.getFieldInfo();if(i){i.detachEvent("dataUpdate",Q1,this);}var j=this.getContent();if(j){b1.call(this,j);}var _1=this.getContentEdit();if(_1){b1.call(this,_1);}var a2=this.getContentDisplay();if(a2){b1.call(this,a2);}this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;this._oObserver.disconnect();this._oObserver=undefined;if(this._oConditionType&&this._oConditionType._bCreatedByField){this._oConditionType.destroy();this._oConditionType=undefined;}if(this._oConditionsType&&this._oConditionsType._bCreatedByField){this._oConditionsType.destroy();this._oConditionsType=undefined;}var b2=F1.call(this);if(b2){b2.detachEvent("dataUpdate",K1,this);if(this._bConnected){L1.call(this);b2.connect();}}if(this.iLiveChangeTimer){clearTimeout(this.iLiveChangeTimer);}};t.prototype.applySettings=function(){f.prototype.applySettings.apply(this,arguments);if(!this._oDelegate&&!this._oDelegateLoading){Z1.call(this,this.getDelegate());}};t.prototype.onBeforeRendering=function(){if(!this._oDelegate){this._oDelegatePromise.then(function(){d1.call(this);}.bind(this));return;}d1.call(this);};t.prototype.onAfterRendering=function(){if(F1.call(this)&&this.getEditMode()!=E.Display){var j=this.getAggregation("_content",[]);for(var i=0;i<j.length;i++){var _1=j[i];var a2=_1.getFocusDomRef();q(a2).attr("autocomplete","off");}}};t.prototype.onfocusin=function(i){M1.call(this);};t.prototype.onsapup=function(i){var j=F1.call(this);var _1=i.srcControl;if(j&&(!this._bIsMeasure||_1.getShowValueHelp())){i.preventDefault();i.stopPropagation();j.navigate(-1);}};t.prototype.onsapdown=function(i){var j=F1.call(this);var _1=i.srcControl;if(j&&(!this._bIsMeasure||_1.getShowValueHelp())){i.preventDefault();i.stopPropagation();j.navigate(1);}};t.prototype.onsapenter=function(i){var j=F1.call(this);if(j&&j.isOpen(true)){j.close();}};t.prototype.clone=function(i,j){this.detachEvent("modelContextChange",this._handleModelContextChange,this);var _1=this.getContent();if(_1){b1.call(this,_1);}var a2=this.getContentEdit();if(a2){b1.call(this,a2);}var b2=this.getContentDisplay();if(b2){b1.call(this,b2);}var c2=this.getFieldInfo();if(c2){c2.detachEvent("dataUpdate",Q1,this);}var d2=f.prototype.clone.apply(this,arguments);this.attachEvent("modelContextChange",this._handleModelContextChange,this);if(_1){a1.call(this,_1);}if(a2){a1.call(this,a2);}if(b2){a1.call(this,b2);}if(c2){c2.attachEvent("dataUpdate",Q1,this);}return d2;};t.prototype.getFieldPath=function(){var i=this.getBindingPath("conditions");if(i&&i.startsWith("/conditions/")){return i.slice(12);}else{return"";}};function _(i,j,_1,a2){if(!a2){if(j){a2=Promise.resolve(this._getResultForPromise(i));}else{a2=Promise.reject(_1);}}this._fireChange(i,j,_1,a2);}t.prototype._fireChange=function(i,j,_1,a2){};function x(i){i=this._oDelegate.getDataTypeClass(this._oPayload,i);var j=y.call(this,i);if(j){return new j(I.call(this,i,this.getDataTypeFormatOptions(),this.getDataTypeConstraints()),this.getDataTypeConstraints());}}function y(i){var j=O.get(i||"");if(!j){throw new Error("DataType cannot be determined");}return j;}function z(){if(!this._oDataType){this._oDataType=this.getDataType();if(typeof this._oDataType==="string"){this._oDataType=x.call(this,this._oDataType);}}return this._oDataType;}t.prototype._initDataType=function(){if(this._oDataType){this._oDataType.destroy();this._oDataType=undefined;}if(this._oDateOriginalType){this._oDateOriginalType.destroy();this._oDateOriginalType=undefined;}if(this._oUnitOriginalType){this._oUnitOriginalType.destroy();this._oUnitOriginalType=undefined;}delete this._sDisplayFormat;delete this._sValueFormat;delete this._sCalendarType;};function A(){if(this._oDataType&&typeof this._oDataType==="object"){return this._oDataType.getMetadata().getName();}else if(this._oDelegate){return this._oDelegate.getDataTypeClass(this._oPayload,this.getDataType());}else{return this.getDataType();}}function G(){if(this._oDataType&&typeof this._oDataType==="object"&&this._oDataType.oConstraints){return this._oDataType.oConstraints;}else{return this.getDataTypeConstraints();}}function H(){if(this._oDataType&&typeof this._oDataType==="object"&&this._oDataType.oFormatOptions){return this._oDataType.oFormatOptions;}else{return this.getDataTypeFormatOptions();}}function I(i,j,_1){if(this.getMaxConditions()!==1||this.getEditMode()===E.Display){return j;}var a2=this._oDelegate.getBaseType(this._oPayload,i,j,_1);switch(a2){case B.Date:this._sValueFormat="yyyy-MM-dd";break;case B.DateTime:this._sValueFormat="yyyy-MM-dd'T'HH:mm:ss";break;case B.Time:this._sValueFormat="HH:mm:ss";break;default:return j;}this._sDisplayFormat="medium";if(j){j=m({},j);if(j.style){this._sDisplayFormat=j.style;delete j.style;}else if(j.pattern){this._sDisplayFormat=j.pattern;}if(j.calendarType){this._sCalendarType=j.calendarType;}j.pattern=this._sValueFormat;j.calendarType=s.Gregorian;}else{j={pattern:this._sValueFormat,calendarType:s.Gregorian};}return j;}function J(){var i=z.call(this);var j=i.getMetadata().getName();var _1=i.oFormatOptions;var a2=i.oConstraints;if(!_1||_1.style||!_1.pattern||_1.pattern!==this._sValueFormat||!_1.calendarType||_1.calendarType!==s.Gregorian){this._oDateOriginalType=this._oDataType;I.call(this,j,_1,a2);this._oDataType=d.createInternalType(i,this._sValueFormat);R1.call(this);}}function N(){var i=z.call(this);var j=i.getMetadata().getName();var _1=i.oFormatOptions;var a2=h(i.oConstraints)?undefined:i.oConstraints;if(!_1||!_1.hasOwnProperty("showMeasure")||_1.showMeasure){_1=m({},_1);_1.showMeasure=false;_1.strictParsing=true;if(_1.customCurrencies){delete _1.customCurrencies;}if(_1.customUnits){delete _1.customUnits;}var b2=O.get(j);this._oUnitOriginalType=this._oDataType;this._oDataType=new b2(_1,a2);this._oDelegate.initializeInternalUnitType(this._oPayload,this._oDataType,this._oTypeInitialization);R1.call(this);}}function P(i,j){var _1=F1.call(this);if(_1&&this._bConnected){G1.call(this,i,_1);}}t.prototype._getContent=function(){var i=this.getContent();if(!i){if(this.getEditMode()===E.Display){i=this.getContentDisplay();}else{i=this.getContentEdit();}}if(i){return[i];}else{return this.getAggregation("_content",[]);}};function Q(i){if(i===E.Editable||i===E.EditableReadOnly||i===E.EditableDisplay){return true;}else{return false;}}function R(i){if(i===E.Editable){return true;}else{return false;}}function T(i){if(i&&i!==E.Disabled){return true;}else{return false;}}function U(i){if(i&&i!==E.Editable){return true;}else{return false;}}t.prototype._handleModelContextChange=function(i){};function W(i){this.setValueState(V.Error);this.setValueStateText(i);}function X(){this.setValueState(V.None);this.setValueStateText();}t.prototype._observeChanges=function(j){var _1=function(){if(this.getAggregation("_content",[]).length>0){if(!this._oDelegate){this._oDelegatePromise.then(function(){d1.call(this);}.bind(this));}else{d1.call(this);}}};if(j.name==="editMode"){_1.call(this);}if(j.name==="multipleLines"){_1.call(this);}if(j.name==="dataType"){if(this._oDataType){var a2=function(d2){var e2=y.call(this,this._oDelegate.getDataTypeClass(this._oPayload,j.current));if(!(this._oDataType instanceof e2)){this._initDataType();this.destroyAggregation("_content");R1.call(this);}};if(!this._oDelegate){this._oDelegatePromise.then(function(){a2.call(this,j.current);}.bind(this));return;}a2.call(this,j.current);}}if(j.name==="dataTypeFormatOptions"||j.name==="dataTypeConstraints"){if(this._oDataType){this._initDataType();this.destroyAggregation("_content");R1.call(this);}}if(j.name==="maxConditions"){_1.call(this);R1.call(this);}if(j.name==="conditions"){this._bParseError=false;P.call(this,j.current,j.old);var b2=false;var i=0;for(i=0;i<this._aAsyncChanges.length;i++){var c2=this._aAsyncChanges[i];if(c2.waitForUpdate&&g(c2.result,j.current)){z1.call(this,c2);b2=true;break;}}if(b2){this._aAsyncChanges.splice(i,1);}}if(j.name==="display"){e1.call(this);R1.call(this);}if(j.name==="fieldHelp"&&j.ids){E1.call(this,j.ids,j.mutation);R1.call(this);}if(j.name==="fieldInfo"&&j.child){P1.call(this,j.child,j.mutation);}if(j.name==="content"&&j.child){$.call(this,j.child,j.mutation,j.name);}if(j.name==="contentEdit"&&j.child){$.call(this,j.child,j.mutation,j.name);}if(j.name==="contentDisplay"&&j.child){$.call(this,j.child,j.mutation,j.name);}if(j.name==="delegate"){Z1.call(this,j.current);}if(j.name==="ariaLabelledBy"&&j.ids){Y.call(this,j.ids,j.mutation);}};t.prototype.getFocusDomRef=function(){var i=this._getContent();if(i.length>0){return i[0].getFocusDomRef();}else{return this.getDomRef();}};t.prototype.getIdForLabel=function(){var i;var j=this._getContent();if(j.length>0){i=j[0].getIdForLabel();}else{i=this.getId();}return i;};t.prototype.getControlForSuggestion=function(){var i=this._getContent();if(i.length>0){if(this._bIsMeasure){return i[1];}else{return i[0];}}else{return this;}};t.prototype.getMaxConditionsForHelp=function(){if(this._bIsMeasure){return 1;}else{return this.getMaxConditions();}};t.prototype.enhanceAccessibilityState=function(i,j){var _1=this.getParent();if(_1&&_1.enhanceAccessibilityState){_1.enhanceAccessibilityState(this,j);}return j;};t.prototype.getAccessibilityInfo=function(){var i=this._getContent();if(i.length>0&&i[0].getAccessibilityInfo){return i[0].getAccessibilityInfo();}else{return{};}};function Y(j,_1){var a2=this.getAggregation("_content",[]);var b2=this.getContent();if(b2){a2.push(b2);}b2=this.getContentDisplay();if(b2){a2.push(b2);}b2=this.getContentEdit();if(b2){a2.push(b2);}for(var i=0;i<a2.length;i++){b2=a2[i];if(b2.getMetadata().getAllAssociations().ariaLabelledBy){if(_1==="remove"){b2.removeAriaLabelledBy(j);}else if(_1==="insert"){b2.addAriaLabelledBy(j);}}}}function Z(j){var _1=this.getAriaLabelledBy();for(var i=0;i<_1.length;i++){var a2=_1[i];j.addAriaLabelledBy(a2);}}t.prototype.connectLabel=function(i){g1.call(this,i);i.bindProperty("text",{path:"$field>/label"});i.setLabelFor(this);return this;};function $(i,j,_1){if(j==="remove"){b1.call(this,i);t1.call(this,i);if(this._oContentConditionTypes){delete this._oContentConditionTypes[_1];}}else if(j==="insert"){s1.call(this,i);g1.call(this,i);a1.call(this,i);if(this.getAggregation("_content",[]).length>0){e1.call(this);}if(!this._oContentConditionTypes){this._oContentConditionTypes={};}if(!this._oContentConditionTypes[_1]){this._oContentConditionTypes[_1]={};}var a2;var b2;for(b2 in i.getMetadata().getAllProperties()){if(i.getBindingPath(b2)==="/conditions"){a2=i.getBindingInfo(b2);if(a2&&a2.type&&a2.type instanceof c){this._oContentConditionTypes[_1].oConditionsType=a2.type;}this._sBoundProperty=b2;}if(b2==="editable"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/editMode",formatter:Q});}if(b2==="enabled"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/editMode",formatter:T});}if(b2==="displayOnly"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/editMode",formatter:U});}if(b2==="required"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/required"});}if(b2==="textAlign"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/textAlign"});}if(b2==="textDirection"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/textDirection"});}if(b2==="valueState"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/valueState"});}if(b2==="valueStateText"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/valueStateText"});}if(b2==="placeholder"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/placeholder"});}if(b2==="tooltip"&&!i.getBindingPath(b2)&&i.isPropertyInitial(b2)){i.bindProperty(b2,{path:"$field>/tooltip"});}}for(var c2 in i.getMetadata().getAllAggregations()){if(i.getBindingPath(c2)==="/conditions"){a2=i.getBindingInfo(c2);if(a2&&a2.template){for(b2 in a2.template.getMetadata().getAllProperties()){var d2=a2.template.getBindingInfo(b2);if(d2&&d2.type&&d2.type instanceof b){this._oContentConditionTypes[_1].oConditionType=d2.type;break;}}}break;}}}Z.call(this,i);}function a1(i){if(i.getMetadata().getEvents().change){i.attachEvent("change",y1,this);}if(i.getMetadata().getEvents().liveChange){i.attachEvent("liveChange",B1,this);}if(i.getMetadata().getEvents().press){i.attachEvent("press",C1,this);}}function b1(i){if(i.getMetadata().getEvents().change){i.detachEvent("change",y1,this);}if(i.getMetadata().getEvents().liveChange){i.detachEvent("liveChange",B1,this);}if(i.getMetadata().getEvents().press){i.detachEvent("press",C1,this);}}function c1(){if(this._oConditionType&&!this._oConditionType._bCreatedByField){this._oConditionType=undefined;}if(this._oConditionsType&&!this._oConditionsType._bCreatedByField){this._oConditionsType=undefined;}var i=this.getEditMode();var j;var _1;if(this.getContent()){if(this._oContentConditionTypes.content){j=this._oContentConditionTypes.content.oConditionType;_1=this._oContentConditionTypes.content.oConditionsType;}}else if(i===E.Display&&this.getContentDisplay()){if(this._oContentConditionTypes.contentDisplay){j=this._oContentConditionTypes.contentDisplay.oConditionType;_1=this._oContentConditionTypes.contentDisplay.oConditionsType;}}else if(i!==E.Display&&this.getContentEdit()){if(this._oContentConditionTypes.contentEdit){j=this._oContentConditionTypes.contentEdit.oConditionType;_1=this._oContentConditionTypes.contentEdit.oConditionsType;}}if(j){if(this._oConditionType&&this._oConditionType._bCreatedByField){this._oConditionType.destroy();}this._oConditionType=j;}if(_1){if(this._oConditionsType&&this._oConditionsType._bCreatedByField){this._oConditionsType.destroy();}this._oConditionsType=_1;}R1.call(this);}function d1(){c1.call(this);var j=this.getEditMode();if(this.getContent()||this._bIsBeingDestroyed||(j===E.Display&&this.getContentDisplay())||(j!==E.Display&&this.getContentEdit())){e1.call(this);return;}var _1=A.call(this);var a2=G.call(this);var b2=H.call(this);var c2=this._oDelegate.getBaseType(this._oPayload,_1,b2,a2);var d2=this.getMaxConditions();var e2;var f2;var g2;var h2=this.getAggregation("_content",[]);var i2;var j2;if(h2.length>0){i2=h2[0];j2=i2.getMetadata().getName().replace(/\./g,"/");}e2=u[c2];if(!e2){if(this.getFieldInfo()&&this._bTriggerable){e2=u.Link;}else{var k2=new RegExp("^\\*(.*)\\*|\\$search$");if(k2.test(this.getFieldPath())&&this.getMaxConditions()===1){e2=u.Search;}else{e2=u.Default;}}}if(j===E.Display){f2=e2.display;g2=e2.createDisplay;}else if(d2!==1){f2=e2.editMulti;g2=e2.createEditMulti;}else if(this.getMultipleLines()){f2=e2.editMultiLine;g2=e2.createEditMultiLine;}else{f2=e2.edit;g2=e2.createEdit;}if(!f2){throw new Error("No control defined for type "+_1+" in "+this);}var l2;if(Array.isArray(f2)){l2=f2;f2=l2[0];}else{l2=[f2];}if(f2!==j2){this._bHideOperator=false;if(i2){e1.call(this);if(i2.isA("sap.m.DateTimeField")){this._initDataType();}R1.call(this);}var m2;var i=0;for(i=0;i<l2.length;i++){var n2=l2[i];if(!v[n2]){v[n2]={};}if(!v[n2].control){v[n2].control=sap.ui.require(n2);if(!v[n2].control){m2=undefined;}}if(i===0){m2=v[n2].control;}}if(!m2){if(v[f2].promise){v[f2].promise.then(d1.bind(this));return;}else{v[f2].promise=new Promise(function(r2){v[f2].resolve=r2;sap.ui.require(l2,f1.bind(this));}.bind(this)).then(d1.bind(this));return;}}var o2=this.getId()+"-inner";var p2=g2.call(this,m2,o2);for(i=0;i<p2.length;i++){var q2=p2[i];q2.attachEvent("parseError",w1,this);q2.attachEvent("validationError",x1,this);s1.call(this,q2);g1.call(this,q2);if(this._bConnected&&((i===0&&!this._bIsMeasure)||(i===1&&this._bIsMeasure))){N1.call(this,q2);}this.addAggregation("_content",q2);}}}function e1(){this.destroyAggregation("_content");if(this._oDateOriginalType){this._oDataType=this._oDateOriginalType;this._oDateOriginalType=undefined;}else if(this._oUnitOriginalType){this._oDataType=this._oUnitOriginalType;this._oUnitOriginalType=undefined;}}function f1(){for(var i=0;i<arguments.length;i++){var j=arguments[i];var _1=j.getMetadata().getName();_1=_1.replace(/\./g,"/");v[_1].control=j;if(v[_1].resolve){v[_1].resolve();delete v[_1].resolve;}}}function g1(i){i.setModel(this._oManagedObjectModel,"$field");}function h1(i,j){var _1=T1.call(this);var a2=new i(j,{value:{path:"$field>/conditions",type:_1},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"100%",tooltip:"{$field>/tooltip}",change:y1.bind(this),liveChange:B1.bind(this),valueHelpRequest:H1.bind(this),showSuggestion:true});a2._setPreferUserInteraction(true);O1.call(this,a2);Z.call(this,a2);this._sBoundProperty="value";return[a2];}function i1(i,j){this._bHideOperator=true;var _1=S1.call(this);R1.call(this);var a2=new i(j,{value:{path:"$field>/conditions/0",type:_1,mode:"OneWay"},placeholder:"{$field>/placeholder}",width:"100%",tooltip:"{$field>/tooltip}",search:y1.bind(this)});Z.call(this,a2);return[a2];}function j1(i,j){var _1=sap.ui.require("sap/m/Token");var a2=S1.call(this);var b2=new _1(j+"-token",{text:{path:'$field>',type:a2}});var c2=new i(j,{placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"100%",tooltip:"{$field>/tooltip}",tokens:{path:"$field>/conditions",template:b2},dependents:[b2],change:y1.bind(this),liveChange:B1.bind(this),tokenUpdate:D1.bind(this),valueHelpRequest:H1.bind(this)});c2._setPreferUserInteraction(true);O1.call(this,c2);Z.call(this,c2);return[c2];}function k1(i,j){var _1=T1.call(this);var a2=new i(j,{value:{path:"$field>/conditions",type:_1},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",change:y1.bind(this),liveChange:B1.bind(this)});a2._setPreferUserInteraction(true);Z.call(this,a2);this._sBoundProperty="value";return[a2];}function l1(i,j){var _1=T1.call(this);var a2=new i(j,{text:{path:"$field>/conditions",type:_1},textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",wrapping:"{$field>/multipleLines}",width:"100%",tooltip:"{$field>/tooltip}"});this._sBoundProperty="text";return[a2];}function m1(i,j){this._bHideOperator=true;var _1=T1.call(this);J.call(this);var a2=new i(j,{value:{path:"$field>/conditions",type:_1},displayFormat:this._sDisplayFormat,valueFormat:this._sValueFormat,placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",change:y1.bind(this)});if(a2.setDisplayFormatType){a2.setDisplayFormatType(this._sCalendarType);}a2._setPreferUserInteraction(true);Z.call(this,a2);this._sBoundProperty="value";return[a2];}function n1(i,j){var _1=this.getFieldInfo();var a2=T1.call(this);var b2=new i(j,{text:{path:"$field>/conditions",type:a2},textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",tooltip:"{$field>/tooltip}",press:C1.bind(this)});if(_1&&_1.getMetadata().getName()==="sap.ui.mdc.field.FieldInfo"){_1.getDirectLinkHrefAndTarget().then(function(c2){if(c2){b2.setHref(c2.href);b2.setTarget(c2.target);}});}Z.call(this,b2);this._sBoundProperty="text";return[b2];}function o1(i,j){if(!this.getFieldHelp()){u1.call(this,"bool");}return h1.call(this,i,j);}function p1(i,j){N.call(this);this._bIsMeasure=true;var _1=T1.call(this);var a2=[];var b2=new i(j,{value:{path:"$field>/conditions",type:_1},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:false,width:"70%",tooltip:"{$field>/tooltip}",change:y1.bind(this),liveChange:B1.bind(this)});b2._setPreferUserInteraction(true);Z.call(this,b2);a2.push(b2);a2=r1.call(this,a2,j,i);this._sBoundProperty="value";return a2;}function q1(i,j){N.call(this);this._bIsMeasure=true;var _1=sap.ui.require("sap/m/Token");var a2=sap.ui.require("sap/m/Input");var b2=S1.call(this);var c2=[];var d2=new _1(j+"-token",{text:{path:'$field>',type:b2}});var e2=new n({path:"values",test:function(g2){if(!Array.isArray(g2[0])||g2[0][0]){return true;}else{return false;}}});var f2=new i(j,{placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:false,width:"70%",tooltip:"{$field>/tooltip}",tokens:{path:"$field>/conditions",template:d2,filters:[e2]},dependents:[d2],change:y1.bind(this),liveChange:B1.bind(this),tokenUpdate:D1.bind(this)});f2._setPreferUserInteraction(true);Z.call(this,f2);c2.push(f2);c2=r1.call(this,c2,j,a2);this._sBoundProperty="value";return c2;}function r1(i,j,_1){var a2=U1.call(this);if(this.getEditMode()===E.EditableDisplay){i[0].bindProperty("description",{path:"$field>/conditions",type:a2});i[0].setWidth("100%");i[0].setFieldWidth("70%");}else{var b2=new _1(j+"-unit",{value:{path:"$field>/conditions",type:a2},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:R},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"30%",tooltip:"{$field>/tooltip}",change:y1.bind(this),liveChange:B1.bind(this),valueHelpRequest:H1.bind(this)});b2._setPreferUserInteraction(true);O1.call(this,b2);Z.call(this,b2);i.push(b2);}return i;}function s1(i){if(i.onsapprevious){i._origOnsapprevious=i.onsapprevious;i.onsapprevious=function(j){var _1=F1.call(this);if(j.keyCode!==K.ARROW_UP&&(!_1||!_1.isOpen())){var i=this._getContent()[0];i._origOnsapprevious(j);}}.bind(this);}if(i.onsapnext){i._origOnsapnext=i.onsapnext;i.onsapnext=function(j){var _1=F1.call(this);if(j.keyCode!==K.ARROW_DOWN&&(!_1||!_1.isOpen())){var i=this._getContent()[0];i._origOnsapnext(j);}}.bind(this);}if(i.onsapup){i._origOnsapup=i.onsapup;i.onsapup=function(j){var _1=F1.call(this);if(!_1||!_1.isOpen()){var i=this._getContent()[0];i._origOnsapup(j);}}.bind(this);}if(i.onsapdown){i._origOnsapdown=i.onsapdown;i.onsapdown=function(j){var _1=F1.call(this);if(!_1||!_1.isOpen()){var i=this._getContent()[0];i._origOnsapdown(j);}}.bind(this);}if(i.onsapbackspace){i._origOnsapbackspace=i.onsapbackspace;i.onsapbackspace=function(j){var _1=F1.call(this);if(!_1||!_1.isOpen()){var i=this._getContent()[0];i._origOnsapbackspace(j);}}.bind(this);}}function t1(i){if(i._origOnsapprevious){i.onsapprevious=i._origOnsapprevious;delete i._origOnsapprevious;}if(i._origOnsapnext){i.onsapnext=i._origOnsapnext;delete i._origOnsapnext;}if(i._origOnsapup){i.onsapup=i._origOnsapup;delete i._origOnsapup;}if(i._origOnsapdown){i.onsapdown=i._origOnsapdown;delete i._origOnsapdown;}if(i._origOnsapbackspace){i.onsapbackspace=i._origOnsapbackspace;delete i._origOnsapbackspace;}}function u1(i){this.setProperty("_fieldHelpEnabled",true,true);this._sDefaultFieldHelp=w[i].id;var j=w[i].control;if(j&&j.bIsDestroyed){w[i].control=undefined;j=undefined;}if(!j){if(w[i].promise){w[i].promise.then(v1.bind(this));}var _1=sap.ui.require(w[i].name);if(!_1&&!w[i].promise){w[i].promise=new Promise(function(a2){w[i].resolve=a2;sap.ui.require([w[i].name],function(b2){u1.call(this,i);}.bind(this));}.bind(this)).then(v1.bind(this));}if(_1){j=new _1(w[i].id);w[i].control=j;j.connect(this);if(w[i].resolve){w[i].resolve();delete w[i].resolve;}if(!w[i].promise){v1.call(this);}}}}function v1(){E1.call(this,"BoolDefaultHelp","insert");O1.call(this,this.getAggregation("_content",[])[0]);}function w1(i){this._bParseError=true;}function x1(_1){this._bParseError=true;var a2=_1.getParameter("newValue");var b2=false;var i=0;for(i=0;i<this._aAsyncChanges.length;i++){var c2=this._aAsyncChanges[i];if(c2.waitForUpdate&&Array.isArray(c2.result)){for(var j=0;j<c2.result.length;j++){var d2=c2.result[j];if(g(d2.values[0],a2)||(d2.operator==="BT"&&g(d2.values[1],a2))){c2.reject(_1.getParameter("exception"));b2=true;break;}}if(b2){break;}}}if(b2){this._aAsyncChanges.splice(i,1);}}function y1(i){var j={parameters:m({},i.getParameters()),source:i.getSource()};var _1=this._aAsyncChanges.length;if(_1>0&&!this._aAsyncChanges[_1-1].changeFired){this._aAsyncChanges[_1-1].changeFired=true;this._aAsyncChanges[_1-1].changeEvent=j;_.call(this,undefined,undefined,undefined,this._aAsyncChanges[_1-1].promise);return;}var a2={changeEvent:j};z1.call(this,a2);}function z1(i){var j=this.getConditions();var _1;var a2=true;var b2;var c2;var d2=i.changeEvent.source;var e2=false;if(i.changeEvent.parameters.hasOwnProperty("valid")){a2=i.changeEvent.parameters["valid"];if(!a2&&i.changeEvent.parameters.hasOwnProperty("value")){b2=i.changeEvent.parameters["value"];}}var f2=false;var g2=this._sBoundProperty&&d2.getBindingInfo(this._sBoundProperty);if(g2&&g2.binding&&g2.binding.sPath==="/conditions"&&a2){c2=j[0];_1=j[0]&&j[0].values[0];}else if(i.changeEvent.parameters.hasOwnProperty("value")){_1=i.changeEvent.parameters["value"];if(a2){f2=true;}}else if(i.changeEvent.parameters.hasOwnProperty("query")){_1=i.changeEvent.parameters["query"];f2=true;}else{c2=j[0];_1=j[0]&&j[0].values[0];}if(f2){X.call(this);var h2;var i2;c2=S.resolve().then(function(){if(this._oNavigateCondition){a2=true;return this._oNavigateCondition;}else{h2=S1.call(this);var k2=h2.parseValue(_1);var l2=this._aAsyncChanges.length;if(l2>0&&!this._aAsyncChanges[l2-1].changeFired){i2=this._aAsyncChanges[l2-1];i2.changeFired=true;i2.changeEvent=i.changeEvent;_.call(this,undefined,undefined,undefined,i2.promise);}return k2;}}.bind(this)).then(function(c2){A1.call(this,c2,j,h2,a2,_1,d2,i2||i);return c2;}.bind(this)).catch(function(k2){a2=false;b2=_1;W.call(this,k2.message);if(i2&&i2.reject){if(Y1.call(this,i2)){i2.reject(k2);}}else if(e2){_.call(this,j,a2,b2);}}.bind(this)).unwrap();if(c2 instanceof Promise){e2=true;}}else if(!i.changeEvent.parameters.hasOwnProperty("valid")&&this._bParseError){b2=i.changeEvent.parameters["value"];a2=false;}var j2=F1.call(this);if(j2&&this._bConnected){if(sap.ui.getCore().getCurrentFocusedControlId()===d2.getId()){j2.close();}j2.setFilterValue("");if(!e2&&a2){G1.call(this,j,j2);j2.onFieldChange();}if(this.iLiveChangeTimer){clearTimeout(this.iLiveChangeTimer);}}if(this._oNavigateCondition){this._oNavigateCondition=undefined;R1.call(this);}if(i.resolve){X1.call(this,i);}else if(!e2){_.call(this,j,a2,b2);}}function A1(i,j,_1,a2,b2,c2,d2){if(_1){_1.validateValue(i);}var e2=this.getMaxConditions();if(a2){if(i){if(this._bIsMeasure&&j.length===1&&j[0].values[0][0]===undefined){j=[];}if(e2!==1&&C.indexOfCondition(i,j)>=0){throw new Error(this._oResourceBundle.getText("field.CONDITION_ALREADY_EXIST",[b2]));}else{if(e2>0&&e2<=j.length){j.splice(0,j.length-e2+1);}j.push(i);}}else if(e2===1){j=[];}if(!g(j,this.getConditions())){this.setProperty("conditions",j,true);}if(e2!==1){c2.setValue("");}}if(d2.resolve){var f2=F1.call(this);if(f2&&this._bConnected){G1.call(this,j,f2);f2.onFieldChange();}d2.result=j;X1.call(this,d2);Y1.call(this,d2);}}function B1(i){var j;var _1;var a2=false;var b2=i.getSource();this._oNavigateCondition=undefined;R1.call(this);if("value"in i.getParameters()){j=i.getParameter("value");}if("escPressed"in i.getParameters()){a2=i.getParameter("escPressed");}if("previousValue"in i.getParameters()){_1=i.getParameter("previousValue");}else{var c2=this.getConditions();_1=c2[0]&&c2[0].values[0];}var d2=F1.call(this);if(d2&&d2.openByTyping()&&(!this._bIsMeasure||b2.getShowValueHelp())){var e2;if(j[0]==="="&&j[1]==="="){e2=j.slice(2);}else if(j[0]==="="){e2=j.slice(1);}else{e2=j;}var f2=this.getDisplay();if(f2!==r.Value){var g2=a.getEEQOperator();var h2=g2.splitText(e2,f2);e2="";if(h2[0]){e2=h2[0];if(h2[1]){e2=e2+" ";}}if(h2[1]){e2=e2+h2[1];}}if(this.iLiveChangeTimer){clearTimeout(this.iLiveChangeTimer);delete this.iLiveChangeTimer;}this.iLiveChangeTimer=setTimeout(function(){if(this._bConnected&&this._getContent()[0]&&(sap.ui.getCore().getCurrentFocusedControlId()===this._getContent()[0].getId()||(this._getContent()[1]&&sap.ui.getCore().getCurrentFocusedControlId()===this._getContent()[1].getId()))){d2.setFilterValue(e2);if(d2.getConditions().length>0){d2.setConditions([]);}d2.open(true);}}.bind(this),300);}this.fireLiveChange({value:j,escPressed:a2,previousValue:_1});}function C1(i){var j=this.getFieldInfo();if(j){j.getTriggerHref().then(function(_1){if(!_1){j.open(this._getContent()[0]);}}.bind(this));}this.firePress();}function D1(j){if(j.getParameter("type")==="removed"){var _1=j.getParameter("removedTokens");var a2=this.getConditions();var b2;var i;for(i=0;i<_1.length;i++){var c2=_1[i];var d2=c2.getBindingContext("$field").sPath;var e2=parseInt(d2.slice(d2.lastIndexOf("/")+1));a2[e2].delete=true;}for(i=a2.length-1;i>=0;i--){if(a2[i].delete){if(this._bIsMeasure){b2=a2[i].values[0][1];}a2.splice(i,1);}}if(this._bIsMeasure&&b2&&a2.length===0){a2=[C.createItemCondition([undefined,b2],undefined)];}this.setProperty("conditions",a2,true);_.call(this,a2,true);j.preventDefault(true);}}function E1(i,j){var _1=sap.ui.getCore().byId(i);if(j==="remove"){_1.detachEvent("select",I1,this);_1.detachEvent("navigate",J1,this);_1.detachEvent("dataUpdate",K1,this);_1.detachEvent("disconnect",L1,this);this.setProperty("_fieldHelpEnabled",false,true);}else if(j==="insert"){if(_1){_1.attachEvent("dataUpdate",K1,this);this.setProperty("_fieldHelpEnabled",true,true);}}P.call(this,this.getConditions());}function F1(){var i=this.getFieldHelp();var j;if(!i&&this._sDefaultFieldHelp){i=this._sDefaultFieldHelp;}if(i){j=sap.ui.getCore().byId(i);}return j;}function G1(j,_1){if(!_1){_1=F1.call(this);}if(this._bIsMeasure){var a2=[];for(var i=0;i<j.length;i++){var b2=j[i];if(b2.values[0]&&b2.values[0][1]){var c2=C.createItemCondition(b2.values[0][1],undefined,b2.inParameters,b2.outParameters);a2.push(c2);}}_1.setConditions(a2);}else{_1.setConditions(j);}}function H1(i){var j=F1.call(this);if(j){j.setFilterValue("");var _1=this.getConditions();G1.call(this,_1,j);j.toggleOpen(false);}}function I1(j){var _1=this.getConditions();var a2=j.getParameter("conditions");var b2=j.getParameter("add");var c2=j.oSource;var d2=this.getMaxConditions();var e2;var f2=this.getControlForSuggestion();var g2;var i=0;if(this._bIsMeasure){if(a2.length>1){throw new Error("Only one item must be selected! "+this);}if(a2[0].operator!=="EEQ"){throw new Error("Only EEQ allowed! "+this);}if(_1.length>0){for(i=0;i<_1.length;i++){_1[i].values[0][1]=a2[0].values[0];if(_1[i].operator==="BT"){_1[i].values[1][1]=a2[0].values[0];}if(a2[0].inParameters){_1[i].inParameters=a2[0].inParameters;}if(a2[0].outParameters){_1[i].outParameters=a2[0].outParameters;}}}else{e2=m({},a2[0]);e2.values[0]=[undefined,e2.values[0]];e2.values[1]=undefined;_1.push(e2);if(this._oConditionType){g2=this._oConditionType.formatValue(e2);}else if(this._oConditionsType){g2=this._oConditionsType.formatValue(_1);}}}else{if(!b2){_1=[];}for(i=0;i<a2.length;i++){e2=a2[i];if(!$1.call(this,e2.operator)){continue;}if(!b2||C.indexOfCondition(e2,_1)===-1){_1.push(e2);}}}if(d2>0&&d2<_1.length){_1.splice(0,_1.length-d2);}if(f2&&f2.setDOMValue){if(this.getMaxConditionsForHelp()===1&&_1.length>0){if(this._bIsMeasure&&this._oUnitConditionsType){g2=this._oUnitConditionsType.formatValue(_1);}else if(this._oConditionType){g2=this._oConditionType.formatValue(_1[0]);}else if(this._oConditionsType){g2=this._oConditionsType.formatValue(_1);}f2.setDOMValue(g2);}else{f2.setDOMValue("");}}if(!g(_1,this.getConditions())){this._oNavigateCondition=undefined;R1.call(this);this.setProperty("conditions",_1,true);c2.onFieldChange();_.call(this,_1,true);}}function J1(i){var j=i.getParameter("value");var _1=i.getParameter("key");var a2=i.getParameter("condition");var b2;var c2;var d2=this.getControlForSuggestion();if(a2){this._oNavigateCondition=m({},a2);_1=a2.values[0];j=a2.values[1];}else{this._oNavigateCondition=C.createItemCondition(_1,j);}if(this._bIsMeasure){var e2=this.getConditions();if(e2.length>0){this._oNavigateCondition.operator=e2[0].operator;this._oNavigateCondition.values[0]=[e2[0].values[0][0],this._oNavigateCondition.values[0]];if(e2[0].operator==="BT"){this._oNavigateCondition.values[1]=[e2[0].values[1][0],this._oNavigateCondition.values[0][1]];}else{this._oNavigateCondition.values[1]=undefined;}}else{this._oNavigateCondition.values=[[undefined,this._oNavigateCondition.values[0]],undefined];}}R1.call(this);if(this.getDisplay()!==r.Value){b2=_1;}else if(j){b2=j;}else{b2=_1;}if(d2&&d2.setDOMValue){if(!c2){if(this._bIsMeasure&&this._oUnitConditionsType&&this._oNavigateCondition){c2=this._oUnitConditionsType.formatValue([this._oNavigateCondition]);}else if(this._oConditionType&&this._oNavigateCondition){c2=this._oConditionType.formatValue(this._oNavigateCondition);}else if(this._oConditionsType&&this._oNavigateCondition){c2=this._oConditionsType.formatValue([this._oNavigateCondition]);}else{c2=j||_1;}}d2.setDOMValue(c2);d2._doSelect();}this.fireLiveChange({value:b2});}function K1(i){var j=this.getEditMode()===E.Editable&&this._getContent().length>0&&sap.ui.getCore().getCurrentFocusedControlId()===this._getContent()[0].getId();if(!j&&this.getConditions().length>0&&(this.getMaxConditions()!==1||(this.getDisplay()!==r.Value&&!this._bParseError))){this._oManagedObjectModel.checkUpdate(true);}}function L1(i){var j=F1.call(this);j.detachEvent("select",I1,this);j.detachEvent("navigate",J1,this);j.detachEvent("disconnect",L1,this);this._bConnected=false;}function M1(){var i=F1.call(this);if(i&&!this._bConnected){i.connect(this);this._bConnected=true;i.attachEvent("select",I1,this);i.attachEvent("navigate",J1,this);i.attachEvent("disconnect",L1,this);var j=this.getConditions();G1.call(this,j,i);var _1=this.getControlForSuggestion();N1.call(this,_1);}}function N1(i){if(i&&!i.orgOnsapfocusleave&&i.onsapfocusleave){i.orgOnsapfocusleave=i.onsapfocusleave;i.onsapfocusleave=function(j){var _1=F1.call(this.getParent());if(_1){var a2=sap.ui.getCore().byId(j.relatedControlId);if(a2){if(k(_1.getDomRef(),a2.getFocusDomRef())){j.stopPropagation();return;}else{_1.skipOpening();}}}this.orgOnsapfocusleave(j);};}}function O1(i){var j=F1.call(this);if(j&&i&&i.addEndIcon){var _1=j.getIcon();var a2=i.getAggregation("_endIcon",[])[0];if(a2){a2.setSrc(_1);}else{i.addEndIcon({id:i.getId()+"-vhi",src:_1,useIconTooltip:false,noTabStop:true,press:function(b2){if(!this.getValueHelpOnly()){var c2;if(D.support.touch){c2=this.$('inner');c2.attr('readonly','readonly');this.focus();c2.removeAttr('readonly');}else{this.focus();}this.bValueHelpRequested=true;this.fireValueHelpRequest({fromSuggestions:false});}}.bind(i)});}}}function P1(i,j){if(j==="remove"){i.detachEvent("dataUpdate",Q1,this);}else if(j==="insert"){i.attachEvent("dataUpdate",Q1,this);Q1.call(this);}}function Q1(){var i=this.getFieldInfo();var j=this;i.isTriggerable().then(function(_1){j._bTriggerable=_1;if(j.getAggregation("_content",[]).length>0&&j.getEditMode()===E.Display){d1.call(j);i.getDirectLinkHrefAndTarget().then(function(a2){j.getAggregation("_content")[0].setHref(a2.href);j.getAggregation("_content")[0].setTarget(a2.target);});}});}t.prototype._getFormatOptions=function(){if(!this._asyncParsingCall){this._asyncParsingCall=W1.bind(this);}return{valueType:z.call(this),originalDateType:this._oDateOriginalType||this._oUnitOriginalType,display:this._bIsMeasure?r.Value:this.getDisplay(),fieldHelpID:this._bIsMeasure?undefined:this.getFieldHelp()||this._sDefaultFieldHelp,operators:this._getOperators(),hideOperator:this._bHideOperator,maxConditions:this.getMaxConditions(),bindingContext:this.getBindingContext(),asyncParsing:this._asyncParsingCall,navigateCondition:this._oNavigateCondition,delegate:this._oDelegate,payload:this._oPayload};};function R1(){if(this._oConditionType||this._oConditionsType){var i=this._getFormatOptions();if(this._oConditionType){this._oConditionType.setFormatOptions(i);}if(this._oConditionsType){this._oConditionsType.setFormatOptions(i);}if(this._oUnitConditionsType){i=V1.call(this);this._oUnitConditionsType.setFormatOptions(i);}}}function S1(){if(!this._oConditionType){this._oConditionType=new b();this._oConditionType._bCreatedByField=true;R1.call(this);}return this._oConditionType;}function T1(){if(!this._oConditionsType){this._oConditionsType=new c();this._oConditionsType._bCreatedByField=true;R1.call(this);}return this._oConditionsType;}t.prototype._checkValueInitial=function(i){if(i===null||i===undefined){return true;}if(i===""){var j=z.call(this);var _1=j.parseValue(i,"string");if(_1===i){return true;}else{try{j.validateValue(_1);}catch(a2){return true;}}}else{var b2=A.call(this);if(this._oDelegate.getBaseType(this._oPayload,b2)===B.Unit&&Array.isArray(i)&&i.length>1&&(i[0]===undefined||i[0]===null)&&!i[1]){return true;}}return false;};function U1(){if(!this._oUnitConditionsType){var i=V1.call(this);this._oUnitConditionsType=new c(i);this._oUnitConditionsType._bCreatedByField=true;}return this._oUnitConditionsType;}function V1(){if(!this._asyncParsingCall){this._asyncParsingCall=W1.bind(this);}return{valueType:undefined,originalDateType:z.call(this),display:this.getDisplay(),fieldHelpID:this.getFieldHelp()||this._sDefaultFieldHelp,operators:["EEQ"],hideOperator:true,maxConditions:1,bindingContext:this.getBindingContext(),asyncParsing:this._asyncParsingCall,navigateCondition:this._oNavigateCondition,delegate:this._oDelegate,payload:this._oPayload,isUnit:true,getConditions:this.getConditions.bind(this)};}function W1(i){var j=F1.call(this);if(j&&j.isOpen()){var _1=document.activeElement;if(_1&&(k(this.getDomRef(),_1)||k(j.getDomRef(),_1))){j.close();}}var a2={};var b2=new Promise(function(c2,d2){a2.resolve=c2;a2.reject=d2;i.then(function(e2){a2.result=e2;var f2=this.getConditions();if(g(e2,f2)){X1.call(this,a2);Y1.call(this,a2);}else{a2.waitForUpdate=true;}}.bind(this)).catch(function(e2){this._bParseError=true;d2(e2);Y1.call(this,a2);}.bind(this));}.bind(this));a2.promise=b2;this._aAsyncChanges.push(a2);}t.prototype._getResultForPromise=function(i){return i;};function X1(i){i.resolve(this._getResultForPromise(i.result));}function Y1(j){var _1=false;var i=0;for(i=0;i<this._aAsyncChanges.length;i++){if(j===this._aAsyncChanges[i]){_1=true;break;}}if(_1){this._aAsyncChanges.splice(i,1);}return _1;}function Z1(i){if(this._oDelegate||this._oDelegateLoading){throw new Error("Delegate can only be set once");}this._oDelegate=sap.ui.require(i.name);this._oPayload=i.payload||{};if(this._oDelegate){this._oDelegateResolve();delete this._oDelegateResolve;delete this._oDelegateReject;}else{this._oDelegateLoading=true;sap.ui.require([i.name],function(j){this._oDelegate=j;this._oDelegateResolve();delete this._oDelegateResolve;delete this._oDelegateReject;delete this._oDelegateLoading;}.bind(this),function(){this._oDelegateReject("Failed to load delegate");delete this._oDelegateResolve;delete this._oDelegateReject;delete this._oDelegateLoading;}.bind(this));}}t.prototype._getOperators=function(){var i=A.call(this);var j=G.call(this);var _1=H.call(this);var a2=this._oDelegate.getBaseType(this._oPayload,i,_1,j);if(a2===B.Unit){a2=B.Numeric;}return a.getOperatorsForType(a2);};function $1(j){var _1=this._getOperators();for(var i=0;i<_1.length;i++){if(j===_1[i]){return true;}if(j==="EQ"&&_1[i]==="EEQ"){return true;}if(j==="EEQ"&&_1[i]==="EQ"){return true;}}return false;}return t;});
