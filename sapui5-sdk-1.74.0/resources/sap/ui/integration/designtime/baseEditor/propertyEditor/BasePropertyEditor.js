/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","./../util/ObjectBinding","sap/ui/model/json/JSONModel","sap/m/Label","sap/ui/core/Fragment","sap/base/util/restricted/_merge"],function(C,O,J,L,F,_){"use strict";var B=C.extend("sap.ui.integration.designtime.baseEditor.propertyEditor.BasePropertyEditor",{metadata:{properties:{"renderLabel":{type:"boolean",defaultValue:true},"config":{type:"any"}},aggregations:{"_label":{type:"sap.m.Label",visibility:"hidden",multiple:false},"content":{type:"sap.ui.core.Control",multiple:false}},associations:{"editor":{type:"sap.ui.integration.designtime.BaseEditor",multiple:false}},events:{propertyChange:{parameters:{path:{type:"string"},value:{type:"any"}}},ready:{}}},xmlFragment:null,constructor:function(){C.prototype.constructor.apply(this,arguments);this._oConfigModel=new J(this.getConfig());this._oConfigModel.setDefaultBindingMode("OneWay");this.setModel(this._oConfigModel);this.setBindingContext(this._oConfigModel.getContext("/"));this._loadFragment().then(this.asyncInit.bind(this)).then(this.fireReady.bind(this));},_loadFragment:function(){if(!this.xmlFragment){return Promise.resolve();}return F.load({name:this.xmlFragment,controller:this}).then(function(e){this.setContent(e);}.bind(this));},asyncInit:function(){return Promise.resolve();},clone:function(){this.destroyContent();return C.prototype.clone.apply(this,arguments);},exit:function(){this._oConfigModel.destroy();if(this._oConfigBinding){this._oConfigBinding.destroy();}},setConfig:function(c){var r=this.setProperty("config",_({},c));this._initialize();return r;},setModel:function(m,n){var r=C.prototype.setModel.apply(this,arguments);this._initialize();return r;},onValueChange:function(v){var c=this.getConfig();if(typeof c.value==="undefined"&&c.defaultValue){c.value=c.defaultValue;this._oConfigModel.checkUpdate();}},getValue:function(){return this.getConfig().value;},_initialize:function(){var c=this.getConfig();var j=this.getModel("_context");if(j&&c){if(c.path&&!c.value){c.value="{context>"+c.path+"}";}if(!this._oConfigBinding){this._oConfigBinding=new O();this._oConfigBinding.setModel(this.getModel("i18n"),"i18n");this._oConfigBinding.setModel(j,"context");this._oConfigBinding.setBindingContext(j.getContext("/"),"context");this.bindProperty("visible","visible");this._oConfigBinding.attachChange(function(e){this._oConfigModel.checkUpdate();if(e.getParameter("path")==="value"){this.onValueChange(e.getParameter("value"));}}.bind(this));}this._oConfigBinding.setObject(c);this._oConfigModel.setData(c);this.onValueChange(c.value);}},getEditor:function(){return sap.ui.getCore().byId(this.getAssociation("editor"));},getI18nProperty:function(n){return this.getModel("i18n").getProperty(n);},getLabel:function(){var l=this.getAggregation("_label");if(!l){l=new L({text:"{label}",design:"Bold"});this.setAggregation("_label",l);}return l;},renderer:function(r,p){r.openStart("div",p);r.openEnd();if(p.getRenderLabel()&&p.getLabel()){r.openStart("div");r.openEnd();r.renderControl(p.getLabel());r.close("div");}r.renderControl(p.getContent());r.close("div");},firePropertyChange:function(v){this.fireEvent("propertyChange",{path:this.getConfig().path,value:v});}});return B;});
