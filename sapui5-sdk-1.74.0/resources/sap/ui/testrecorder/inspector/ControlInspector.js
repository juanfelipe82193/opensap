/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/Object","sap/ui/testrecorder/CommunicationBus","sap/ui/testrecorder/CommunicationChannels","sap/ui/testrecorder/inspector/DOMMutation","sap/ui/support/supportRules/ui/external/Highlighter","sap/ui/test/_ControlFinder","sap/ui/testrecorder/inspector/ControlAPI","sap/ui/testrecorder/Constants","sap/ui/testrecorder/DialectRegistry","sap/ui/testrecorder/controlSelectors/UIVeri5SelectorGenerator","sap/ui/testrecorder/codeSnippets/CodeSnippetProvider"],function(B,C,a,D,H,_,b,c,d,U,e){"use strict";var o=null;var h=new H(c.HIGHLIGHTER_ID);var p;var f=B.extend("sap.ui.testrecorder.inspector.ControlInspector",{constructor:function(){if(!o){Object.apply(this,arguments);this._mutation=new D(this.getAllControlData);}else{return o;}}});f.prototype.init=function(){this._mutation.start();C.subscribe(a.REQUEST_ALL_CONTROLS_DATA,this.getAllControlData.bind(this));C.subscribe(a.REQUEST_CONTROL_DATA,this.getControlData.bind(this));C.subscribe(a.REQUEST_CODE_SNIPPET,this.getCodeSnippet.bind(this));C.subscribe(a.HIGHLIGHT_CONTROL,this.highlightControl.bind(this));C.subscribe(a.SET_DIALECT,this.setDialect.bind(this));};f.prototype.getAllControlData=function(){C.publish(a.RECEIVE_ALL_CONTROLS_DATA,{renderedControls:b.getAllControlData().renderedControls,framework:b.getFrameworkData().framework});U.emptyCache();};f.prototype.getControlData=function(m){var g=b.getControlData(m);C.publish(a.RECEIVE_CONTROL_DATA,g);};f.prototype.getCodeSnippet=function(m){p=m;return U.getSelector(m).then(function(s){return e.getSnippet({controlSelector:s,action:m.action});}).then(function(s){C.publish(a.RECEIVE_CODE_SNIPPET,{codeSnippet:s});}).catch(function(E){C.publish(a.RECEIVE_CODE_SNIPPET,{error:"Could not generate code snippet for "+JSON.stringify(m)+". Details: "+E,domElement:m.domElement});});};f.prototype.highlightControl=function(m){if(m.domElement){h.highlight(m.domElement);}else if(m.controlId){var g=_._findElements({id:m.controlId})[0];if(g){h.highlight(g.id);}}};f.prototype.setDialect=function(s){d.setActiveDialect(s);C.publish(a.DIALECT_CHANGED);if(p){this.getCodeSnippet(p);}};f.prototype.stop=function(){this._mutation.stop();};o=new f();return o;},true);
