sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources","sap/base/strings/formatMessage","sap/base/Log","sap/base/util/isPlainObject","sap/base/util/each"],function(q,N,D,C,O,F,a,o,S,b,f,L,c,e){"use strict";var d={count:0};var g={};var h={};var l={};var m={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};function n(i,j){var k=i.getSetting('ovpCardProperties');var c3=k.getProperty('/showLabelText');if(c3==="true"){var d3=j.Address[0];if(typeof d3.country!=="undefined"){return"{path:'"+d3.country.Path+"'}";}else if(typeof d3.locality!=="undefined"){return"{path:'"+d3.locality.Path+"'}";}else if(typeof d3.street!=="undefined"){return"{path:'"+d3.street.Path+"'}";}else if(typeof d3.code!=="undefined"){return"{path:'"+d3.code.Path+"'}";}}else{return null;}}n.requiresIContext=true;function p(i,j){if(!j){return"";}if(j.Label){return j.Label.String;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var c3=k&&k.getProperty("/metaModel");var d3=k&&k.getProperty("/entityType");if(!c3||!d3){return"";}var e3;if(j.Value){e3=j.Value.Path;}if(j.Target){var f3=J(d3.$path,j);var g3=f3&&c3.getProperty(f3);e3=g3&&g3.Value.Path;}if(!e3||!e3.length>0||e3===" "){return"";}var h3=c3.getODataProperty(d3,e3);if(!h3){return"";}var i3=h3["sap:label"]||(h3["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return i3;}p.requiresIContext=true;function r(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function s(i,k,j){if(i.getSetting){var c3=i.getSetting("_ovpCache");if(c3){c3[k]=j;}}}function t(i,j){if(!d[j]){d[j]=0;}d[j]++;var k=j+d[j];d[k]=i;return"sap.ovp.cards.AnnotationHelper.formatFunctions."+k;}function u(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var c3=i.EnumMember;if(w(c3,'Negative')){k=j.Negative;}else if(w(c3,'Critical')){k=j.Critical;}else if(w(c3,'Positive')){k=j.Positive;}}}return k;}function v(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function w(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function x(i,j,k,c3,d3,e3,f3){var g3={};g3.EnumMember="None";var h3=Number.NEGATIVE_INFINITY;var i3=Number.POSITIVE_INFINITY;if((!d3&&d3!==0)&&(k||k===0)){d3=k;}if((!e3&&e3!==0)&&(c3||c3===0)){e3=c3;}if(!k&&k!==0){k=h3;}if(!c3&&c3!==0){c3=i3;}if(i!==undefined){i=Number(i);if(w(j,"Minimize")||w(j,"Minimizing")){if((e3||e3===0)&&(c3||c3===0)){if(i<=parseFloat(e3)){g3.EnumMember="Positive";}else if(i>parseFloat(c3)){g3.EnumMember="Negative";}else{g3.EnumMember="Critical";}}}else if(w(j,"Maximize")||w(j,"Maximizing")){if((d3||d3===0)&&(k||k===0)){if(i>=parseFloat(d3)){g3.EnumMember="Positive";}else if(i<parseFloat(k)){g3.EnumMember="Negative";}else{g3.EnumMember="Critical";}}}else if(w(j,"Target")){if((e3||e3===0)&&(c3||c3===0)&&(d3||d3===0)&&(k||k===0)){if(i>=parseFloat(d3)&&i<=parseFloat(e3)){g3.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(c3)){g3.EnumMember="Negative";}else{g3.EnumMember="Critical";}}}}return u(g3,f3);}function y(i,j,k,c3){if(!i||!j){return;}i=Number(i);if(!c3&&(i-j>=0)){return"Up";}if(!k&&(i-j<=0)){return"Down";}if(j&&c3&&(i-j>=c3)){return"Up";}if(j&&k&&(i-j<=k)){return"Down";}}function z(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var c3=r(i,k);if(!c3){var d3=B(i,j);var e3=d3.map(function(f3){return f3.Value.Path;});e3=e3.filter(function(f3){return!!f3;});c3=j.filter(function(f3){if(f3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&e3.indexOf(f3.Value.Path)===-1){return true;}return false;});c3=M(c3);s(i,k,c3);}return c3;}z.requiresIContext=true;function B(j,k,c3){var d3=j.getPath(0)+"-DataPoints-Sorted";var e3=r(j,d3);if(!e3){if(c3){e3=k.filter(G);}else{e3=k.filter(E);}e3=M(e3);var f3;for(var i=0;i<e3.length;i++){f3=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);e3[i]=j.getModel(0).getProperty(J(f3,e3[i]));f3="";}s(j,d3,e3);}return e3;}B.requiresIContext=true;function E(i){if(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function G(i){if((i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function H(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function J(i,j){if(i&&!w(i,'/')){i+='/';}return i+j.Target.AnnotationPath.slice(1);}function K(i){var j,k;if(i["com.sap.vocabularies.UI.v1.Importance"]){j=i["com.sap.vocabularies.UI.v1.Importance"].EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function M(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var c3=i.slice(j,i.length);return P(M(k),M(c3));}function P(i,j){var k=[];while(i.length&&j.length){var c3=K(i[0]),d3=K(j[0]);if(c3<=d3){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function Q(i,j,k){var c3=z(i,j)[k];if(c3){return Z(i,c3);}return"";}function R(i,j,k){var c3=z(i,j)[k];return p(i,c3);}function U(i,j,k){var c3=B(i,j)[k];if(c3&&c3.Title){return c3.Title.String;}return"";}function V(i,j,k){var c3=j.filter(E);c3=M(c3);if(!c3||!c3.length||!c3.length>0){return"";}return p(i,c3[0]);}function W(i,j,k,c3){var d3=B(i,j)[k];if(!d3){return"";}var e3=i.getSetting('ovpCardProperties');var f3=e3.getProperty("/entityType");var g3=e3.getProperty("/metaModel");return _(i,d3,f3,g3,c3);}function X(i,j,k){var c3=B(i,j)[k];if(c3&&c3.Criticality){return true;}}function Y(i,j,k){var c3=B(i,j)[k];var d3=c3.Criticality.Path;return"{path:'"+d3+"'}";}function _(i,j,k,c3,d3){if(!j||!j.Value){return"";}var e3=i.getSetting('ovpCardProperties');var f3=false;if(e3){var g3=e3.getProperty("/ignoreSapText");f3=g3==undefined?f3:g3;}var h3=c3.getODataProperty(k,j.Value.Path);var i3=false;if(f3==true){if(h3&&(h3["com.sap.vocabularies.Analytics.v1.Measure"]||h3["sap:aggregation-role"]=="measure")){i3=true;}}if(!i3&&h3){var j3;if(h3["com.sap.vocabularies.Common.v1.Text"]){j3=h3["com.sap.vocabularies.Common.v1.Text"].String?h3["com.sap.vocabularies.Common.v1.Text"].String:h3["com.sap.vocabularies.Common.v1.Text"].Path;}else if(h3["sap:text"]){j3=h3["sap:text"];}if(j3){h3=c3.getODataProperty(k,j3);j={Value:{Path:h3.name}};}}return Z(i,j,d3);}function Z(i,j,k,c3){if(j.Value.Apply){return O.format(i,j.Value);}var d3=i.getSetting('ovpCardProperties');var e3=d3.getProperty("/entityType");var f3=d3.getProperty("/metaModel");return a1(i,j,e3,f3,k,c3);}Z.requiresIContext=true;function $(i,j,k,c3){if((!k)||(typeof c3!=='string')){return c3;}var d3=k[A.TEXT];if(!d3){return c3;}var e3,f3;e3=k[A.TEXT_ARRANGEMENT];f3=e3&&e3.EnumMember;if(!f3){e3=d3&&d3[A.TEXT_ARRANGEMENT];f3=e3&&e3.EnumMember;}if(!f3){e3=j&&j[A.TEXT_ARRANGEMENT];f3=e3&&e3.EnumMember;}if(!f3){return c3;}var g3=O.format(i,d3);if(!g3||g3===" "){return c3;}var h3;switch(f3){case T.TEXT_FIRST:h3=g3+" ("+c3+")";break;case T.TEXT_LAST:h3=c3+" ("+g3+")";break;case T.TEXT_ONLY:h3=g3;break;case T.TEXT_SEPARATE:h3=c3+" ("+g3+")";break;default:h3=c3;break;}return h3;}function a1(j,k,c3,d3,e3,f3,g3){if(k.Value.Apply){return O.format(j,k.Value);}var h3=k.Value.Path?k.Value.Path:k.Value.String;var i3=d3.getODataProperty(c3,h3),j3="",k3;var l3=j.getSetting("ovpCardProperties");var m3=l3&&l3.getProperty("/contentFragment");if(!f3){if(k.Value.Path&&k.Value.Path.split("/").length>1){i3=h1(d3,c3,k.Value.Path);}if(!i3){return"";}if(i3["type"]==='Edm.DateTime'||i3["type"]==='Edm.DateTimeOffset'){var n3=l3&&l3.getProperty("/showDateInRelativeFormat");k3=e1("dateFormatFunction",n3,i3["type"]==='Edm.DateTime'?true:false);j3=b1([k.Value.Path?k.Value.Path:i3.name],k3);}else if((k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)||i3["scale"]){var o3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits.Int:0,p3;var q3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.Decimal);if(i3["Org.OData.Measures.V1.ISOCurrency"]){p3=i3["Org.OData.Measures.V1.ISOCurrency"].Path?i3["Org.OData.Measures.V1.ISOCurrency"].Path:i3["Org.OData.Measures.V1.ISOCurrency"].String;}else if(i3["Org.OData.Measures.V1.Unit"]){p3=i3["Org.OData.Measures.V1.Unit"].Path?i3["Org.OData.Measures.V1.Unit"].Path:i3["Org.OData.Measures.V1.Unit"].String;}else if(i3["sap:unit"]){p3=i3["sap:unit"];}var r3=p3?d3.getODataProperty(c3,p3):null,s3=[k.Value.Path?k.Value.Path:i3.name];if(o3>2){o3=2;}if(i3["Org.OData.Measures.V1.ISOCurrency"]){var t3=i3["Org.OData.Measures.V1.ISOCurrency"];if(t3.Path){k3=f1(o3,q3);s3.push(t3.Path);}else if(t3.String){k3=f1(o3,t3.String,q3);}}else if(r3&&(r3["Org.OData.Measures.V1.ISOCurrency"]||r3["sap:semantics"]==="currency-code")){k3=f1(o3,q3);s3.push(p3);}else{k3=c1(o3,q3);}j3=b1(s3,k3);}else{if(g3){j3=O.simplePath(j,k.Value);}else{var u3=O.format(j.getModel()?j:j.getInterface(0),k.Value);var v3=u3.split(",");var w3=[];if(v3.length>1){for(var i=0;i<v3.length;i++){if(v3[i].indexOf("path:")>=0||v3[i].indexOf("type:")>=0){w3.push(v3[i]);}}if(w3.length>0){j3=j3+w3.join(',');if(j3.substring(j3.length-1)!=="}"){j3=j3+"}";}}}else{j3=u3;}}}if(m3){j3=$(j,c3,i3,j3);}if(i3["Org.OData.Measures.V1.Unit"]){var x3=i3["Org.OData.Measures.V1.Unit"];if(x3.Path){j3+=(" "+b1([x3.Path]));}else if(x3.String){if(x3.String!=="%"){j3+=" ";}j3+=x3.String;}}}if(!e3){if(i3["Org.OData.Measures.V1.ISOCurrency"]){var t3=i3["Org.OData.Measures.V1.ISOCurrency"];if(t3.Path){j3+=(" "+b1([t3.Path]));}else if(t3.String){j3+=(" "+t3.String);}}}if(j3[0]===" "){j3=j3.substring(1);}return j3;}function b1(j,k){var c3="",d3=j.length;if(d3>1){c3="{parts:[";for(var i=0;i<d3;i++){c3+=("{path: '"+j[i]+"'}"+((i===d3-1)?"]":", "));}}else{c3="{path: '"+j[0]+"'";}c3+=(k?(", formatter: '"+k+"'"):"")+"}";return c3;}function c1(i,j){var k="formatNumberCalculation"+i;if(!g[k]){g[k]=d1(Number(i),j);}return"sap.ovp.cards.AnnotationHelper.NumberFormatFunctions."+k;}function d1(i,j){return function(k){var c3=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});return c3.format(Number(k));};}function e1(i,j,k){var c3={'relative':true,'relativeScale':'auto'};if(j!==undefined&&!j){c3={'style':'medium'};}if(!h[i]){h[i]=function(d3){var e3=D.getInstance(c3);if(!d3){d3="";return d3;}return e3.format(new Date(d3),k);};}return"sap.ovp.cards.AnnotationHelper.DateFormatFunctions."+i;}function f1(i,j,k){var c3="formatCurrencyCalculation"+(j?j+i:i);if(!l[c3]){l[c3]=g1(i,j,k);}return"sap.ovp.cards.AnnotationHelper.CurrencyFormatFunctions."+c3;}function g1(i,j,k){return function(c3,d3){var e3="";var f3=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:k,minFractionDigits:i,maxFractionDigits:i});if(d3){e3=f3.format(c3,d3);}else{e3=j?f3.format(c3,j):f3.format(c3);}return e3;};}function h1(j,k,c3){var d3=c3.split("/");if(d3.length>1){for(var i=0;i<(d3.length-1);i++){var e3=j.getODataAssociationEnd(k,d3[i]);if(e3){k=j.getODataEntityType(e3.type);}}return j.getODataProperty(k,d3[d3.length-1]);}}function i1(i,j,k){var c3=B(i,j);var d3=m.StateValues;var e3=c3[k];if(!e3){return d3.None;}if(e3.Criticality){return m1(i,e3,d3);}return o1(i,e3,d3);}function j1(i,j,k){var c3=B(i,j);if(c3&&c3.length){var d3=c3[0];if(d3&&(d3.Criticality||d3.CriticalityCalculation)){return true;}}return false;}function k1(i,j,k){if(j1(i,j,k)){return'';}return'#5cbae6';}k1.requiresIContext=true;function l1(i,j,k){var c3=B(i,j),d3=m.ColorValues;var e3=d3.None;if(c3.length>k){var f3=c3[k];if(f3&&f3.Criticality){e3=m1(i,f3,d3);}else{e3=o1(i,f3,d3);}}return e3;}function m1(i,j,k){var c3=k.None;var d3;var e3=j.Criticality;if(e3){d3="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(e3.Path){var f3='$'+O.simplePath(i,e3);c3=f(d3,f3);}else if(e3.EnumMember){var g3="'"+e3.EnumMember+"'";c3=f(d3,g3);}else{L.warning("Case not supported, returning the default Neutral state");}}else{L.warning("Case not supported, returning the default Neutral state");}return c3;}function n1(i,j,k){var c3=B(i,j);var d3="None";if(c3.length>k){var e3=c3[k];if(e3&&e3.Criticality&&e3.Criticality.Path){d3=Y(i,j,k);}else{d3=o1(i,e3,m.StateValues);d3=v(d3);}}return d3;}function o1(i,j,k){var c3=k.None;if(j.Criticality){c3=u(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.Path){c3=p1(i,j,k);}return c3;}function p1(i,j,k){var c3=G1(j.Value);var d3=j.CriticalityCalculation.ImprovementDirection.EnumMember;var e3=G1(j.CriticalityCalculation.DeviationRangeLowValue);var f3=G1(j.CriticalityCalculation.DeviationRangeHighValue);var g3=G1(j.CriticalityCalculation.ToleranceRangeLowValue);var h3=G1(j.CriticalityCalculation.ToleranceRangeHighValue);var i3=q1(e3);var j3=q1(f3);var k3=q1(g3);var l3=q1(h3);var m3="parts: ["+c3;m3+=i3?","+e3:"";m3+=j3?","+f3:"";m3+=k3?","+g3:"";m3+=l3?","+h3:"";m3+="]";var n3=function(){var p3=1;return x(arguments[0],d3,i3?arguments[p3++]:e3,j3?arguments[p3++]:f3,k3?arguments[p3++]:g3,l3?arguments[p3++]:h3,k);};var o3=t(n3,"formatCriticalityCalculation");return"{"+m3+", formatter: '"+o3+"'}";}function q1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function r1(j,k,c3){var d3="";var e3=c3.split("/");if(e3.length>1){for(var i=0;i<(e3.length-1);i++){var f3=j.getODataAssociationEnd(k,e3[i]);if(f3){k=j.getODataEntityType(f3.type);if(d3){d3=d3+"/";}d3=d3+e3[i];}else{return d3;}}}return d3;}function s1(i){var j;if(i&&typeof i.getData==='function'){var k=i.getData();if(k.tabs){var c3=0;var d3=k.selectedKey;if(d3&&k.tabs.length>=d3){c3=d3-1;}j=k.tabs[c3].mFilterPreference;}else{j=k.mFilterPreference;}}return!!j;}function t1(j,k){var c3=j.getSetting('ovpCardProperties');var d3=c3.getProperty("/addODataSelect");var e3=c3.getProperty("/metaModel");var f3=e3.getODataEntityType(k.entityType);var g3=f3[c3.getProperty('/selectionAnnotationPath')];var h3=f3[c3.getProperty('/presentationAnnotationPath')];var i3="/"+k.name;var j3=Array.prototype.slice.call(arguments,2);var k3=j.getSetting('ovpCardProperties'),l3=k3.getProperty('/parameters');if(g3||!!l3){if((g3&&g3.Parameters&&g3.Parameters.length>0)||!!l3){i3=A2(j.getSetting('dataModel'),k,g3,l3);}}if(c3.getProperty("/cardLayout")&&c3.getProperty("/cardLayout/noOfItems")){var m3="{path: '"+i3+"', length: "+ +(c3.getProperty("/cardLayout/noOfItems"));}else{var m3="{path: '"+i3+"', length: "+H1(c3);}var n3=[];if(d3){n3=v1(j,e3,f3,j3);var o3=c3.getProperty("/template");if(o3!="sap.ovp.cards.charts.analytical"&&o3!="sap.ovp.cards.charts.smart.chart"){var p3=y1(h3);for(var i=0;i<p3.length;i++){if(!n3.includes(p3[i])){n3.push(p3[i]);}}}}var q3=u1(e3,f3,j3);var r3=s1(c3);if(r3||n3.length>0||q3.length>0){m3=m3+", parameters: {";}if(n3.length>0||q3.length>0){if(n3.length>0){m3=m3+"select: '"+n3.join(',')+"'";}if(q3.length>0){if(n3.length>0){m3=m3+", ";}m3=m3+"expand: '"+q3.join(',')+"'";}if(r3){m3=m3+", ";}}if(r3){m3=m3+"custom: {cardId: '"+c3.getProperty("/cardId")+"'}";}if(r3||n3.length>0||q3.length>0){m3=m3+"}";}var s3=x1(c3,h3);if(s3.length>0){m3=m3+", sorter:"+JSON.stringify(s3);}var t3=C1(c3,g3);if(t3.length>0){m3=m3+", filters:"+JSON.stringify(t3);}m3=m3+"}";return m3;}t1.requiresIContext=true;function u1(k,c3,d3){var e3=[];var f3,g3,h3,i3;for(var i=0;i<d3.length;i++){if(!d3[i]){continue;}f3=c3.$path+"/"+d3[i];g3=k.createBindingContext(f3);h3=g3.getObject();h3=h3?h3:[];for(var j=0;j<h3.length;j++){if(h3[j].Value&&h3[j].Value.Path){i3=r1(k,c3,h3[j].Value.Path);if(i3&&e3.indexOf(i3)===-1){e3.push(i3);}}}}return e3;}function v1(c3,d3,e3,f3){var g3=[];var h3,i3,j3;for(var i=0;i<f3.length;i++){if(!f3[i]){continue;}h3=e3.$path+"/"+f3[i];i3=d3.createBindingContext(h3);var k3={};if(c3&&c3.bDummyContext){q.extend(k3,c3,i3,true);}else{k3=c3;}j3=i3.getObject();if(!j3){j3=[];}else if(c(j3)){if(j3.Data){j3=j3.Data;}else{j3=[];}}var l3;var m3;var n3;var o3;for(var j=0;j<j3.length;j++){m3=[];l3=j3[j];n3="";o3=l3.RecordType;if(o3==="com.sap.vocabularies.UI.v1.DataField"){n3=a1(k3,l3,e3,d3,undefined,undefined,true);}else if(o3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var p3=J(e3.$path,l3);n3=_(k3,d3.getProperty(p3),e3,d3);var q3=H(d3.getProperty(p3));if(q3&&q3.length>0){n3+=q3;}}else if(o3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&l3.Url){var r3;if(!l3.Url.UrlRef){r3=O.format(k3,l3.Url);}if(r3&&r3.substring(0,2)==="{="){n3=r3;}}if(n3){var s3=O.simplePath(k3,l3.Value);if(n3.indexOf("(")<0&&n3!==s3){n3=[].concat(s3,n3).join(" ");}m3=w1(n3);}if(m3&&m3.length>0){var t3;for(var k=0;k<m3.length;k++){t3=m3[k];if(!g3[t3]){g3[t3]=true;var u3=C.getUnitColumn(t3,e3);if(u3&&u3!==t3){g3[u3]=true;}var v3=_2(d3,e3,t3);if(v3&&v3!==t3){g3[v3]=true;}}}}}}return Object.keys(g3);}function w1(j){var i,k=0,c3=j.length,d3="",e3;for(i=0;i<c3;i++){e3=j.charAt(i);if(!e3){return;}switch(e3){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}d3+=e3;}j=d3;var f3=/\${([a-zA-Z0-9\_|\/]*)/g;var g3=/[^[{]*[a-zA-Z0-9\_]/g;var h3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var i3,j3,k3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){i3=f3;j3=1;}else if(j.indexOf("path")!==-1){var l3=g3.exec(j);while(l3){if(l3[0].indexOf("path")===-1&&l3[0].indexOf("@i18n")!==0){k3.push(l3[0]);}l3=g3.exec(j);}i3=h3;j3=1;}else{i3=g3;j3=0;}var m3=i3.exec(j);while(m3){if(m3[j3]&&m3[j3].indexOf("@i18n")!==0){k3.push(m3[j3]);}m3=i3.exec(j);}return k3;}function x1(j,k){var c3=[];var d3,e3;var f3=j.getProperty("/sortBy");if(f3){var g3=j.getProperty('/sortOrder');if(g3&&g3.toLowerCase()!=='descending'){e3=false;}else{e3=true;}d3={path:f3,descending:e3};c3.push(d3);}var h3=k&&k.SortOrder||undefined;var i3,f3;if(h3){for(var i=0;i<h3.length;i++){i3=h3[i];f3=i3.Property.PropertyPath;e3=D1(i3.Descending,true);d3={path:f3,descending:e3};c3.push(d3);}}return c3;}function y1(j){var k=[];var c3=j&&j.RequestAtLeast||undefined;if(c3){for(var i=0;i<c3.length;i++){if(c3[i].PropertyPath){k.push(c3[i].PropertyPath);}}}return k;}function z1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:C1(i,k),parameters:B1(k)};}function A1(j){if(!j){return;}var k=j.getProperty('/entityType');var c3=k[j.getProperty('/presentationAnnotationPath')];var d3=x1(j,c3);var e3=[];var i,f3=d3.length;for(i=0;i<f3;i++){if(!d3[i].path){continue;}e3.push({Property:d3[i].path,Descending:d3[i].descending});}if(e3.length>0){return{SortOrder:e3};}}function B1(j){var k,c3=[];if(!j||!j.Parameters){return c3;}var d3=j.Parameters.length;for(var i=0;i<d3;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){L.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}c3[c3.length]={path:k.PropertyName.PropertyPath,value:F1(k.PropertyValue)};}return c3;}function C1(k,c3){var d3=[];var e3;var f3=k.getProperty("/filters");if(f3){d3=d3.concat(f3);}if(c3&&c3.SelectOptions){e3=c3.SelectOptions;}else{e3=c3;}var g3,h3,i3;if(e3){for(var i=0;i<e3.length;i++){g3=e3[i];h3=g3.PropertyName.PropertyPath;for(var j=0;j<g3.Ranges.length;j++){i3=g3.Ranges[j];if(i3.Sign.EnumMember){var j3={path:h3,operator:i3.Option.EnumMember.split("/")[1],value1:F1(i3.Low),value2:F1(i3.High),sign:i3.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(j3.sign==="E"&&j3.operator!==F.EQ){L.error("Exclude sign is supported only with EQ operator");continue;}if(j3.sign==="E"&&j3.operator===F.EQ){j3.operator=F.NE;j3.sign="I";}if(j3.operator==="CP"&&j3.sign==="I"){var k3=F.Contains;var l3=j3.value1;if(l3){var m3=l3.indexOf('*');var n3=l3.lastIndexOf('*');if(m3>-1){if((m3===0)&&(n3!==(l3.length-1))){k3=F.EndsWith;l3=l3.substring(1,l3.length);}else if((m3!==0)&&(n3===(l3.length-1))){k3=F.StartsWith;l3=l3.substring(0,l3.length-1);}else{l3=l3.substring(1,l3.length-1);}}}j3.operator=k3;j3.value1=l3;}d3.push(j3);}}}}return d3;}function D1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function E1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.Decimal){j=Number(i.Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}}return j;}function F1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(i.Boolean||i.Bool){j=D1(i);}else if(i.DateTime){j=i.DateTime;}else if(i.DateTimeOffset){j=i.DateTimeOffset;}else{j=E1(i);}}return j;}function G1(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return F1(i);}}else{return"";}}function H1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var c3=i.getProperty('/listFlavor');var d3;var e3="desktop";if(a.system.phone){e3="phone";}else if(a.system.tablet){e3="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(c3=="bar"){d3=I["List_extended_bar"];}else{d3=I["List_extended"];}}else if(c3=="bar"){d3=I["List_condensed_bar"];}else{d3=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){d3=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){d3=I["Stack_complex"];}else{d3=I["Stack_simple"];}}if(d3){return d3[e3];}return 5;}function I1(i){var j=i.getObject();var k=B(i,j,true);var c3=k.map(function(d3){if(d3&&d3.Value&&d3.Value.Path){return d3.Value.Path;}else if(d3&&d3.fn&&d3.fn.Path){return d3.fn.Path;}});j.filter(function(d3,e3){if(d3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&c3.indexOf(d3.Value.Path)>-1){j.splice(e3,1);}});}I1.requiresIContext=true;function J1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}J1.requiresIContext=true;function K1(i,j){var k=B(i,j);return k.length;}K1.requiresIContext=true;function L1(i,j){return N1(i,j,0);}L1.requiresIContext=true;function M1(i,j){return N1(i,j,1);}M1.requiresIContext=true;function N1(i,j,k){var c3=B(i,j),d3=c3[k];if(d3&&d3.Value&&d3.Value.Path){return d3.Value.Path;}return"";}function O1(i,j){return R(i,j,0);}O1.requiresIContext=true;function P1(i,j){return R(i,j,1);}P1.requiresIContext=true;function Q1(i,j){return R(i,j,2);}Q1.requiresIContext=true;function R1(i,j){return R(i,j,3);}R1.requiresIContext=true;function S1(i,j){return R(i,j,4);}S1.requiresIContext=true;function T1(i,j,k){return Q(i,j,k);}T1.requiresIContext=true;function U1(i,j,k){return W(i,j,k);}U1.requiresIContext=true;function V1(i,j,k,c3){var d3=K1(i,j);if(d3>0){return U1(i,j,k);}else{return T1(i,j,c3);}}V1.requiresIContext=true;function W1(i,j,k){return p2(i,j,k);}W1.requiresIContext=true;function X1(i,j){return U(i,j,0);}X1.requiresIContext=true;function Y1(i,j){return U(i,j,1);}Y1.requiresIContext=true;function Z1(i,j){return U(i,j,2);}Z1.requiresIContext=true;function $1(i,j){return V(i,j,0);}$1.requiresIContext=true;function _1(j,k){for(var i=0;i<k.length;i++){var c3=k[i];if(c3.RecordType==="com.sap.vocabularies.UI.v1.DataField"){if(c3.IconUrl&&c3.IconUrl.String){return c3.IconUrl.String;}if(c3.IconUrl&&c3.IconUrl.Path){return O.simplePath(j,c3.IconUrl);}}}}_1.requiresIContext=true;function a2(i,j,k){var c3="";var d3;if(Array.isArray(j)){d3=B(i,j)[k];}else{var e3=q.extend({},j);var f3=q.extend({},i);d3=n2(f3,e3);}if(!d3||!d3.Value){return c3;}var g3=i.getSetting('ovpCardProperties');var h3=g3&&g3.getProperty("/entityType");var i3=g3&&g3.getProperty("/metaModel");var j3=i3&&i3.getODataProperty(h3,d3.Value.Path);var k3=j3&&j3["Org.OData.Measures.V1.ISOCurrency"];if(k3&&k3.Path){c3+=(" "+b1([k3.Path]));}else if(k3&&k3.String){c3+=(" "+k3.String);}return c3;}a2.requiresIContext=true;function b2(i,j,k,c3){return W(i,j,k,c3);}b2.requiresIContext=true;function c2(i,j){return i1(i,j,0);}c2.requiresIContext=true;function d2(i,j){return l1(i,j,0);}d2.requiresIContext=true;function e2(i,j){return i1(i,j,1);}e2.requiresIContext=true;function f2(i,j){return i1(i,j,2);}f2.requiresIContext=true;function g2(i,j){return n1(i,j,0);}g2.requiresIContext=true;function h2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return u(j,m.ColorValues);}function i2(i,j){if(j&&j.Criticality&&j.Criticality.Path){return"{parts: [{path:'"+j.Criticality.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.kpiValueCriticality'}";}else{return o1(i,j,m.ColorValues);}}i2.requiresIContext=true;function j2(i,j){return X(i,j,0);}j2.requiresIContext=true;function k2(i,j){var k=B(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}k2.requiresIContext=true;function l2(i,j){return X(i,j,1);}l2.requiresIContext=true;function m2(i,j){return X(i,j,2);}m2.requiresIContext=true;function n2(i,j){var k=i.getPath(0);var c3=k.slice(0,k.lastIndexOf("/"));c3=c3.slice(0,c3.lastIndexOf("/"));var d3=J(c3,j);j=i.getModel(0).getProperty(d3);return j;}function o2(i,j){if(!j){return"";}return Z(i,j);}o2.requiresIContext=true;function p2(j,k,c3,d3){var e3;var f3=d3==undefined?c3:z(j,c3)[d3];var g3=j.getSetting('ovpCardProperties');var h3=g3.getProperty("/metaModel");var i3=h3.getODataEntityType(k.entityType);var j3=i3.property;if(j3){for(var i=0;i<j3.length;i++){if(f3.Value.Path===j3[i].name){e3=j3[i]["com.sap.vocabularies.Common.v1.SemanticObject"];if(e3){return O.format(j,e3);}else{return"";}}}}}function q2(i,j,k){var c3=k===undefined?j.Value.Path:j[k].Value.Path;var d3=(c3.indexOf("/")!=-1)?c3.split('/')[0]:"";return d3;}q2.requiresIContext=true;function r2(i,j){var k=i.getSetting('ovpCardProperties');var c3=k.getProperty("/metaModel");var d3=c3.getODataEntityType(j.entityType);if(d3["com.sap.vocabularies.Communication.v1.Contact"]){return true;}return false;}r2.requiresIContext=true;function s2(i,j,k){if(!j){return"";}var c3=i.getSetting('ovpCardProperties');var d3=c3.getProperty("/entityType");var e3=c3.getProperty("/metaModel");var f3=q.extend({},j);var g3=q.extend({},i);j=n2(g3,f3);return _(i,j,d3,e3,k);}s2.requiresIContext=true;function t2(i,j){var k=q.extend({},j);var c3=q.extend({},i);var d3="None",e3=m.StateValues;j=n2(c3,k);if(j&&j.Criticality){d3=m1(i,j,e3);}else{d3=o1(i,j,e3);}return d3;}t2.requiresIContext=true;function u2(i,j){var k=q.extend({},j);var c3=q.extend({},i);j=n2(c3,k);if(j&&j.Criticality){return true;}}u2.requiresIContext=true;function v2(i,j){var k=q.extend({},j);var c3=q.extend({},i);var d3=i.getSetting('ovpCardProperties');var e3=d3.getProperty("/entityType");var f3=d3.getProperty("/metaModel");j=n2(c3,k);if(!j){return;}var g3=f3.getODataProperty(e3,j.Value.Path);if(j&&g3&&g3.type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return'Center';}if(g3&&((g3.type=="Edm.DateTime")||(g3.type=="Edm.DateTimeOffset"))){return'Right';}}v2.requiresIContext=true;function w2(i,j){var k=q.extend({},j);var c3=q.extend({},i);j=n2(c3,k);var d3="None";if(j&&j.Criticality&&j.Criticality.Path){d3="{path:'"+j.Criticality.Path+"'}";}else{d3=o1(i,j,m.StateValues);d3=v(d3);}return d3;}w2.requiresIContext=true;function x2(j,k){var c3;for(var i=0;i<k.length;i++){c3=k[i];if(c3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||c3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||c3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}x2.requiresIContext=true;function y2(i,j){var k=B(i,j)[0];if(k&&k.Value&&k.Value.Path){var c3=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var d3=i.getModel(0);var e3=d3.getProperty(c3);var f3=d3.getODataProperty(e3,k.Value.Path);if(f3&&f3["Org.OData.Measures.V1.Unit"]){return f3["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}y2.requiresIContext=true;function z2(i){var j=i.getObject();var k=i.getModel();var c3=k.getProperty("/metaModel");var d3=c3.getODataEntitySet(k.getProperty("/entitySet"));var e3=c3.getODataEntityType(d3.entityType);j=e3.$path+"/"+j;return c3.createBindingContext(j);}function A2(j,k,c3,d3,e3){var f3="";var g3=new o.Model(o.Model.ReferenceByModel(j));var h3=g3.findQueryResultByName(k.name);if(!h3){f3="/"+k.name;return f3;}var i3=new o.QueryResultRequest(h3);var j3=h3.getParameterization();if(!j3){f3="/"+k.name;return f3;}if(e3){var k3=e3.getAnalyticalParameters();}if(j3){var l3;i3.setParameterizationRequest(new o.ParameterizationRequest(j3));if(c3&&c3.Parameters){e(c3.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){l3=this.PropertyNameFrom.PropertyPath.split("/");i3.getParameterizationRequest().setParameterValue(l3[l3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{l3=this.PropertyName.PropertyPath.split("/");i3.getParameterizationRequest().setParameterValue(l3[l3.length-1],this.PropertyValue.String);}});}else if(d3){e(d3,function(){i3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(k3&&k3.length>0){var m3=e3&&e3.getUiState({allFilters:false});var n3=m3?JSON.stringify(m3.getSelectionVariant()):"{}";var c3=new S(n3);for(var o3 in j3.getAllParameters()){for(var i=0;i<k3.length;i++){if(k3[i]&&(k3[i].name==o3)){var p3=k3[i].name;var q3=c3.getParameter(p3);if(!q3){var r3=c3.getSelectOption(p3);q3=r3&&r3[0]&&r3[0].Low;}i3.getParameterizationRequest().setParameterValue(o3,q3);}}}}else{f3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return f3;}}try{f3=i3.getURIToQueryResultEntitySet();}catch(s3){h3=i3.getQueryResult();f3="/"+h3.getEntitySet().getQName();L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+s3||s3.message);}return f3;}function B2(j,k,ns){var c3=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<c3.length;i++){if(ns+"."+c3[i].name===k){return c3[i];}}}function C2(i,j){var k=i.filter(function(d3){if(d3.RecordType==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var c3=M(k);if(c3){return c3[j];}return;}function D2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=C2(k,0);return p2(i,j,k);}D2.requiresIContext=true;function E2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=C2(k,1);return p2(i,j,k);}E2.requiresIContext=true;function F2(i,j){var k=i.filter(function(d3){if(d3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&d3.Target.AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var c3=M(k);if(c3){return c3[j];}return;}function G2(i){if(!i||!i.length||i.length===0){return false;}var j=F2(i,0);if(j){return true;}return false;}function H2(i,j,k,c3){var d3,e3,f3;if(k&&k.Value&&k.Value.Path){d3=k.Value.Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.Path){d3=k.Description.Value.Path;}if(k&&k.Description&&k.Description.Path){e3=k.Description.Path;}else if(k&&k.Title&&k.Title.Path){f3=k.Title.Path;}var g3="";var h3=c3&&c3.Parameters;var i3="";var j3=i.getSetting('ovpCardProperties'),k3=j3.getProperty('/parameters');h3=h3||!!k3;if(h3){var l3=i.getSetting("dataModel");var m3=A2(l3,j,c3,k3);g3+="{path: '"+m3+"'";}else{g3+="{path: '/"+j.name+"'";}g3+=", length: 1";var n3=i.getSetting('ovpCardProperties');var o3=n3.getProperty("/entityType");var p3=C.getUnitColumn(d3,o3);var q3=C1(n3,c3);if(q3.length>0){i3+=", filters: "+JSON.stringify(q3);}var r3=[];r3.push(d3);if(e3){r3.push(e3);}else if(f3){r3.push(f3);}if(k&&k.Criticality&&k.Criticality.Path){r3.push(k.Criticality.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.Path){r3.push(k.CriticalityCalculation.DeviationRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.Path){r3.push(k.CriticalityCalculation.ToleranceRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.Path){r3.push(k.CriticalityCalculation.DeviationRangeHighValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.Path){r3.push(k.CriticalityCalculation.ToleranceRangeHighValue.Path);}if(p3){r3.push(p3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.Path){r3.push(k.TrendCalculation.ReferenceValue.Path);}var s3=s1(j3);var t3=s3?", custom: {cardId: '"+j3.getProperty("/cardId")+"'}":"";return g3+", parameters:{select:'"+r3.join(",")+"'"+t3+"}"+i3+"}";}H2.requiresIContext=true;function I2(k){if(isNaN(k)){return k;}var i,j,c3=false;if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits){i=Number(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits);}if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.percentageAvailable){c3=true;}if(!i||i<0){i=0;}else if(i>2){i=2;}j=k;if(k){var d3=N.getFloatInstance({minFractionDigits:i,maxFractionDigits:i,style:"short",showScale:true,shortRefNumber:j});if(c3){return d3.format(Number(k))+" %";}else{return d3.format(Number(k));}}}function J2(i){if(!i||!i.Value||!i.Value.Path){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var c3=j.getProperty("/metaModel");var d3=c3.getODataProperty(k,i.Value.Path);if(d3["Org.OData.Measures.V1.Unit"]){var e3=d3["Org.OData.Measures.V1.Unit"];if(e3.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function K2(i,j){if(!j||!j.Value||!j.Value.Path||!j.TrendCalculation){return"";}var k=G1(j.Value);var c3=G1(j.TrendCalculation.ReferenceValue);var d3=G1(j.TrendCalculation.DownDifference);var e3=G1(j.TrendCalculation.UpDifference);var f3=q1(c3);var g3=q1(d3);var h3=q1(e3);var i3="parts: ["+k;i3+=f3?","+c3:"";i3+=g3?","+d3:"";i3+=h3?","+e3:"";i3+="]";var j3=function(){var l3=1;return y(arguments[0],f3?arguments[l3++]:c3,g3?arguments[l3++]:d3,h3?arguments[l3++]:e3);};var k3=t(j3,"formatTrendDirection");return"{"+i3+", formatter: '"+k3+"'}";}K2.requiresIContext=true;function L2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}if(i.TrendCalculation.ReferenceValue.Path){return"{parts: [{path:'"+i.Value.Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}}function M2(k,i){var j,c3,d3,e3,f3=false;if(isNaN(+k)){return"";}if(k==0){e3=i;}else{e3=k;}c3=this.getModel('ovpCardProperties');if(c3.getProperty("/iNumberOfFractionalDigits")){d3=+(c3.getProperty("/iNumberOfFractionalDigits"));}if(c3.getProperty("/bPercentageAvailableForTarget")){f3=true;}if(i){j=i;}else{if(c3.getProperty("/sManifestTargetValue")){j=c3.getProperty("/sManifestTargetValue");}}if(!d3||d3<0){d3=0;}else if(d3>2){d3=2;}if(j){var g3=N.getFloatInstance({minFractionDigits:d3,maxFractionDigits:d3,style:"short",showScale:true,shortRefNumber:e3});if(f3){return g3.format(+(j))+" %";}else{return g3.format(+(j));}}}function N2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var c3=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits.Int);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.String){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue.String);return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.Path){var d3=c3.getODataProperty(k,i.TrendCalculation.ReferenceValue.Path);if(d3["Org.OData.Measures.V1.Unit"]){var e3=d3["Org.OData.Measures.V1.Unit"];if(e3.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}}}function O2(k,i){var j,c3,d3;if(isNaN(+k)){return"";}k=+(k);d3=this.getModel('ovpCardProperties');if(d3.getProperty("/iNumberOfFractionalDigits")){j=+(d3.getProperty("/iNumberOfFractionalDigits"));}if(i){c3=+(i);}else{if(d3.getProperty("/sManifestTargetValue")){c3=+(d3.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(c3){var e3=((k-c3)/c3);var f3=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return f3.format(e3);}}function P2(i){if(i&&i.GroupBy&&!(q.isEmptyObject(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('PropertyPath')){return true;}else{return false;}}function Q2(j,k){var c3;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){c3=j[i];break;}}return c3?c3.name:null;}function R2(i,k){return Q2(i,k);}function S2(i,k){var j=Q2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function T2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var c3=this.getModel('ovpCardProperties').getProperty("/metaModel");var d3=this.getModel('ovpCardProperties').getProperty("/entityType");var e3;if(i.GroupBy.constructor===Array){e3=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{e3=i.GroupBy.Collection;}var f3;e(e3,function(){f3=$2(c3,d3,this.PropertyPath);if(!f3){return;}j+=f3;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function U2(i,j,k){var c3=true;var d3=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][d3].PropertyName.PropertyPath){c3=false;}j=[j];var e3=i.getSetting('ovpCardProperties');var f3=e3.getProperty("/entityType");var g3=e3.getProperty("/metaModel");var h3=C1(e3,j);if(h3.length==0){return"";}var i3;var j3;i3=h3[0].path;j3=_2(g3,f3,i3);if(j3!==i3){return"";}var k3=g3.getODataProperty(f3,j[0].PropertyName.PropertyPath)["type"];var l3=Y2(h3,k3);if(c3===true){return l3+", ";}return l3;}U2.requiresIContext=true;function V2(i,j,k){var c3=!(j.index===(k.length-1));var d3=i.getSetting('ovpCardProperties');var e3=d3.getProperty("/metaModel");var f3=d3.getProperty("/entityType");var g3=e3.getODataProperty(f3,k[j.index].path)["type"];var h3=Y2([k[j.index]],g3);if(c3===true){return h3+", ";}return h3;}V2.requiresIContext=true;function W2(i){return i.id;}function X2(i){return i.id;}function Y2(j,k){var c3=[];for(var i=0;i<j.length;i++){c3.push(Z2(j[i],k));}return c3.join(', ');}function Z2(i,j){var k=false;var c3,d3=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){c3=d3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){c3=d3.format(new Date(i.value1),true);}else{c3=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){c3+=" - "+d3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){c3+=" - "+d3.format(new Date(i.value1),true);}else{c3+=" - "+i.value1;}}if(k){c3=b.getText("kpiHeader_Filter_NotOperator",[c3]);}return c3;}function $2(i,j,k){return a3(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function _2(i,j,k){return a3(i,j,k,"sap:text");}function a3(i,j,k,c3){var d3=i.getODataProperty(j,k);if(!d3){L.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}var e3=d3[c3];if(e3){if(c3==="com.sap.vocabularies.Common.v1.Label"){return e3.String;}return e3;}return d3.name;}function b3(i){if(!i||!i.Value||!i.Value.Path){return"";}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}return{NumberFormatFunctions:g,DateFormatFunctions:h,CurrencyFormatFunctions:l,formatFunctions:d,criticalityConstants:m,TextArrangementType:T,getLabelForDataItem:p,colorPaletteForComparisonMicroChart:k1,formatField:Z,checkFilterPreference:s1,formatItems:t1,getCardSelections:z1,getCardSorters:A1,getFilters:C1,getPrimitiveValue:F1,getAnnotationLabel:R2,getApplicationName:S2,removeDuplicateDataField:I1,formatUrl:J1,getDataPointsCount:K1,getFirstDataPointValue:L1,getFirstDataFieldName:O1,getSecondDataFieldName:P1,getRequestFields:y1,getThirdDataFieldName:Q1,formatDataFieldValueOnIndex:T1,formatDataPointValueOnIndex:U1,formatDataPointOrField:V1,formatsemanticObjectOfDataFieldGeneric:W1,getLabelForFirstDataPoint:$1,formatImageUrl:_1,formatUnit:a2,formatObjectNumber:b2,formatFirstDataPointState:c2,formatFirstDataPointColor:d2,formatSecondDataPointState:e2,formatThirdDataPointState:f2,formatFirstDataPointStateForSmartField:g2,formatKPIHeaderState:i2,isFirstDataPointCriticality:j2,isFirstDataPointCriticalityForTableStatus:k2,getSortedDataFields:z,getSortedDataPoints:B,formatDataFieldValueGeneric:o2,formatDataPointValue:s2,formatDataPointStateGeneric:t2,checkCriticalityGeneric:u2,checkCriticalityGenericForTableStatus:v2,formatDataPointStateForSmartFieldGeneric:w2,hasActions:x2,isFirstDataPointPercentageUnit:y2,resolveEntityTypePath:z2,resolveParameterizedEntitySet:A2,getAssociationObject:B2,semanticObjectOfFirstDataField:D2,semanticObjectOfSecondDataField:E2,isFirstContactAnnotation:G2,getAggregateNumber:H2,KpiValueFormatter:I2,kpiValueCriticality:h2,formThePathForAggregateNumber:J2,formThePathForTrendIcon:K2,formPathForPercentageChange:L2,TargetValueFormatter:M2,formPathForTargetValue:N2,returnPercentageChange:O2,isPresentationVarientPresent:P2,listGroupBy:T2,formTheFilterByString:U2,formTheFilterByStringNotFromSelVar:V2,formTheIdForFilter:W2,formTheIdForFilterNotFromSelVar:X2,_criticality2state:u,_calculateCriticalityState:x,_calculateTrendDirection:y,_getPropertiesFromBindingString:w1,sortCollectionByImportance:M,checkNavTargetForContactAnno:q2,checkForContactAnnotation:r2,getKPIHeaderAggregateNumber:b3};},true);
