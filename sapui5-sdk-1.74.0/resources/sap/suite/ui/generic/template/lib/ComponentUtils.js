sap.ui.define(["sap/ui/base/Object","sap/base/Log","sap/suite/ui/generic/template/js/AnnotationHelper","sap/base/util/extend","sap/base/util/isEmptyObject"],function(B,L,A,e,a){"use strict";var C={isPreliminary:function(){return false;}};function g(c,o){var t=o.oTemplateContract.mRoutingTree[o.route];var h;var H;var b;var f;var I=false;var d=[];var j;var E=[];function r(i){if(t.createNonDraftInfo&&t.createNonDraftInfo.bindingPath===i){return t.createNonDraftInfo.createContext;}delete t.createNonDraftInfo;return null;}function k(){return(t.createNonDraftInfo&&c.getComponentContainer().getBindingContext()===t.createNonDraftInfo.createContext)?t.createNonDraftInfo.createBindingPath:null;}function l(){return c.getModel("_templPriv");}function m(){return l().getProperty("/generic/viewLevel");}function n(){return o.preprocessorsData;}function p(){return o.oParameterModel;}function q(){var i=c.getModel("i18n").getResourceBundle();return{dataLoadFailedTitle:i.getText("ST_ERROR"),dataLoadFailedText:i.getText("ST_GENERIC_ERROR_LOAD_DATA_TEXT")};}function s(i,t1,u1){if(typeof u1!=="function"){throw new Error("Event handler must be a function");}E.push({template:i,event:t1,handler:u1});}function D(t1,u1,v1){for(var i=E.length;i--;){if(E[i].handler===v1&&E[i].event===u1&&E[i].template===t1){E.splice(i,1);}}}function F(t1,u1,v1){for(var i=0;i<E.length;i++){if(E[i].event===u1&&E[i].template===t1){E[i].handler(v1);}}}function u(i){return i.getMetadata().getName();}function v(){return o.oApplication.isComponentActive(c);}function w(){return o.oNavigationObserver.getProcessFinished(true);}function P(i,t1){var u1=w();u1.then(function(){if(v()){if(t1){T(true);}F(u(o.oController),"PageDataLoaded",{context:i});if(i1()){var v1=i.getObject();if(!v1.IsActiveEntity){o.oApplication.getDraftSiblingPromise(i);}}}});}function x(){h.then(function(i){if(i){P(i);}});}function S(){o.oHeaderLoadingObserver.startProcess();if(!f){var i=new Promise(function(t1){f=t1;});o.oApplication.getBusyHelper().setBusy(i);}}function N(){if(!H){h=new Promise(function(i){H=i;});}}if(t.contextPath){N();}else{h=Promise.resolve();}function y(i){L.info("Request header data",i.getSource().getPath(),"Class sap.suite.ui.generic.template.lib.ComponentUtils");I=true;N();if(!c.getComponentContainer().getElementBinding().isSuspended()){S();}}function z(){if(f){f();f=null;}o.oHeaderLoadingObserver.stopProcess();}function G(i){var t1=i.getSource().getBoundContext();if(t1){return t1;}if(c.getComponentContainer().getElementBinding().isSuspended()){t1=null;}else{t1=C;}U();return t1;}function J(){var i=q();var t1=c.getAppComponent().getNavigationController();t1.navigateToMessagePage({title:i.dataLoadFailedTitle,text:i.dataLoadFailedText,description:"",viewLevel:m()});}function K(){I=false;if(!b){return;}if(b===C){J();U();}else if(!c.getComponentContainer().getElementBinding().isSuspended()){(o.methods.updateBindingContext||Function.prototype)();if(H){H(b);}}else{return;}H=null;b=null;}function M(i){L.info("Received header data",i.getSource().getPath(),"Class sap.suite.ui.generic.template.lib.ComponentUtils");z();if(I){b=G(i);}K();}function O(i){var t1=G(i);if(t1&&t1.isPreliminary()){return;}b=t1;K();o.oHeaderLoadingObserver.stopProcess();}function R(i){var t1={createPreliminaryContext:true,canonicalRequest:!o.oTemplateContract.bCreateRequestsCanonical};var u1=n();if(u1.rootContextExpand&&u1.rootContextExpand.length){t1.expand=u1.rootContextExpand.join(",");}o.oHeaderLoadingObserver.startProcess();if(o.methods.beforeRebind){o.methods.beforeRebind();}N();b=null;c.getComponentContainer().bindElement({path:i,events:{dataRequested:y,dataReceived:M,change:O},parameters:t1,batchGroupId:"Changes",changeSetId:"Changes"});if(o.methods.afterRebind){o.methods.afterRebind();}}function U(){N();var i=c.getComponentContainer();i.unbindElement();b=null;I=false;z();}function Q(){var t1=c1();var u1=(t1.length===d.length);for(var i=0;i<t1.length&&u1;i++){u1=t1[i]===d[i];}d=t1;return!u1;}function T(i){o.reuseComponentsReady.then(function(t1){for(var u1 in t1){t1[u1].pathUnchangedCallBack(i);}});}function V(i,t1){var u1=Object.create(null);for(var v1 in i){var w1=i[v1];u1[v1]=t1(w1,v1);}return u1;}function W(){var i=l();for(var t1 in o.routeConfig.embeddedComponents){var u1=!!o.routeConfig.embeddedComponents[t1].hiddenByDefault;i.setProperty("/generic/embeddedComponents/"+t1+"/hidden",u1);}}function X(i,t1){var u1=Q();if(u1&&!t1){W();}if(!i){if(o.routingSpec&&o.routingSpec.noOData){P(null,u1);}return;}var v1=c.getComponentContainer();if(!v1){return;}var w1=r(i);if(w1){U();if(H){H(w1);H=null;}else{h=Promise.resolve(w1);}if(!t1){x();}v1.setBindingContext(w1);Promise.all([o.oViewRenderedPromise,o.viewRegistered]).then(T.bind(null,true));}else{var x1=v1.getElementBinding();if(x1){if(x1.getPath()===i){if(x1.isSuspended()){x1.resume();K();}if(I){S();}o.oApplication.getBusyHelper().getUnbusy().then(T.bind(null,u1&&o.routingSpec.noOData));if(!t1){x();}return;}else if(!t1){U();}}var y1=c.getModel("ui");y1.setProperty("/enabled",false);y1.setProperty("/editable",false);R(i);x();}}function Y(){var i=c.getComponentContainer().getElementBinding();if(i){c.getModel().invalidateEntry(i.getBoundContext());if(i.isSuspended()){U();}else{i.refresh(true);}}}function Z(i){i=i||c.getIsRefreshRequired();if(i||!a(o.mRefreshInfos)){(o.methods.refreshBinding||Function.prototype)(i,o.mRefreshInfos);c.setIsRefreshRequired(false);o.mRefreshInfos=Object.create(null);}T(i);}function $(i){if(i1()){var t1=c.getComponentContainer();var u1=t1.getElementBinding();if(u1&&!u1.isSuspended()){u1.suspend();i.catch(function(){u1.resume();});}}}function _(){var i=c.getComponentContainer();if(k()){i.setBindingContext();delete t.createNonDraftInfo;return;}var t1=i.getElementBinding();if(t1&&!t1.isSuspended()){if(o.oTemplateContract.oValidationMessageBinding.getLength()){U();}else{t1.suspend();}z();}}function a1(i){var t1=m();return o.oApplication.registerContext(i,t1,c.getEntitySet());}function b1(){return o.oApplication.getBreadCrumbInfo(c.getEntitySet());}function c1(){return o.oApplication.getCurrentKeys(m());}function d1(i){return o.oApplication.getCommunicationObject(c,i);}function e1(i,t1,u1,v1){o.oTemplateContract.oNavigationControllerProxy.navigateToChild(t,i,u1,t1,v1);}function f1(i,t1,u1){o.oTemplateContract.oNavigationControllerProxy.navigateFromNodeAccordingToContext(t,i,t1,u1);}function g1(){var i=c.getEntitySet();var t=o.oTemplateContract.mEntityTree[i];return t.headerTitle;}function h1(i){o.oTemplateContract.oNavigationControllerProxy.setTextForTreeNode(t,i);}function i1(){if(j===undefined){var i=c.getEntitySet();var t=o.oTemplateContract.mEntityTree[i];j=!!(t&&t.isDraft);}return j;}function j1(){if(i1()){var i=o.oApplication.getHierarchySectionsFromCurrentHash();return"/"+i[0];}}function k1(){return!(o.routingSpec&&o.routingSpec.noOData);}function l1(){return h;}function m1(){return o.oTemplateContract.oPaginatorInfo[m()-1];}function n1(i,t1){var u1=m();if(!t1){u1--;}o.oTemplateContract.oPaginatorInfo[u1]=i;}function o1(i,t1){o.reuseComponentsReady.then(function(u1){var v1=t1.getComponentInstance();for(var w1 in u1){if(v1===u1[w1].component){var x1=l();x1.setProperty("/generic/embeddedComponents/"+w1+"/isInVisibleArea",i);return;}}});}function p1(i){i.oStatePreserverPromise=o.reuseComponentsReady.then(function(t1){var u1={appStateName:encodeURI("sap-iapp-state-"+o.routeConfig.entitySet),getCurrentState:function(){var w1=i.getCurrentState?i.getCurrentState():Object.create(null);var x1=function(y1,z1){if(y1.component.stGetCurrentState){var A1=y1.component.stGetCurrentState();for(var B1 in A1){w1["$embeddedComponent$"+z1.length+"$"+z1+"$"+B1]=A1[B1];}}};V(t1,x1);return w1;},applyState:function(w1,x1){var y1=Object.create(null);var z1=Object.create(null);for(var A1 in w1){if(A1.indexOf("$embeddedComponent$")===0){var B1=A1.substring(19);var C1=B1.indexOf("$");var D1=Number(B1.substring(0,C1));var E1=B1.substring(C1+1,C1+D1+1);var F1=z1[E1];if(!F1){F1=Object.create(null);z1[E1]=F1;}var G1=B1.substring(C1+D1+2);F1[G1]=w1[A1];}else{y1[A1]=w1[A1];}}(i.applyState||Function.prototype)(y1,x1);var H1=function(I1,J1){if(I1.component.stApplyState){I1.component.stApplyState(z1[J1]||Object.create(null),x1);}};Promise.all([o.oViewRenderedPromise,h]).then(V.bind(null,t1,H1));},oComponent:c};var v1=o.oApplication.getStatePreserver(u1);o.oApplication.registerStateChanger(v1.getAsStateChanger());return v1;});o.oTemplateContract.oStatePreserversAvailablePromise=Promise.all([o.oTemplateContract.oStatePreserversAvailablePromise,i.oStatePreserverPromise]);}function q1(){var i=o.oTemplateContract.oFlexibleColumnLayoutHandler;return i?i.getFclProxy(t):{handleDataReceived:t.level?null:Function.prototype,isListAndFirstEntryLoadedOnStartup:t.level?null:Function.prototype};}function r1(){return t.page.component.settings||{};}function s1(i){o.aUnsavedDataCheckFunctions=o.aUnsavedDataCheckFunctions||[];o.aUnsavedDataCheckFunctions.push(i);}return{setEditableNDC:function(i){o.oApplication.setEditableNDC(i);},getEditableNDC:function(){return o.oApplication.getEditableNDC();},getBusyHelper:function(){return o.oApplication.getBusyHelper();},getNonDraftCreateBindingPath:k,attach:function(i,t1,u1){s(u(i),t1,u1);},detach:function(i,t1,u1){D(u(i),t1,u1);},fire:function(i,t1,u1){F(u(i),t1,u1);},isListReportTemplate:function(){return A.isListReportTemplate(o.routeConfig);},getPreprocessorsData:n,getParameterModelForTemplating:p,bindComponent:X,refreshBinding:Z,refreshBindingUnconditional:Y,suspendBinding:_,getTemplatePrivateModel:l,registerContext:a1,getViewLevel:m,getBreadCrumbInfo:b1,getCurrentKeys:c1,getDraftRootPath:j1,getCommunicationObject:d1,navigateRoute:e1,navigateAccordingToContext:f1,getTitleFromTreeNode:g1,setText:h1,onBeforeDraftTransfer:$,isDraftEnabled:i1,isODataBased:k1,isComponentActive:v,navigateToDataLoadedFailedPage:J,getHeaderDataAvailablePromise:l1,getPaginatorInfo:m1,setPaginatorInfo:n1,onVisibilityChangeOfReuseComponent:o1,getNavigationFinishedPromise:w,setStatePreserverPromise:p1,unbind:U,getFclProxy:q1,getSettings:r1,registerUnsavedDataCheckFunction:s1};}return B.extend("sap.suite.ui.generic.template.lib.ComponentUtils",{constructor:function(c,o){e(this,g(c,o));}});});
