sap.ui.define(["sap/base/util/extend"],function(e){"use strict";function g(t){var A=t.oNavigationControllerProxy.getActiveComponents();var r=[];for(var i=0;i<A.length;i++){var c=A[i];var R=t.componentRegistry[c];var v=R.viewLevel;if(v>0){var C=R.oComponent.getBindingContext();if(C){r[v]=C.getPath();}}}return r;}function a(t,T){var A=t.oNavigationControllerProxy.getActiveComponents();for(var i=0;i<A.length;i++){var c=A[i];var r=t.componentRegistry[c];var v=r.viewLevel;if(v===T){return r;}}}function d(t,o){var r=a(t,0);if(r&&r.methods.displayNextObject){return r.methods.displayNextObject(o);}return Promise.reject();}function G(t,i){var I=t.oFlexibleColumnLayoutHandler&&t.oFlexibleColumnLayoutHandler.isNextObjectLoadedAfterDelete();if(I){var r=a(t,0);if(r){if(i){return[t.oApplicationProxy.getPathOfLastShownDraftRoot()];}return r.methods.getItems&&r.methods.getItems();}}return null;}function n(t,k){t.oNavigationControllerProxy.navigateUpAfterDeletion(k);}function p(t,s,i,o){var O=[];var c;var C=[];var f;for(var k=0;k<i.length;k++){f=i[k].getBindingContextPath();C.push(f);}for(var j=0;j<C.length;j++){if(C[j]===s){O.push(C[j]);c=j;break;}}if(c>=0){var I=C.slice(c+1,C.length);var h;if(c>0){h=C.slice(0,c);h.reverse();}O=O.concat(I,h);}else{O=C;}o.then(function(){var N=d(t,O);N.catch(function(){n(t,0);});});}function b(t){return function(){var f=t.oTemplatePrivateGlobalModel.getProperty("/generic/forceFullscreenCreate");if(f){t.oNavigationControllerProxy.navigateBack();}else{var o=G(t,true);if(o){d(t,o);}else{n(t,0);}}};}function P(t,o){var c=g(t);var D=[];var s=null;var I;var f;var h;var C;var r;for(C in t.componentRegistry){r=t.componentRegistry[C];var B=r.viewLevel&&r.oComponent.getBindingContext();f=B&&B.getPath();h=f&&o[f];if(h){var u=t.oViewDependencyHelper.unbindChildren.bind(null,r.oComponent,true);h.then(u);}}var A=Object.create(null);var H=function(j,E){if(E){A[E]=true;}return{deleted:!!E,position:j};};for(f in o){var E=f.substring(1,f.indexOf("("));h=o[f];t.oApplicationProxy.prepareDeletion(f,h);var j=c.indexOf(f);if(j===1){I=G(t);if(I){s=f;}}var k=h.then(H.bind(null,j,E),H.bind(null,j,null));D.push(k);}if(s){p(t,s,I,o[s]);}else{Promise.all(D).then(function(R){var K=-1;for(var i=0;i<R.length;i++){var l=R[i];if(l.deleted&&l.position>0){if(K<0||K>=l.position){K=l.position-1;}}}if(K>=0){n(t,K);}});}Promise.all(D).then(function(R){for(C in t.componentRegistry){r=t.componentRegistry[C];var m=r.mRefreshInfos;e(m,A);if(r.utils.isComponentActive()){r.utils.refreshBinding();}}});}return{prepareDeletion:P,getNavigateAfterDeletionOfCreateDraft:b};});
