sap.ui.define(["sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory","sap/ui/model/resource/ResourceModel","sap/base/i18n/ResourceBundle"],function(S,a,R,b){"use strict";var c=S.extend("sap.fe.core.services.ResourceModelService",{initPromise:Promise.resolve(),init:function(){var t=this;var C=this.getContext();var s=C.settings;this.oFactory=C.factory;this.initPromise=new Promise(function(r,d){var B=s.bundles;var e=s.enhanceI18n||[];sap.ui.getCore().getLibraryResourceBundle(B[0],undefined,true).then(function(o){var E=[];var f=function(o){return t.oResourceModel.enhance(o);};t.oResourceModel=new R({bundle:o,async:true});if(C.scopeType==="component"){var g=C.scopeObject;g.setModel(t.oResourceModel,s.modelName);}if(B.length>1||e.length>0){for(var i=1;i<B.length;i++){E.push(sap.ui.getCore().getLibraryResourceBundle(B[1],undefined,true).then(f));}Promise.all(E).then(function(){for(var i=0;i<e.length;i++){E.push(t.oResourceModel.enhance({bundleUrl:e[i]}));}Promise.all(E).then(function(){r(t);});});}else{t.oResourceModel.getResourceBundle().then(function(){r(t);});}t.oResourceModel.attachRequestFailed(d);});});},getResourceModel:function(){return this.oResourceModel;},exit:function(){this.oFactory.removeGlobalInstance();}});return a.extend("sap.fe.core.services.ResourceModelServiceFactory",{_oInstances:{},createInstance:function(s){var k=s.settings.bundles.join(",")+(s.settings.enhanceI18n?","+s.settings.enhanceI18n.join(","):"");if(!this._oInstances[k]){this._oInstances[k]=new c(Object.assign({factory:this},s));}return this._oInstances[k].initPromise;},removeGlobalInstance:function(){this._oInstances={};}});},true);
